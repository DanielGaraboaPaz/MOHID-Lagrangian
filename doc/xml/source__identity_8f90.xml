<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.13">
  <compounddef id="source__identity_8f90" kind="file" language="Fortran">
    <compoundname>source_identity.f90</compoundname>
    <innerclass refid="structsource__identity_1_1source__par" prot="private">source_identity::source_par</innerclass>
    <innerclass refid="structsource__identity_1_1source__state" prot="private">source_identity::source_state</innerclass>
    <innerclass refid="structsource__identity_1_1source__stats" prot="private">source_identity::source_stats</innerclass>
    <innerclass refid="structsource__identity_1_1source__stencil" prot="private">source_identity::source_stencil</innerclass>
    <innerclass refid="structsource__identity_1_1source__class" prot="private">source_identity::source_class</innerclass>
    <innernamespace refid="namespacesource__identity">source_identity</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IST/MARETEC,<sp/>Water<sp/>Modelling<sp/>Group,<sp/>Mohid<sp/>modelling<sp/>system</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/>TITLE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>Mohid<sp/>Model</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/>PROJECT<sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>Mohid<sp/>Lagrangian<sp/>Tracer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/>MODULE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>source_identity</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/>URL<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>http://www.mohid.com</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/>AFFILIATION<sp/><sp/><sp/>:<sp/>IST/MARETEC,<sp/>Marine<sp/>Modelling<sp/>Group</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/>DATE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>March<sp/>2018</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/>REVISION<sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>Canelas<sp/>0.1</highlight></codeline>
<codeline lineno="14"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/>DESCRIPTION:</highlight></codeline>
<codeline lineno="17"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!------------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="19" refid="namespacesource__identity" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">module</highlight><highlight class="normal"><sp/><ref refid="namespacesource__identity" kindref="compound">source_identity</ref></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacecommom__modules" kindref="compound">commom_modules</ref></highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">use<sp/></highlight><highlight class="normal"><ref refid="namespacesimulation__globals" kindref="compound">simulation_globals</ref></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">implicit<sp/>none</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">private</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight></codeline>
<codeline lineno="27" refid="structsource__identity_1_1source__par" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">type</highlight><highlight class="normal"><sp/><ref refid="structsource__identity_1_1source__par" kindref="compound">source_par</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="28" refid="structsource__identity_1_1source__par_1a05b6d325908a1b552f98dada275a3465" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">integer</highlight><highlight class="normal"><sp/>::<sp/>id</highlight></codeline>
<codeline lineno="29" refid="structsource__identity_1_1source__par_1a746a02960ffcba9f699ae45fa55dd8b4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">real(prec_time)</highlight><highlight class="normal"><sp/>::<sp/>emitting_rate</highlight></codeline>
<codeline lineno="30" refid="structsource__identity_1_1source__par_1a11cd864db9e9021cec4bd018d6fec295" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">real(prec_time)</highlight><highlight class="normal"><sp/>::<sp/>startime</highlight></codeline>
<codeline lineno="31" refid="structsource__identity_1_1source__par_1a3ab5e22242b41bdcd56480b9d0496efa" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">real(prec_time)</highlight><highlight class="normal"><sp/>::<sp/>stoptime</highlight></codeline>
<codeline lineno="32" refid="structsource__identity_1_1source__par_1a71ef7dc8c6268d014247e0bca3005311" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(string)<sp/>::<sp/>name</highlight></codeline>
<codeline lineno="33" refid="structsource__identity_1_1source__par_1a3d7091aedcb1154665c1debba07bee2c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(string)<sp/>::<sp/>property_type</highlight></codeline>
<codeline lineno="34" refid="structsource__identity_1_1source__par_1a0205c62b7673e76c7f1de2bfcecabd84" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(string)<sp/>::<sp/>property_name</highlight></codeline>
<codeline lineno="35" refid="structsource__identity_1_1source__par_1a088f264b78200deb737b873025837ec6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(string)<sp/>::<sp/>source_geometry</highlight></codeline>
<codeline lineno="36" refid="structsource__identity_1_1source__par_1a96d4d1aebbc4cf365220f0bf0eabca97" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">class</highlight><highlight class="normal">(shape),<sp/></highlight><highlight class="keywordtype">allocatable</highlight><highlight class="normal"><sp/>::<sp/><ref refid="namespacegeometry" kindref="compound">geometry</ref></highlight></codeline>
<codeline lineno="37"><highlight class="keyword"><sp/><sp/><sp/><sp/>end<sp/>type</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight></codeline>
<codeline lineno="39" refid="structsource__identity_1_1source__state" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">type</highlight><highlight class="normal"><sp/><ref refid="structsource__identity_1_1source__state" kindref="compound">source_state</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="40" refid="structsource__identity_1_1source__state_1a311e00a4f1872202e513c0ac498e0619" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">real(prec_time)</highlight><highlight class="normal"><sp/>::<sp/>age<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/>time<sp/>variables</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41" refid="structsource__identity_1_1source__state_1ae70b1762af6a3fd60f76226ac858cd6d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">logical</highlight><highlight class="normal"><sp/>::<sp/>active</highlight></codeline>
<codeline lineno="42" refid="structsource__identity_1_1source__state_1a070917562792ada99bdb2eaa2b5274e8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(vector)<sp/>::<sp/>pos</highlight></codeline>
<codeline lineno="43" refid="structsource__identity_1_1source__state_1aea32db0332ef565f04ab210f5b17dba1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(vector)<sp/>::<sp/>vel</highlight></codeline>
<codeline lineno="44" refid="structsource__identity_1_1source__state_1a1986d6dec1ccc5bbfd54e4bbc8f2e4d5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">real(prec)</highlight><highlight class="normal"><sp/>::<sp/>depth</highlight></codeline>
<codeline lineno="45" refid="structsource__identity_1_1source__state_1ac370880f81e096a7aabb9fca144143fb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">real(prec)</highlight><highlight class="normal"><sp/>::<sp/>t</highlight></codeline>
<codeline lineno="46"><highlight class="keyword"><sp/><sp/><sp/><sp/>end<sp/>type</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight></codeline>
<codeline lineno="48" refid="structsource__identity_1_1source__stats" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">type</highlight><highlight class="normal"><sp/><ref refid="structsource__identity_1_1source__stats" kindref="compound">source_stats</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/>All<sp/>stats<sp/>variables<sp/>at<sp/>writing<sp/>precision<sp/>(prec_wrt)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/>Avegarge<sp/>variable<sp/>is<sp/>computed<sp/>by<sp/>Accumulated_var<sp/>/<sp/>ns</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51" refid="structsource__identity_1_1source__stats_1a1b11065093e55320520604392399d1c9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">integer</highlight><highlight class="normal"><sp/>::<sp/>particles_emitted</highlight></codeline>
<codeline lineno="52" refid="structsource__identity_1_1source__stats_1a76eafb42aad8f5a2a859f12c0fd6f683" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">real(prec_wrt)</highlight><highlight class="normal"><sp/>::<sp/>acc_t</highlight></codeline>
<codeline lineno="53" refid="structsource__identity_1_1source__stats_1a0d1e978cf3224049d1c15b23b8d16fa7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">integer</highlight><highlight class="normal"><sp/>::<sp/>ns</highlight></codeline>
<codeline lineno="54"><highlight class="keyword"><sp/><sp/><sp/><sp/>end<sp/>type</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="56" refid="structsource__identity_1_1source__stencil" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">type</highlight><highlight class="normal"><sp/><ref refid="structsource__identity_1_1source__stencil" kindref="compound">source_stencil</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="57" refid="structsource__identity_1_1source__stencil_1a2d71d3aefbd9e69874f490ddae97ce64" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">integer</highlight><highlight class="normal"><sp/>::<sp/>np</highlight></codeline>
<codeline lineno="58" refid="structsource__identity_1_1source__stencil_1a11f7462457253157db252466b51000f2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">integer</highlight><highlight class="normal"><sp/>::<sp/>total_np</highlight></codeline>
<codeline lineno="59" refid="structsource__identity_1_1source__stencil_1a91822da10e869f72071fa29e2bb2c080" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(vector),<sp/></highlight><highlight class="keywordtype">allocatable</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">dimension(:)</highlight><highlight class="normal"><sp/>::<sp/>ptlist</highlight></codeline>
<codeline lineno="60"><highlight class="keyword"><sp/><sp/><sp/><sp/>end<sp/>type</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62" refid="structsource__identity_1_1source__class" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">type</highlight><highlight class="normal"><sp/><ref refid="structsource__identity_1_1source__class" kindref="compound">source_class</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="63" refid="structsource__identity_1_1source__class_1a99403ddb327779cbdbb98f15ca9116a8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(<ref refid="structsource__identity_1_1source__par" kindref="compound">source_par</ref>)<sp/><sp/><sp/>::<sp/>par</highlight></codeline>
<codeline lineno="64" refid="structsource__identity_1_1source__class_1a75abb328a740fa4c23201e1c311312d1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(<ref refid="structsource__identity_1_1source__state" kindref="compound">source_state</ref>)<sp/>::<sp/>now</highlight></codeline>
<codeline lineno="65" refid="structsource__identity_1_1source__class_1a470518874a42bab9225f3c72be0128ba" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(<ref refid="structsource__identity_1_1source__stencil" kindref="compound">source_stencil</ref>)<sp/>::<sp/>stencil</highlight></codeline>
<codeline lineno="66" refid="structsource__identity_1_1source__class_1a630571a5e588a6ced99787b473bf5e2f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(<ref refid="structsource__identity_1_1source__stats" kindref="compound">source_stats</ref>)<sp/>::<sp/>stats</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">contains</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68" refid="structsource__identity_1_1source__class_1af232e5b647bcb16f34dcc2f797ef7a95" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">procedure</highlight><highlight class="normal"><sp/>::<sp/>initialize</highlight></codeline>
<codeline lineno="69" refid="structsource__identity_1_1source__class_1ad889c3a7ce279e199ecf059a50a73ca2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">procedure</highlight><highlight class="normal"><sp/>::<sp/>linkproperty</highlight></codeline>
<codeline lineno="70" refid="structsource__identity_1_1source__class_1ac9866a62bf8838665bb929deff5bce24" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">procedure</highlight><highlight class="normal"><sp/>::<sp/>printout</highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight><highlight class="keyword"><sp/><sp/><sp/><sp/>end<sp/>type</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!Simulation<sp/>variables</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74" refid="namespacesource__identity_1a5ed8006613af7461c6a2ff1cdaeb8f0f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(<ref refid="structsource__identity_1_1source__class" kindref="compound">source_class</ref>),<sp/></highlight><highlight class="keywordtype">allocatable</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">dimension(:)</highlight><highlight class="normal"><sp/>::<sp/><ref refid="namespacesource__identity_1a5ed8006613af7461c6a2ff1cdaeb8f0f" kindref="member">source</ref></highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!Public<sp/>access<sp/>vars</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">public</highlight><highlight class="normal"><sp/>::<sp/><ref refid="namespacesource__identity_1a5ed8006613af7461c6a2ff1cdaeb8f0f" kindref="member">source</ref>,<sp/><ref refid="structsource__identity_1_1source__class" kindref="compound">source_class</ref></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!Public<sp/>access<sp/>procedures</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">public</highlight><highlight class="normal"><sp/>::<sp/><ref refid="namespacesource__identity_1a716b4cb4acec5756a6d4dcf20eee588e" kindref="member">allocsources</ref>,<sp/><ref refid="namespacesource__identity_1a8b07a03d4f79249743896163e9c85f55" kindref="member">setsourceproperties</ref></highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">contains</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!---------------------------------------------------------------------------</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/>Routine<sp/>Author<sp/>Name<sp/>and<sp/>Affiliation.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight><highlight class="keyword"><sp/><sp/><sp/><sp/>subroutine<sp/></highlight><highlight class="normal"><ref refid="namespacesource__identity_1a716b4cb4acec5756a6d4dcf20eee588e" kindref="member">allocsources</ref>(nsources)</highlight></codeline>
<codeline lineno="94" refid="namespacesource__identity_1a716b4cb4acec5756a6d4dcf20eee588e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">implicit<sp/>none</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">integer</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">intent(in)</highlight><highlight class="normal"><sp/>::<sp/>nsources</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">integer</highlight><highlight class="normal"><sp/>err</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(string)<sp/>::<sp/>outext</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">allocate</highlight><highlight class="normal">(<ref refid="namespacesource__identity_1a5ed8006613af7461c6a2ff1cdaeb8f0f" kindref="member">source</ref>(nsources),<sp/>stat=err)</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(err/=0)</highlight><highlight class="keywordflow">then</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outext=</highlight><highlight class="stringliteral">&apos;Cannot<sp/>allocate<sp/>Sources,<sp/>stoping&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal">tolog(outext)</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stop</highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/>endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight><highlight class="keyword"><sp/><sp/><sp/><sp/>end<sp/>subroutine</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!---------------------------------------------------------------------------</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/>Routine<sp/>Author<sp/>Name<sp/>and<sp/>Affiliation.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"></highlight><highlight class="keyword"><sp/><sp/><sp/><sp/>subroutine<sp/></highlight><highlight class="normal"><ref refid="namespacesource__identity_1a8b07a03d4f79249743896163e9c85f55" kindref="member">setsourceproperties</ref>(srcid_str,ptype,pname)</highlight></codeline>
<codeline lineno="116" refid="namespacesource__identity_1a8b07a03d4f79249743896163e9c85f55" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">implicit<sp/>none</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(string),<sp/></highlight><highlight class="keywordtype">intent(in)</highlight><highlight class="normal"><sp/>::<sp/>srcid_str</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(string),<sp/></highlight><highlight class="keywordtype">intent(in)</highlight><highlight class="normal"><sp/>::<sp/>ptype</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(string),<sp/></highlight><highlight class="keywordtype">intent(in)</highlight><highlight class="normal"><sp/>::<sp/>pname</highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">integer</highlight><highlight class="normal"><sp/>::<sp/>srcid</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(string)<sp/>::<sp/>outext,<sp/>temp</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">integer</highlight><highlight class="normal"><sp/>::<sp/>i</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">logical</highlight><highlight class="normal"><sp/>::<sp/>notlinked</highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/>srcid<sp/>=<sp/>srcid_str%to_number(kind=1_i1p)</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/>notlinked<sp/>=<sp/>.true.<sp/><sp/></highlight><highlight class="comment">!assuming<sp/>not<sp/>linked</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>i=1,<sp/></highlight><highlight class="keyword">size</highlight><highlight class="normal">(<ref refid="namespacesource__identity_1a5ed8006613af7461c6a2ff1cdaeb8f0f" kindref="member">source</ref>)</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="namespacesource__identity_1a5ed8006613af7461c6a2ff1cdaeb8f0f" kindref="member">source</ref>(i)%par%id<sp/>==<sp/>srcid)<sp/></highlight><highlight class="keywordflow">then</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">!<sp/>found<sp/>the<sp/>correct<sp/>source<sp/>to<sp/>link<sp/>to</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal"><ref refid="namespacesource__identity_1a5ed8006613af7461c6a2ff1cdaeb8f0f" kindref="member">source</ref>(i)%linkproperty(ptype,pname)<sp/></highlight><highlight class="comment">!<sp/>calling<sp/>Source<sp/>method<sp/>to<sp/>link<sp/>property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>temp<sp/>=<sp/><ref refid="namespacesource__identity_1a5ed8006613af7461c6a2ff1cdaeb8f0f" kindref="member">source</ref>(i)%par%id</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outext=</highlight><highlight class="stringliteral">&apos;<sp/><sp/><sp/><sp/><sp/><sp/>Source<sp/>id<sp/>=<sp/>&apos;</highlight><highlight class="normal">//<sp/>temp<sp/>//<sp/></highlight><highlight class="stringliteral">&apos;,<sp/>&apos;</highlight><highlight class="normal">//<sp/><ref refid="namespacesource__identity_1a5ed8006613af7461c6a2ff1cdaeb8f0f" kindref="member">source</ref>(i)%par%name<sp/>//</highlight><highlight class="stringliteral">&apos;<sp/>is<sp/>of<sp/>type<sp/>&apos;</highlight><highlight class="normal">//<sp/><ref refid="namespacesource__identity_1a5ed8006613af7461c6a2ff1cdaeb8f0f" kindref="member">source</ref>(i)%par%property_type<sp/>//</highlight><highlight class="stringliteral">&apos;,<sp/>with<sp/>property<sp/>name<sp/>&apos;</highlight><highlight class="normal"><sp/>//<sp/><ref refid="namespacesource__identity_1a5ed8006613af7461c6a2ff1cdaeb8f0f" kindref="member">source</ref>(i)%par%property_name</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal">tolog(outext)</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>notlinked<sp/>=<sp/>.false.<sp/></highlight><highlight class="comment">!<sp/>we<sp/>linked<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">exit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/>enddo</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(notlinked)<sp/></highlight><highlight class="keywordflow">then</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">!<sp/>property<sp/>has<sp/>no<sp/>corresponding<sp/>Source</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>temp<sp/>=<sp/>srcid</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outext=</highlight><highlight class="stringliteral">&apos;<sp/><sp/><sp/><sp/><sp/><sp/>Source<sp/>id<sp/>=<sp/>&apos;</highlight><highlight class="normal">//<sp/>temp<sp/>//</highlight><highlight class="stringliteral">&apos;<sp/>not<sp/>listed,<sp/>property<sp/>&apos;</highlight><highlight class="normal">//<sp/>pname<sp/>//</highlight><highlight class="stringliteral">&apos;,<sp/>of<sp/>type<sp/>&apos;</highlight><highlight class="normal"><sp/>//<sp/>ptype<sp/>//<sp/></highlight><highlight class="stringliteral">&apos;<sp/>not<sp/>linked,<sp/>ignoring&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal">tolog(outext)</highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/>endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight><highlight class="keyword"><sp/><sp/><sp/><sp/>end<sp/>subroutine</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!---------------------------------------------------------------------------</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/>Routine<sp/>Author<sp/>Name<sp/>and<sp/>Affiliation.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"></highlight><highlight class="keyword"><sp/><sp/><sp/><sp/>subroutine<sp/></highlight><highlight class="normal"><ref refid="namespaceinitialize" kindref="compound">initialize</ref>(src,id,name,emitting_rate,start,finish,source_geometry,geometry)</highlight></codeline>
<codeline lineno="156" refid="namespacesource__identity_1a8d7aaa58c575f6ed78f5ca29d64615d7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">implicit<sp/>none</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">class</highlight><highlight class="normal">(<ref refid="structsource__identity_1_1source__class" kindref="compound">source_class</ref>)<sp/>::<sp/>src</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">integer</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">intent(in)</highlight><highlight class="normal"><sp/>::<sp/>id</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(string),<sp/></highlight><highlight class="keywordtype">intent(in)</highlight><highlight class="normal"><sp/>::<sp/>name</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">real(prec)</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">intent(in)</highlight><highlight class="normal"><sp/>::<sp/>emitting_rate</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">real(prec)</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">intent(in)</highlight><highlight class="normal"><sp/>::<sp/>start</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">real(prec)</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">intent(in)</highlight><highlight class="normal"><sp/>::<sp/>finish</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(string),<sp/></highlight><highlight class="keywordtype">intent(in)</highlight><highlight class="normal"><sp/>::<sp/>source_geometry</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">class</highlight><highlight class="normal">(shape),<sp/></highlight><highlight class="keywordtype">intent(in)</highlight><highlight class="normal"><sp/>::<sp/>geometry</highlight></codeline>
<codeline lineno="165"><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">integer</highlight><highlight class="normal"><sp/>::<sp/>sizem,<sp/>i</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(string)<sp/>::<sp/>outext</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">integer</highlight><highlight class="normal"><sp/>::<sp/>err</highlight></codeline>
<codeline lineno="169"><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!Setting<sp/>parameters</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/>src%par%id=id</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/>src%par%emitting_rate=emitting_rate</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/>src%par%startime=start</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/>src%par%stoptime=finish</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/>src%par%name=name</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/>src%par%source_geometry=source_geometry</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">allocate</highlight><highlight class="normal">(src%par%geometry,<sp/><ref refid="namespacesource__identity_1a5ed8006613af7461c6a2ff1cdaeb8f0f" kindref="member">source</ref>=<ref refid="namespacegeometry" kindref="compound">geometry</ref>)</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/>src%par%property_type<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;pure&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">!<sp/>pure<sp/>Lagrangian<sp/>trackers<sp/>by<sp/>default</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/>src%par%property_name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;pure&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!Setting<sp/>state<sp/>variables</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/>src%now%age=0.0</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/>src%now%active=.false.<sp/></highlight><highlight class="comment">!disabled<sp/>by<sp/>default</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/>src%now%pos=src%par%geometry%pt<sp/></highlight><highlight class="comment">!coords<sp/>of<sp/>the<sp/>Source<sp/>(meaning<sp/>depends<sp/>on<sp/>the<sp/>geometry<sp/>type!)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!setting<sp/>statistical<sp/>samplers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/>src%stats%particles_emitted=0</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/>src%stats%acc_T=0.0</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/>src%stats%ns=0</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!setting<sp/>stencil<sp/>variables</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal">src%par%geometry%getnp(src%stencil%np,<ref refid="namespacesimulation__globals_1ae851f977b442737307cd4bb76f2f68be" kindref="member">simdefs</ref>%Dp)</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">allocate</highlight><highlight class="normal">(src%stencil%ptlist(src%stencil%np),<sp/>stat=err)</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(err/=0)</highlight><highlight class="keywordflow">then</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outext=</highlight><highlight class="stringliteral">&apos;Cannot<sp/>allocate<sp/>point<sp/>list<sp/>for<sp/>Source<sp/>&apos;</highlight><highlight class="normal">//<sp/>src%par%name<sp/>//</highlight><highlight class="stringliteral">&apos;,<sp/>stoping&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal">tolog(outext)</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stop</highlight></codeline>
<codeline lineno="195"><highlight class="normal"></highlight><highlight class="keywordflow"><sp/><sp/><sp/><sp/>endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal">src%par%geometry%getpointdistribution(src%stencil%np,<ref refid="namespacesimulation__globals_1ae851f977b442737307cd4bb76f2f68be" kindref="member">simdefs</ref>%Dp,src%stencil%ptlist)</highlight></codeline>
<codeline lineno="197"><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/>sizem<sp/>=<sp/>sizeof(src)</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal">simmemory%addsource(sizem)</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal">src%printout()</highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!DBG</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!do<sp/>i=1,<sp/>src%stencil%np</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!print*,<sp/>src%stencil%ptlist(i)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!end<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="207"><highlight class="normal"></highlight><highlight class="keyword"><sp/><sp/><sp/><sp/>end<sp/>subroutine</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!---------------------------------------------------------------------------</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/>Routine<sp/>Author<sp/>Name<sp/>and<sp/>Affiliation.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="219"><highlight class="normal"></highlight><highlight class="keyword"><sp/><sp/><sp/><sp/>subroutine<sp/></highlight><highlight class="normal"><ref refid="namespacesource__identity_1a43fd5b86e85ddeadf982708445286e26" kindref="member">linkproperty</ref>(src,ptype,pname)</highlight></codeline>
<codeline lineno="220" refid="namespacesource__identity_1a43fd5b86e85ddeadf982708445286e26" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">implicit<sp/>none</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">class</highlight><highlight class="normal">(<ref refid="structsource__identity_1_1source__class" kindref="compound">source_class</ref>)<sp/>::<sp/>src</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(string),<sp/></highlight><highlight class="keywordtype">intent(in)</highlight><highlight class="normal"><sp/>::<sp/>ptype</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(string),<sp/></highlight><highlight class="keywordtype">intent(in)</highlight><highlight class="normal"><sp/>::<sp/>pname</highlight></codeline>
<codeline lineno="224"><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/>src%par%property_type<sp/>=<sp/>ptype</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/>src%par%property_name<sp/>=<sp/>pname</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight><highlight class="keyword"><sp/><sp/><sp/><sp/>end<sp/>subroutine</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!---------------------------------------------------------------------------</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!<sp/>Routine<sp/>Author<sp/>Name<sp/>and<sp/>Affiliation.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">!---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"></highlight><highlight class="keyword"><sp/><sp/><sp/><sp/>subroutine<sp/></highlight><highlight class="normal"><ref refid="namespacesource__identity_1a9715a7d707b4c80aa2d2ebd08712f6a9" kindref="member">printout</ref>(src)</highlight></codeline>
<codeline lineno="241" refid="namespacesource__identity_1a9715a7d707b4c80aa2d2ebd08712f6a9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">implicit<sp/>none</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">class</highlight><highlight class="normal">(<ref refid="structsource__identity_1_1source__class" kindref="compound">source_class</ref>)<sp/>::<sp/>src</highlight></codeline>
<codeline lineno="243"><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(string)<sp/>::<sp/>outext</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">type</highlight><highlight class="normal">(string)<sp/>::<sp/>temp_str(3)</highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/>temp_str(1)=src%par%id</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/>outext<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;--&gt;Source<sp/>&apos;</highlight><highlight class="normal">//src%par%name//</highlight><highlight class="stringliteral">&apos;<sp/>allocated&apos;</highlight><highlight class="normal">//new_line(</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)//&amp;</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;<sp/><sp/><sp/><sp/><sp/><sp/><sp/>Id<sp/>=<sp/>&apos;</highlight><highlight class="normal">//temp_str(1)//new_line(</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)//&amp;</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;<sp/><sp/><sp/><sp/><sp/><sp/><sp/>Geometry<sp/>type<sp/>is<sp/>&apos;</highlight><highlight class="normal">//src%par%source_geometry//new_line(</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/>temp_str(1)=src%now%pos%x</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/>temp_str(2)=src%now%pos%y</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/>temp_str(3)=src%now%pos%z</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/>outext<sp/>=<sp/>outext//</highlight><highlight class="stringliteral">&apos;<sp/><sp/><sp/><sp/><sp/><sp/><sp/>Initially<sp/>at<sp/>coordinates&apos;</highlight><highlight class="normal">//new_line(</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)//&amp;</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;<sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;</highlight><highlight class="normal">//temp_str(1)//</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">//temp_str(2)//</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">//temp_str(3)//new_line(</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/>temp_str(1)=src%par%emitting_rate</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/>temp_str(2)=src%stencil%np</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/>outext<sp/>=<sp/>outext//</highlight><highlight class="stringliteral">&apos;<sp/><sp/><sp/><sp/><sp/><sp/><sp/>Emitting<sp/>&apos;</highlight><highlight class="normal">//temp_str(2)//</highlight><highlight class="stringliteral">&apos;<sp/>tracers<sp/>at<sp/>a<sp/>rate<sp/>of<sp/>&apos;</highlight><highlight class="normal">//temp_str(1)//</highlight><highlight class="stringliteral">&apos;<sp/>Hz&apos;</highlight><highlight class="normal">//new_line(</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/>temp_str(1)=src%par%startime</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/>temp_str(2)=src%par%stoptime</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/>outext<sp/>=<sp/>outext//</highlight><highlight class="stringliteral">&apos;<sp/><sp/><sp/><sp/><sp/><sp/><sp/>Active<sp/>from<sp/>&apos;</highlight><highlight class="normal">//temp_str(1)//</highlight><highlight class="stringliteral">&apos;<sp/>to<sp/>&apos;</highlight><highlight class="normal">//temp_str(2)//</highlight><highlight class="stringliteral">&apos;<sp/>seconds&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"></highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">call<sp/></highlight><highlight class="normal">tolog(outext,.false.)</highlight></codeline>
<codeline lineno="264"><highlight class="normal"></highlight></codeline>
<codeline lineno="265"><highlight class="normal"></highlight><highlight class="keyword"><sp/><sp/><sp/><sp/>end<sp/>subroutine</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="266"><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight><highlight class="keyword"><sp/><sp/><sp/><sp/>end<sp/>module<sp/></highlight><highlight class="normal"><ref refid="namespacesource__identity" kindref="compound">source_identity</ref></highlight></codeline>
    </programlisting>
    <location file="C:/Users/administrator/Documents/GitHub/MOHID-Lagrangian/src/lib/source_identity.f90"/>
  </compounddef>
</doxygen>
