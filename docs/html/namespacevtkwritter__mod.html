<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MOHID Lagrangian: vtkwritter_mod Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ML_logo2_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MOHID Lagrangian
   &#160;<span id="projectnumber">0.2</span>
   </div>
   <div id="projectbrief">Lagrangian module/standalone app for the MOHID system</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacevtkwritter__mod.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">vtkwritter_mod Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Defines a vtk writer class with an object exposable to the Output streamer. Writes files in .xml vtk, both in serial and parallel model. Uses an unstructured mesh format specifier to store any type of data, both meshes and Tracers. Supports scalar and vectorial data.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvtkwritter__mod_1_1vtkwritter__class.html">vtkwritter_class</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:abd35d591c8e15730a277b2d26deb83e8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevtkwritter__mod.html#abd35d591c8e15730a277b2d26deb83e8">initvtkwritter</a> (self)</td></tr>
<tr class="memdesc:abd35d591c8e15730a277b2d26deb83e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a VTK writer object.  <a href="#abd35d591c8e15730a277b2d26deb83e8">More...</a><br /></td></tr>
<tr class="separator:abd35d591c8e15730a277b2d26deb83e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13f1b870d2367704bcd4143a80b552f9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevtkwritter__mod.html#a13f1b870d2367704bcd4143a80b552f9">closevtkwriter</a> (self)</td></tr>
<tr class="memdesc:a13f1b870d2367704bcd4143a80b552f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes a VTK writer object.  <a href="#a13f1b870d2367704bcd4143a80b552f9">More...</a><br /></td></tr>
<tr class="separator:a13f1b870d2367704bcd4143a80b552f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe9e092f90713f5e00585f915fe86c2c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevtkwritter__mod.html#abe9e092f90713f5e00585f915fe86c2c">tracerserial</a> (self, filename, numTracers, blocks, outputVars)</td></tr>
<tr class="memdesc:abe9e092f90713f5e00585f915fe86c2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Public Tracer writting routine. Writes Tracer data in binary XML VTK format using an unstructured grid. Serial writer for serial files.  <a href="#abe9e092f90713f5e00585f915fe86c2c">More...</a><br /></td></tr>
<tr class="separator:abe9e092f90713f5e00585f915fe86c2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c50b52b496bad6b053ffd5749da1582"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevtkwritter__mod.html#a4c50b52b496bad6b053ffd5749da1582">indexvtkfile</a> (self, filename, timestamp)</td></tr>
<tr class="memdesc:a4c50b52b496bad6b053ffd5749da1582"><td class="mdescLeft">&#160;</td><td class="mdescRight">indexes a given file with a correct time stamp in a paraview readable xml format.  <a href="#a4c50b52b496bad6b053ffd5749da1582">More...</a><br /></td></tr>
<tr class="separator:a4c50b52b496bad6b053ffd5749da1582"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c26bb22a8b7dd9f9da69309ad65d669"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevtkwritter__mod.html#a0c26bb22a8b7dd9f9da69309ad65d669">openindexvtkfile</a> (self)</td></tr>
<tr class="memdesc:a0c26bb22a8b7dd9f9da69309ad65d669"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open vtu file indexer.  <a href="#a0c26bb22a8b7dd9f9da69309ad65d669">More...</a><br /></td></tr>
<tr class="separator:a0c26bb22a8b7dd9f9da69309ad65d669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f9a731d9dee5651f85d4aeed3f3ea5d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevtkwritter__mod.html#a6f9a731d9dee5651f85d4aeed3f3ea5d">closeindexvtkfile</a> (self)</td></tr>
<tr class="memdesc:a6f9a731d9dee5651f85d4aeed3f3ea5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close vtu file indexer.  <a href="#a6f9a731d9dee5651f85d4aeed3f3ea5d">More...</a><br /></td></tr>
<tr class="separator:a6f9a731d9dee5651f85d4aeed3f3ea5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f44d9fd1c5da759c4f2d721d12a8181"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevtkwritter__mod.html#a9f44d9fd1c5da759c4f2d721d12a8181">domain</a> (self, filename, bbox, npbbox, blocks)</td></tr>
<tr class="memdesc:a9f44d9fd1c5da759c4f2d721d12a8181"><td class="mdescLeft">&#160;</td><td class="mdescRight">Public simulation domain writting routine. Writes binary XML VTK format using an unstructured grid.  <a href="#a9f44d9fd1c5da759c4f2d721d12a8181">More...</a><br /></td></tr>
<tr class="separator:a9f44d9fd1c5da759c4f2d721d12a8181"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Defines a vtk writer class with an object exposable to the Output streamer. Writes files in .xml vtk, both in serial and parallel model. Uses an unstructured mesh format specifier to store any type of data, both meshes and Tracers. Supports scalar and vectorial data. </p>
<dl class="section author"><dt>Author</dt><dd>Ricardo Birjukovs Canelas </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a6f9a731d9dee5651f85d4aeed3f3ea5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f9a731d9dee5651f85d4aeed3f3ea5d">&#9670;&nbsp;</a></span>closeindexvtkfile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vtkwritter_mod::closeindexvtkfile </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structvtkwritter__mod_1_1vtkwritter__class.html">vtkwritter_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Close vtu file indexer. </p>
<dl class="section author"><dt>Author</dt><dd>Ricardo Birjukovs Canelas - MARETEC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vtkwritter_8f90_source.html#l00233">233</a> of file <a class="el" href="vtkwritter_8f90_source.html">vtkwritter.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordtype">class</span>(vtkwritter_class), <span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordtype">type</span>(string) :: outext</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">if</span> (self%indexerOpen) <span class="keywordflow">then</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        outext = <span class="stringliteral">&#39;  &lt;/Collection&gt;&#39;</span>//new_line(<span class="stringliteral">&#39;a&#39;</span>)</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        outext = outext//<span class="stringliteral">&#39;&lt;/VTKFile&gt;&#39;</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keyword">write</span>(self%indexerUnit,<span class="stringliteral">&quot;(A)&quot;</span>) outext%chars()</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keyword">close</span>(self%indexerUnit)</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="keywordflow">    end if</span></div></div><!-- fragment -->
</div>
</div>
<a id="a13f1b870d2367704bcd4143a80b552f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13f1b870d2367704bcd4143a80b552f9">&#9670;&nbsp;</a></span>closevtkwriter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vtkwritter_mod::closevtkwriter </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structvtkwritter__mod_1_1vtkwritter__class.html">vtkwritter_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Closes a VTK writer object. </p>
<dl class="section author"><dt>Author</dt><dd>Ricardo Birjukovs Canelas - MARETEC </dd></dl>

<p class="definition">Definition at line <a class="el" href="vtkwritter_8f90_source.html#l00069">69</a> of file <a class="el" href="vtkwritter_8f90_source.html">vtkwritter.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordtype">class</span>(vtkwritter_class), <span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keyword">call </span>self%CloseIndexVTKFile()</div></div><!-- fragment -->
</div>
</div>
<a id="a9f44d9fd1c5da759c4f2d721d12a8181"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f44d9fd1c5da759c4f2d721d12a8181">&#9670;&nbsp;</a></span>domain()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vtkwritter_mod::domain </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structvtkwritter__mod_1_1vtkwritter__class.html">vtkwritter_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(string), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structboundingbox__mod_1_1boundingbox__class.html">boundingbox_class</a>), intent(in)&#160;</td>
          <td class="paramname"><em>bbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>npbbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structblocks__mod_1_1block__class.html">block_class</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>blocks</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Public simulation domain writting routine. Writes binary XML VTK format using an unstructured grid. </p>
<dl class="section author"><dt>Author</dt><dd>Ricardo Birjukovs Canelas - MARETEC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self,filename,bbox,npbbox,blocks</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>name of the case to add</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bbox</td><td>Case bounding box</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blocks</td><td>Case Blocks</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npbbox</td><td>number of points of the bbox geometry </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vtkwritter_8f90_source.html#l00251">251</a> of file <a class="el" href="vtkwritter_8f90_source.html">vtkwritter.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordtype">class</span>(vtkwritter_class), <span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordtype">type</span>(string), <span class="keywordtype">intent(in)</span> :: filename</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordtype">class</span>(boundingbox_class), <span class="keywordtype">intent(in)</span> :: bbox</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordtype">class</span>(block_class), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: blocks</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: npbbox</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordtype">type</span>(vtk_file) :: vtkfile</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordtype">type</span>(string) :: fullfilename</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordtype">type</span>(string) :: outext</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">integer</span> :: error, i, b</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: nc = 1</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordtype">real(prec)</span>, <span class="keywordtype">dimension(1:npbbox)</span> :: xx, yy, zz</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordtype">type</span>(vector) :: pts(npbbox)</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(1:npbbox)</span> :: connect, var</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordtype">integer(I4P)</span>, <span class="keywordtype">dimension(1:nc)</span> :: offset</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">integer(I1P)</span>, <span class="keywordtype">dimension(1:nc)</span> :: cell_type</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    offset = [8]</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    cell_type = [12]</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">!preparing file</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    fullfilename = filename%chars()//<span class="stringliteral">&#39;_BoundingBox.vtu&#39;</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    outext = <span class="stringliteral">&#39;-&gt;Writting Bounding Box file &#39;</span>//fullfilename</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keyword">call </span>log%put(outext)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    fullfilename = globals%Names%outpath//<span class="stringliteral">&#39;/&#39;</span>//fullfilename</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    error = vtkfile%initialize(format=self%formatType%chars(), filename=fullfilename%chars(), mesh_topology=<span class="stringliteral">&#39;UnstructuredGrid&#39;</span>)</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">!Writting bounding box geometry</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    pts = geometry%getPoints(bbox)</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">do</span> i=1, npbbox</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        xx(i) = pts(i)%x</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        yy(i) = pts(i)%y</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        zz(i) = pts(i)%z</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        connect(i) = i-1</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keywordflow">    end do</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    error = vtkfile%xml_writer%write_piece(np=npbbox, nc=nc)</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    error = vtkfile%xml_writer%write_geo(np=npbbox, nc=nc, x=xx, y=yy, z=zz)</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    error = vtkfile%xml_writer%write_connectivity(nc=nc, connectivity=connect, offset=offset, cell_type=cell_type)</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    error = vtkfile%xml_writer%write_piece()</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">!Closing file</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    error = vtkfile%finalize()</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">!preparing file</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    fullfilename = filename%chars()//<span class="stringliteral">&#39;_Blocks.vtu&#39;</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    outext = <span class="stringliteral">&#39;-&gt;Writting Blocks file &#39;</span>//fullfilename</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keyword">call </span>log%put(outext)</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    fullfilename = globals%Names%outpath//<span class="stringliteral">&#39;/&#39;</span>//fullfilename</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    error = vtkfile%initialize(format=self%formatType%chars(), filename=fullfilename%chars(), mesh_topology=<span class="stringliteral">&#39;UnstructuredGrid&#39;</span>)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">!Writting block geometries</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">do</span> b=1, <span class="keyword">size</span>(blocks)</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        pts = geometry%getPoints(blocks(b)%extents)</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordflow">do</span> i=1, npbbox</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            xx(i) = pts(i)%x</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            yy(i) = pts(i)%y</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            <span class="comment">!zz(i) = pts(i)%z</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            connect(i) = i-1</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            var(i) = b</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        error = vtkfile%xml_writer%write_piece(np=npbbox, nc=nc)</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        error = vtkfile%xml_writer%write_geo(np=npbbox, nc=nc, x=xx, y=yy, z=zz)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        error = vtkfile%xml_writer%write_connectivity(nc=nc, connectivity=connect, offset=offset, cell_type=cell_type)</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        error = vtkfile%xml_writer%write_dataarray(location=<span class="stringliteral">&#39;node&#39;</span>, action=<span class="stringliteral">&#39;open&#39;</span>)</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        error = vtkfile%xml_writer%write_dataarray(data_name=<span class="stringliteral">&#39;Block&#39;</span>, x=var)</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        error = vtkfile%xml_writer%write_dataarray(location=<span class="stringliteral">&#39;node&#39;</span>, action=<span class="stringliteral">&#39;close&#39;</span>)</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        error = vtkfile%xml_writer%write_piece()</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="keywordflow">    end do</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">!Closing file</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    error = vtkfile%finalize()</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a4c50b52b496bad6b053ffd5749da1582"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c50b52b496bad6b053ffd5749da1582">&#9670;&nbsp;</a></span>indexvtkfile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vtkwritter_mod::indexvtkfile </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structvtkwritter__mod_1_1vtkwritter__class.html">vtkwritter_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(string), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(prec), intent(in)&#160;</td>
          <td class="paramname"><em>timestamp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>indexes a given file with a correct time stamp in a paraview readable xml format. </p>
<dl class="section author"><dt>Author</dt><dd>Ricardo Birjukovs Canelas - MARETEC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self,filename,timestamp</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vtkwritter_8f90_source.html#l00193">193</a> of file <a class="el" href="vtkwritter_8f90_source.html">vtkwritter.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">class</span>(vtkwritter_class), <span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">type</span>(string), <span class="keywordtype">intent(in)</span> :: filename</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">real(prec)</span>, <span class="keywordtype">intent(in)</span> :: timestamp</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordtype">type</span>(string) :: outext, temp</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">if</span> (.not. self%indexerOpen) <span class="keywordflow">then</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keyword">call </span>self%OpenIndexVTKFile()</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keywordflow">    end if</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    temp = timestamp</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    outext = <span class="stringliteral">&#39;&lt;DataSet timestep=&quot;&#39;</span>//temp//<span class="stringliteral">&#39;&quot; file=&quot;&#39;</span>//filename//<span class="stringliteral">&#39;&quot;/&gt;&#39;</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keyword">write</span>(self%indexerUnit,<span class="stringliteral">&quot;(A)&quot;</span>) outext%chars()</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="abd35d591c8e15730a277b2d26deb83e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd35d591c8e15730a277b2d26deb83e8">&#9670;&nbsp;</a></span>initvtkwritter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vtkwritter_mod::initvtkwritter </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structvtkwritter__mod_1_1vtkwritter__class.html">vtkwritter_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes a VTK writer object. </p>
<dl class="section author"><dt>Author</dt><dd>Ricardo Birjukovs Canelas - MARETEC </dd></dl>

<p class="definition">Definition at line <a class="el" href="vtkwritter_8f90_source.html#l00058">58</a> of file <a class="el" href="vtkwritter_8f90_source.html">vtkwritter.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordtype">class</span>(vtkwritter_class), <span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    self%numVtkFiles = 0</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    self%formatType = <span class="stringliteral">&#39;raw&#39;</span></div></div><!-- fragment -->
</div>
</div>
<a id="a0c26bb22a8b7dd9f9da69309ad65d669"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c26bb22a8b7dd9f9da69309ad65d669">&#9670;&nbsp;</a></span>openindexvtkfile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vtkwritter_mod::openindexvtkfile </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structvtkwritter__mod_1_1vtkwritter__class.html">vtkwritter_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Open vtu file indexer. </p>
<dl class="section author"><dt>Author</dt><dd>Ricardo Birjukovs Canelas - MARETEC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vtkwritter_8f90_source.html#l00214">214</a> of file <a class="el" href="vtkwritter_8f90_source.html">vtkwritter.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordtype">class</span>(vtkwritter_class), <span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordtype">type</span>(string) :: outext, indexerFilename</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    indexerfilename = globals%Names%outpath//globals%Names%casename//<span class="stringliteral">&#39;.pvd&#39;</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keyword">open</span>(unit=self%indexerUnit,file=indexerfilename%chars(),action=<span class="stringliteral">&quot;write&quot;</span>,status=<span class="stringliteral">&quot;replace&quot;</span>)</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    outext = <span class="stringliteral">&#39;&lt;VTKFile type=&quot;Collection&quot; version=&quot;0.1&quot; byte_order=&quot;LittleEndian&quot;&gt;&#39;</span>//new_line(<span class="stringliteral">&#39;a&#39;</span>)</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    outext = outext//<span class="stringliteral">&#39;  &lt;Collection&gt;&#39;</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keyword">write</span>(self%indexerUnit,<span class="stringliteral">&quot;(A)&quot;</span>) outext%chars()</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    self%indexerOpen = .true.</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="abe9e092f90713f5e00585f915fe86c2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe9e092f90713f5e00585f915fe86c2c">&#9670;&nbsp;</a></span>tracerserial()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vtkwritter_mod::tracerserial </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structvtkwritter__mod_1_1vtkwritter__class.html">vtkwritter_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(string), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>numTracers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structblocks__mod_1_1block__class.html">block_class</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>blocks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(string), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>outputVars</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Public Tracer writting routine. Writes Tracer data in binary XML VTK format using an unstructured grid. Serial writer for serial files. </p>
<dl class="section author"><dt>Author</dt><dd>Ricardo Birjukovs Canelas - MARETEC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self,filename,numTracers,blocks,outputVars</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blocks</td><td>Case Blocks </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vtkwritter_8f90_source.html#l00081">81</a> of file <a class="el" href="vtkwritter_8f90_source.html">vtkwritter.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordtype">class</span>(vtkwritter_class), <span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordtype">type</span>(string), <span class="keywordtype">intent(in)</span> :: filename</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: numTracers</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordtype">class</span>(block_class), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: blocks</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordtype">type</span>(string), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: outputVars</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordtype">type</span>(vtk_file) :: vtkfile</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordtype">type</span>(string) :: fullfilename, extfilename</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordtype">type</span>(string) :: outext, tag</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">integer</span> :: error, i, j, b, nf</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">integer</span> :: np</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordtype">integer</span> :: nc</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">integer(I1P)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: cell_type</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">integer(I4P)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: offset</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordtype">integer(I4P)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: connect</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: active</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordtype">real(prec)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: fillValue</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordtype">real(prec)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: ghostNode</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    extfilename = filename%chars()//<span class="stringliteral">&#39;.vtu&#39;</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    fullfilename = globals%Names%outpath//<span class="stringliteral">&#39;/&#39;</span>//extfilename</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    error = vtkfile%initialize(format=self%formatType%chars(), filename=fullfilename%chars(), mesh_topology=<span class="stringliteral">&#39;UnstructuredGrid&#39;</span>)</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">if</span> (numtracers &gt; 0) <span class="keywordflow">then</span>        </div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="comment">!Write the data of each block</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">do</span> i = 1, <span class="keyword">size</span>(blocks)</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(blocks(i)%BlockState)) <span class="keywordflow">then</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                <span class="keywordflow">do</span> b = 1, <span class="keyword">size</span>(blocks(i)%BlockState)</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                    <span class="keyword">allocate</span>(active(<span class="keyword">size</span>(blocks(i)%BlockState(b)%active)))</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                    <span class="keyword">allocate</span>(fillvalue(<span class="keyword">size</span>(blocks(i)%BlockState(b)%active)))</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                    active = blocks(i)%BlockState(b)%active</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                    fillvalue = mv</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                    np = count(active)</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                    nc = np</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                    <span class="keyword">allocate</span>(connect(nc))</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                    <span class="keyword">allocate</span>(offset(nc))</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                    <span class="keyword">allocate</span>(cell_type(nc))</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                    cell_type = 1</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                    <span class="keywordflow">do</span> j = 1, nc</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                        connect(j) = j-1</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                        offset(j) = j-1</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keywordflow">                    end do</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                    error = vtkfile%xml_writer%write_piece(np=np, nc=nc)</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                    error = vtkfile%xml_writer%write_geo(np=np, nc=nc, x=pack(blocks(i)%BlockState(b)%state(:,1), active), y=pack(blocks(i)%BlockState(b)%state(:,2), active), z=pack(blocks(i)%BlockState(b)%state(:,3), active))</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                    error = vtkfile%xml_writer%write_connectivity(nc=nc, connectivity=connect, offset=offset, cell_type=cell_type)</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                    error = vtkfile%xml_writer%write_dataarray(location=<span class="stringliteral">&#39;node&#39;</span>, action=<span class="stringliteral">&#39;open&#39;</span>)</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                    <span class="comment">!mandatory variables to output</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                    error = vtkfile%xml_writer%write_dataarray(data_name=<span class="stringliteral">&#39;id&#39;</span>, x=pack(blocks(i)%BlockState(b)%id, active))</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                    error = vtkfile%xml_writer%write_dataarray(data_name=<span class="stringliteral">&#39;source&#39;</span>, x=pack(blocks(i)%BlockState(b)%source, active))</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                    error = vtkfile%xml_writer%write_dataarray(data_name=<span class="stringliteral">&#39;velocity&#39;</span>, x=pack(blocks(i)%BlockState(b)%state(:,4), active), y=pack(blocks(i)%BlockState(b)%state(:,5), active), z=pack(blocks(i)%BlockState(b)%state(:,6), active))</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                    error = vtkfile%xml_writer%write_dataarray(data_name=<span class="stringliteral">&#39;state&#39;</span>, x=pack(blocks(i)%BlockState(b)%landIntMask, active))</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                    <span class="comment">!error = vtkfile%xml_writer%write_dataarray(data_name=&#39;resolution&#39;, x=pack(blocks(i)%BlockState(b)%resolution, active))</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                    <span class="comment">!optional variables to output</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                    <span class="keywordflow">do</span> j = 1, <span class="keyword">size</span>(outputvars)</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                        tag = outputvars(j)</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                        nf = utils%find_str(blocks(i)%BlockState(b)%varName, tag, .false.)</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                        <span class="keywordflow">if</span> (nf /= mv_int) error = vtkfile%xml_writer%write_dataarray(data_name=tag%chars(), x=pack(blocks(i)%BlockState(b)%state(:,nf), active))</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                        <span class="keywordflow">if</span> (nf == mv_int) error = vtkfile%xml_writer%write_dataarray(data_name=tag%chars(), x=pack(fillvalue, active))</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keywordflow">                    end do</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                    error = vtkfile%xml_writer%write_dataarray(location=<span class="stringliteral">&#39;node&#39;</span>, action=<span class="stringliteral">&#39;close&#39;</span>)</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                    error = vtkfile%xml_writer%write_piece()</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                    <span class="keyword">deallocate</span>(active)</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                    <span class="keyword">deallocate</span>(fillvalue)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                    <span class="keyword">deallocate</span>(connect)</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                    <span class="keyword">deallocate</span>(offset)</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    <span class="keyword">deallocate</span>(cell_type)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keywordflow">                end do</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        np = <span class="keyword">size</span>(globals%Sources%sourcesID)</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        nc = np</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keyword">allocate</span>(connect(nc))</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keyword">allocate</span>(offset(nc))</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keyword">allocate</span>(cell_type(nc))</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        cell_type = 1</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">do</span> j = 1, nc</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            connect(j) = j-1</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            offset(j) = j-1</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keyword">allocate</span>(ghostnode(np))</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        ghostnode = 0.0</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        error = vtkfile%xml_writer%write_piece(np=np, nc=nc)</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        error = vtkfile%xml_writer%write_geo(np=np, nc=nc, x=ghostnode, y=ghostnode, z=ghostnode)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        error = vtkfile%xml_writer%write_connectivity(nc=nc, connectivity=connect, offset=offset, cell_type=cell_type)</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        error = vtkfile%xml_writer%write_dataarray(location=<span class="stringliteral">&#39;node&#39;</span>, action=<span class="stringliteral">&#39;open&#39;</span>)</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        error = vtkfile%xml_writer%write_dataarray(data_name=<span class="stringliteral">&#39;source&#39;</span>, x=globals%Sources%sourcesID)</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        error = vtkfile%xml_writer%write_dataarray(location=<span class="stringliteral">&#39;node&#39;</span>, action=<span class="stringliteral">&#39;close&#39;</span>)</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        error = vtkfile%xml_writer%write_piece()</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keyword">deallocate</span>(ghostnode)        </div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keyword">deallocate</span>(connect)</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keyword">deallocate</span>(offset)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keyword">deallocate</span>(cell_type)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="keywordflow">    end if</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    error = vtkfile%finalize()</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    self%numVtkFiles = self%numVtkFiles + 1</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span> (self%numVtkFiles /= 1) <span class="keyword">call </span>self%IndexVTKFile(extfilename, globals%SimTime%getDateTimeStamp())</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div></div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacevtkwritter__mod.html">vtkwritter_mod</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
