<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MOHID Lagrangian: netcdfparser_mod Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ML_logo2_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MOHID Lagrangian
   &#160;<span id="projectnumber">0.2</span>
   </div>
   <div id="projectbrief">Lagrangian module/standalone app for the MOHID system</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacenetcdfparser__mod.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">netcdfparser_mod Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Module that defines a netcdf file model class, responsible for abstracting the parsing of netcdf files. Each object of this class is responsible for one file, effectivelly representing it. The object should return the necessary data fields with corresponding meta data, such as names and units. An variable library is consulted when required, because even NetCDF CF compliance allows ambiguity.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnetcdfparser__mod_1_1dim__t.html">dim_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnetcdfparser__mod_1_1ncfile__class.html">ncfile_class</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class that models a netcdf file.  <a href="structnetcdfparser__mod_1_1ncfile__class.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnetcdfparser__mod_1_1ncreader__class.html">ncreader_class</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnetcdfparser__mod_1_1var__t.html">var_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ada78b9f33d39c4763f412f004524cbea"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structbackground__mod_1_1background__class.html">background_class</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenetcdfparser__mod.html#ada78b9f33d39c4763f412f004524cbea">getfullfile</a> (self, fileName, varList, syntecticVar)</td></tr>
<tr class="memdesc:ada78b9f33d39c4763f412f004524cbea"><td class="mdescLeft">&#160;</td><td class="mdescRight">instantiates and returns a background object with the data from a NC file  <a href="#ada78b9f33d39c4763f412f004524cbea">More...</a><br /></td></tr>
<tr class="separator:ada78b9f33d39c4763f412f004524cbea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57c39a4003778a6bf90cfd36b69380bc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenetcdfparser__mod.html#a57c39a4003778a6bf90cfd36b69380bc">getfile</a> (self, filename)</td></tr>
<tr class="memdesc:a57c39a4003778a6bf90cfd36b69380bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse the netcdf file headers and assembles the file model.  <a href="#a57c39a4003778a6bf90cfd36b69380bc">More...</a><br /></td></tr>
<tr class="separator:a57c39a4003778a6bf90cfd36b69380bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a741dd5b5985255e73aa9d3cf08755e91"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenetcdfparser__mod.html#a741dd5b5985255e73aa9d3cf08755e91">getncid</a> (self)</td></tr>
<tr class="memdesc:a741dd5b5985255e73aa9d3cf08755e91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opens the netcdf file, assigns the NCID and checks for errors.  <a href="#a741dd5b5985255e73aa9d3cf08755e91">More...</a><br /></td></tr>
<tr class="separator:a741dd5b5985255e73aa9d3cf08755e91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a409f59662d71fb63e5fb5e057fdfd6ee"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenetcdfparser__mod.html#a409f59662d71fb63e5fb5e057fdfd6ee">getncglobalmetadata</a> (self)</td></tr>
<tr class="memdesc:a409f59662d71fb63e5fb5e057fdfd6ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inquires the nc file for global metadata - number of dimensions, variables and attributes.  <a href="#a409f59662d71fb63e5fb5e057fdfd6ee">More...</a><br /></td></tr>
<tr class="separator:a409f59662d71fb63e5fb5e057fdfd6ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46989199271acb6205cc61ac413d5a56"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenetcdfparser__mod.html#a46989199271acb6205cc61ac413d5a56">getncvarmetadata</a> (self)</td></tr>
<tr class="memdesc:a46989199271acb6205cc61ac413d5a56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inquires the nc file for variable metadata.  <a href="#a46989199271acb6205cc61ac413d5a56">More...</a><br /></td></tr>
<tr class="separator:a46989199271acb6205cc61ac413d5a56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6354ee8b3c773cc7a5ad247ad1e34eeb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenetcdfparser__mod.html#a6354ee8b3c773cc7a5ad247ad1e34eeb">getncdimmetadata</a> (self)</td></tr>
<tr class="memdesc:a6354ee8b3c773cc7a5ad247ad1e34eeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inquires the nc file for dimension metadata.  <a href="#a6354ee8b3c773cc7a5ad247ad1e34eeb">More...</a><br /></td></tr>
<tr class="separator:a6354ee8b3c773cc7a5ad247ad1e34eeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0aea819b8a474ce2f4840d0bc44e95ec"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenetcdfparser__mod.html#a0aea819b8a474ce2f4840d0bc44e95ec">getvardimensions</a> (self, varName, dimsArrays)</td></tr>
<tr class="memdesc:a0aea819b8a474ce2f4840d0bc44e95ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads the dimension fields from the nc file for a given variable. returns an array of scalar 1D fields, each with a name, units and data.  <a href="#a0aea819b8a474ce2f4840d0bc44e95ec">More...</a><br /></td></tr>
<tr class="separator:a0aea819b8a474ce2f4840d0bc44e95ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba877869db6bea7262d659133253cff7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenetcdfparser__mod.html#aba877869db6bea7262d659133253cff7">getvar</a> (self, varName, varField, binaryVar, altName, altUnits)</td></tr>
<tr class="memdesc:aba877869db6bea7262d659133253cff7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads the fields from the nc file for a given variable. returns a generic field, with a name, units and data.  <a href="#aba877869db6bea7262d659133253cff7">More...</a><br /></td></tr>
<tr class="separator:aba877869db6bea7262d659133253cff7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fcd4b7fb27dbc9befd0a6fcfb9929a1"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structnetcdfparser__mod_1_1dim__t.html">dim_t</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenetcdfparser__mod.html#a5fcd4b7fb27dbc9befd0a6fcfb9929a1">getdimbydimid</a> (self, dimID)</td></tr>
<tr class="memdesc:a5fcd4b7fb27dbc9befd0a6fcfb9929a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns a dimension field metadata structure, given a dimID  <a href="#a5fcd4b7fb27dbc9befd0a6fcfb9929a1">More...</a><br /></td></tr>
<tr class="separator:a5fcd4b7fb27dbc9befd0a6fcfb9929a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a518627511cac4bf3dbc338bf3bfd5e24"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenetcdfparser__mod.html#a518627511cac4bf3dbc338bf3bfd5e24">closefile</a> (self)</td></tr>
<tr class="memdesc:a518627511cac4bf3dbc338bf3bfd5e24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the netcdf file.  <a href="#a518627511cac4bf3dbc338bf3bfd5e24">More...</a><br /></td></tr>
<tr class="separator:a518627511cac4bf3dbc338bf3bfd5e24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1a034f6540ac7a1ce7d0e3831bb2f03"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenetcdfparser__mod.html#ae1a034f6540ac7a1ce7d0e3831bb2f03">check</a> (self)</td></tr>
<tr class="memdesc:ae1a034f6540ac7a1ce7d0e3831bb2f03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Debug the netcdf error after a netcdf command.  <a href="#ae1a034f6540ac7a1ce7d0e3831bb2f03">More...</a><br /></td></tr>
<tr class="separator:ae1a034f6540ac7a1ce7d0e3831bb2f03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb48d33c014bae21b2fceaaa70cbdc67"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenetcdfparser__mod.html#aeb48d33c014bae21b2fceaaa70cbdc67">printncinfo</a> (self)</td></tr>
<tr class="memdesc:aeb48d33c014bae21b2fceaaa70cbdc67"><td class="mdescLeft">&#160;</td><td class="mdescRight">prints most of the file model metadata  <a href="#aeb48d33c014bae21b2fceaaa70cbdc67">More...</a><br /></td></tr>
<tr class="separator:aeb48d33c014bae21b2fceaaa70cbdc67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b57fa47d7bd796c75483216a51e5e04"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenetcdfparser__mod.html#a6b57fa47d7bd796c75483216a51e5e04">printvarsnc</a> (self)</td></tr>
<tr class="memdesc:a6b57fa47d7bd796c75483216a51e5e04"><td class="mdescLeft">&#160;</td><td class="mdescRight">print variable metadata  <a href="#a6b57fa47d7bd796c75483216a51e5e04">More...</a><br /></td></tr>
<tr class="separator:a6b57fa47d7bd796c75483216a51e5e04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac01c000a97d23613684155708249ce89"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenetcdfparser__mod.html#ac01c000a97d23613684155708249ce89">printdimsnc</a> (self)</td></tr>
<tr class="memdesc:ac01c000a97d23613684155708249ce89"><td class="mdescLeft">&#160;</td><td class="mdescRight">print dimensions metadata  <a href="#ac01c000a97d23613684155708249ce89">More...</a><br /></td></tr>
<tr class="separator:ac01c000a97d23613684155708249ce89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af93319fde6cf6baedb7fe27bf3396e7b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenetcdfparser__mod.html#af93319fde6cf6baedb7fe27bf3396e7b">correctnctime</a> (timeComments, timeArray)</td></tr>
<tr class="memdesc:af93319fde6cf6baedb7fe27bf3396e7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">corrects the time array to a more efficient format if needed. assumes netcdf comment as 'seconds since 1981-01-01 00:00:00'  <a href="#af93319fde6cf6baedb7fe27bf3396e7b">More...</a><br /></td></tr>
<tr class="separator:af93319fde6cf6baedb7fe27bf3396e7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Module that defines a netcdf file model class, responsible for abstracting the parsing of netcdf files. Each object of this class is responsible for one file, effectivelly representing it. The object should return the necessary data fields with corresponding meta data, such as names and units. An variable library is consulted when required, because even NetCDF CF compliance allows ambiguity. </p>
<dl class="section author"><dt>Author</dt><dd>Daniel Garaboa Paz </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ae1a034f6540ac7a1ce7d0e3831bb2f03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1a034f6540ac7a1ce7d0e3831bb2f03">&#9670;&nbsp;</a></span>check()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine netcdfparser_mod::check </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnetcdfparser__mod_1_1ncfile__class.html">ncfile_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Debug the netcdf error after a netcdf command. </p>
<dl class="section author"><dt>Author</dt><dd>Daniel Garaboa Paz - USC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_net_c_d_fparser_8f90_source.html#l00546">546</a> of file <a class="el" href="_net_c_d_fparser_8f90_source.html">NetCDFparser.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordtype">class</span>(ncfile_class), <span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordtype">type</span>(string) :: outext</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">if</span>(self%status /= nf90_noerr) <span class="keywordflow">then</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        outext = <span class="stringliteral">&#39;[NetCDFparser::check]: &#39;</span>//trim(nf90_strerror(self%status))//<span class="stringliteral">&#39;, stoping&#39;</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keyword">call </span>log%put(outext)</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        stop</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="keywordflow">    end if</span></div></div><!-- fragment -->
</div>
</div>
<a id="a518627511cac4bf3dbc338bf3bfd5e24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a518627511cac4bf3dbc338bf3bfd5e24">&#9670;&nbsp;</a></span>closefile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine netcdfparser_mod::closefile </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnetcdfparser__mod_1_1ncfile__class.html">ncfile_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Close the netcdf file. </p>
<dl class="section author"><dt>Author</dt><dd>Daniel Garaboa Paz - USC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_net_c_d_fparser_8f90_source.html#l00534">534</a> of file <a class="el" href="_net_c_d_fparser_8f90_source.html">NetCDFparser.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordtype">class</span>(ncfile_class),<span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    self%status = nf90_close(self%ncID)</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keyword">call </span>self%check()</div></div><!-- fragment -->
</div>
</div>
<a id="af93319fde6cf6baedb7fe27bf3396e7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af93319fde6cf6baedb7fe27bf3396e7b">&#9670;&nbsp;</a></span>correctnctime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine netcdfparser_mod::correctnctime </td>
          <td>(</td>
          <td class="paramtype">type(string), intent(inout)&#160;</td>
          <td class="paramname"><em>timeComments</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(prec), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>timeArray</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>corrects the time array to a more efficient format if needed. assumes netcdf comment as 'seconds since 1981-01-01 00:00:00' </p>
<dl class="section author"><dt>Author</dt><dd>Ricardo Birjukovs Canelas - MARETEC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">timeComments,timeArray</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_net_c_d_fparser_8f90_source.html#l00625">625</a> of file <a class="el" href="_net_c_d_fparser_8f90_source.html">NetCDFparser.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keywordtype">type</span>(string), <span class="keywordtype">intent(inout)</span> :: timeComments</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordtype">real(prec)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: timeArray</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordtype">integer</span> :: i</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordtype">type</span>(string), <span class="keywordtype">allocatable</span> :: dc(:), dates(:), hours(:)</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordtype">type</span>(string) :: isoDateStr</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(6)</span> :: date</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordtype">type</span>(datetime) :: NCDate</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordtype">type</span>(timedelta) :: dateOffset</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordtype">type</span>(string) :: outext</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordtype">real(prec)</span> :: scale, offset</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keyword">call </span>timecomments%split(tokens=dc, sep=<span class="stringliteral">&#39; &#39;</span>)</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">size</span>(dc) == 4) <span class="keywordflow">then</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        scale = 1.0</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="keywordflow">if</span> (dc(1) == <span class="stringliteral">&#39;seconds&#39;</span>) scale = 1.0</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="keywordflow">if</span> (dc(1) == <span class="stringliteral">&#39;hours&#39;</span>)   scale = 3600.0</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <span class="keywordflow">if</span> (dc(1) == <span class="stringliteral">&#39;days&#39;</span>)    scale = 3600.0*24.0</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keywordflow">if</span> (dc(1) == <span class="stringliteral">&#39;months&#39;</span>)  scale = 3600.0*24.0*30.0 <span class="comment">!really hope no one gets such a brilliant idea as to use this as a time unit</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="keywordflow">if</span> (dc(1) == <span class="stringliteral">&#39;years&#39;</span>)   scale = 3600.0*24.0*30.0*12.0 <span class="comment">!or this</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keyword">call </span>dc(3)%split(tokens=dates, sep=<span class="stringliteral">&#39;-&#39;</span>)</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="keyword">call </span>dc(4)%split(tokens=hours, sep=<span class="stringliteral">&#39;:&#39;</span>)</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        isodatestr = dates(1)//<span class="stringliteral">&#39; &#39;</span>//dates(2)//<span class="stringliteral">&#39; &#39;</span>//dates(3)//<span class="stringliteral">&#39; &#39;</span>//hours(1)//<span class="stringliteral">&#39; &#39;</span>//hours(2)//<span class="stringliteral">&#39; &#39;</span>//hours(3)</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        date = utils%getDateFromISOString(isodatestr)</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        ncdate = utils%getDateTimeFromDate(date)</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        dateoffset = globals%SimTime%StartDate - ncdate</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        offset = -dateoffset%total_seconds()</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        timearray = timearray*scale + offset</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        timecomments = <span class="stringliteral">&#39;seconds since &#39;</span>//globals%SimTime%StartDate%isoformat(<span class="stringliteral">&#39; &#39;</span>)        </div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    </div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordflow">elseif</span> (<span class="keyword">size</span>(dc) == 3) <span class="keywordflow">then</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        scale = 1.0</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="keywordflow">if</span> (dc(1) == <span class="stringliteral">&#39;seconds&#39;</span>) scale = 1.0</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="keywordflow">if</span> (dc(1) == <span class="stringliteral">&#39;hours&#39;</span>)   scale = 3600.0</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keywordflow">if</span> (dc(1) == <span class="stringliteral">&#39;days&#39;</span>)    scale = 3600.0*24.0</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keywordflow">if</span> (dc(1) == <span class="stringliteral">&#39;months&#39;</span>)  scale = 3600.0*24.0*30.0 <span class="comment">!really hope no one gets such a brilliant idea as to use this as a time unit</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="keywordflow">if</span> (dc(1) == <span class="stringliteral">&#39;years&#39;</span>)   scale = 3600.0*24.0*30.0*12.0 <span class="comment">!or this</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="keyword">call </span>dc(3)%split(tokens=dates, sep=<span class="stringliteral">&#39;-&#39;</span>)</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        isodatestr = dates(1)//<span class="stringliteral">&#39; &#39;</span>//dates(2)//<span class="stringliteral">&#39; &#39;</span>//dates(3)//<span class="stringliteral">&#39; &#39;</span>//<span class="stringliteral">&#39;00&#39;</span>//<span class="stringliteral">&#39; &#39;</span>//<span class="stringliteral">&#39;00&#39;</span>//<span class="stringliteral">&#39; &#39;</span>//<span class="stringliteral">&#39;00&#39;</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        date = utils%getDateFromISOString(isodatestr)</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        ncdate = utils%getDateTimeFromDate(date)</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        dateoffset = globals%SimTime%StartDate - ncdate</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        offset = -dateoffset%total_seconds()</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        </div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        timearray = timearray*scale + offset</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        timecomments = <span class="stringliteral">&#39;seconds since &#39;</span>//globals%SimTime%StartDate%isoformat(<span class="stringliteral">&#39; &#39;</span>)</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        </div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">else</span>       </div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        outext = <span class="stringliteral">&#39;[NetCDF parser::correctNCTime]:WARNING - Time units may not be in the format *seconds since 1981-01-01 00:00:00*, you might have some problems in a few moments...&#39;</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="keyword">call </span>log%put(outext)</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="keywordflow">    end if</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenetcdfparser__mod_af93319fde6cf6baedb7fe27bf3396e7b_icgraph.png" border="0" usemap="#namespacenetcdfparser__mod_af93319fde6cf6baedb7fe27bf3396e7b_icgraph" alt=""/></div>
<map name="namespacenetcdfparser__mod_af93319fde6cf6baedb7fe27bf3396e7b_icgraph" id="namespacenetcdfparser__mod_af93319fde6cf6baedb7fe27bf3396e7b_icgraph">
<area shape="rect" id="node2" href="namespacenetcdfparser__mod.html#a0aea819b8a474ce2f4840d0bc44e95ec" title="Reads the dimension fields from the nc file for a given variable. returns an array of scalar 1D field..." alt="" coords="265,5,499,32"/>
</map>
</div>

</div>
</div>
<a id="a5fcd4b7fb27dbc9befd0a6fcfb9929a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fcd4b7fb27dbc9befd0a6fcfb9929a1">&#9670;&nbsp;</a></span>getdimbydimid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structnetcdfparser__mod_1_1dim__t.html">dim_t</a>) function netcdfparser_mod::getdimbydimid </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnetcdfparser__mod_1_1ncfile__class.html">ncfile_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>dimID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>returns a dimension field metadata structure, given a dimID </p>
<dl class="section author"><dt>Author</dt><dd>Ricardo Birjukovs Canelas - MARETEC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self,dimID</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_net_c_d_fparser_8f90_source.html#l00504">504</a> of file <a class="el" href="_net_c_d_fparser_8f90_source.html">NetCDFparser.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordtype">class</span>(ncfile_class), <span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: dimID</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordtype">integer</span> :: i</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordtype">logical</span> :: found</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordtype">type</span>(string) :: outext</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    found = .false.</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">do</span> i=1, self%nDims</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">if</span> (dimid == self%dimData(i)%dimid) <span class="keywordflow">then</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            found = .true.</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            getdimbydimid = self%dimData(i)</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <span class="keywordflow">return</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="keywordflow">    end do</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">if</span> (.not.found) <span class="keywordflow">then</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        outext = dimid</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        outext = <span class="stringliteral">&#39;[NetCDFparser::getDimByDimID]: dimension with ID=&#39;</span>//outext//<span class="stringliteral">&#39; not found. Stopping&#39;</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keyword">call </span>log%put(outext)</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        stop</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="keywordflow">    end if</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a57c39a4003778a6bf90cfd36b69380bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57c39a4003778a6bf90cfd36b69380bc">&#9670;&nbsp;</a></span>getfile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine netcdfparser_mod::getfile </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnetcdfparser__mod_1_1ncfile__class.html">ncfile_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(string), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parse the netcdf file headers and assembles the file model. </p>
<dl class="section author"><dt>Author</dt><dd>Ricardo Birjukovs Canelas - MARETEC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self,filename</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_net_c_d_fparser_8f90_source.html#l00180">180</a> of file <a class="el" href="_net_c_d_fparser_8f90_source.html">NetCDFparser.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordtype">class</span>(ncfile_class), <span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordtype">type</span>(string), <span class="keywordtype">intent(in)</span> :: filename</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordtype">integer</span> :: i</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    self%filename = filename</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">call </span>self%getNCid()</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keyword">call </span>self%getNCglobalMetadata()</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keyword">call </span>self%getNCVarMetadata()</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keyword">call </span>self%getNCDimMetadata()</div></div><!-- fragment -->
</div>
</div>
<a id="ada78b9f33d39c4763f412f004524cbea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada78b9f33d39c4763f412f004524cbea">&#9670;&nbsp;</a></span>getfullfile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structbackground__mod_1_1background__class.html">background_class</a>) function netcdfparser_mod::getfullfile </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnetcdfparser__mod_1_1ncreader__class.html">ncreader_class</a>), intent(in)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(string), intent(in)&#160;</td>
          <td class="paramname"><em>fileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(string), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>varList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>syntecticVar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>instantiates and returns a background object with the data from a NC file </p>
<dl class="section author"><dt>Author</dt><dd>Ricardo Birjukovs Canelas - MARETEC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self,fileName,varList,syntecticVar</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_net_c_d_fparser_8f90_source.html#l00105">105</a> of file <a class="el" href="_net_c_d_fparser_8f90_source.html">NetCDFparser.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordtype">class</span>(ncReader_class), <span class="keywordtype">intent(in)</span> :: self</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">type</span>(string), <span class="keywordtype">intent(in)</span> :: fileName</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordtype">type</span>(string), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: varList</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: syntecticVar    </div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">type</span>(ncfile_class) :: ncFile</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordtype">type</span>(scalar1d_field_class), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: backgrounDims</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordtype">type</span>(generic_field_class), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: gfield</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordtype">type</span>(string) :: name, units</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">type</span>(box) :: extents</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">type</span>(vector) :: pt</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">real(prec)</span>, <span class="keywordtype">dimension(3,2)</span> :: dimExtents</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">integer</span> :: i, realVarIdx</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordtype">type</span>(string) :: outext</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keyword">allocate</span>(gfield(<span class="keyword">size</span>(syntecticvar)))</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    realvaridx = 0</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    units = <span class="stringliteral">&#39;-&#39;</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    </div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    outext = <span class="stringliteral">&#39;-&gt;Reading &#39;</span>//filename</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keyword">call </span>log%put(outext,.false.)</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keyword">call </span>ncfile%initialize(filename)</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">do</span> i=1, <span class="keyword">size</span>(syntecticvar)</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">if</span>(.not.syntecticvar(i)) <span class="keywordflow">then</span> <span class="comment">!finding the first real variable to extract dimension arrays</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keyword">call </span>ncfile%getVarDimensions(varlist(i), backgroundims)</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(backgroundims)) <span class="keywordflow">then</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                realvaridx = i</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                <span class="keywordflow">exit</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keywordflow">            end if</span>            </div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keywordflow">    end do</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">if</span> (realvaridx /= 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">do</span> i=1, <span class="keyword">size</span>(syntecticvar)</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keywordflow">if</span>(.not.syntecticvar(i)) <span class="keywordflow">then</span> <span class="comment">!normal variable, put it on a generic field</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                <span class="keyword">call </span>ncfile%getVar(varlist(i), gfield(i))</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="keywordflow">else</span>                          <span class="comment">!synthetic variable to be constructed based on the field of a normal variable</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <span class="keyword">call </span>ncfile%getVar(varlist(realvaridx), gfield(i), .true., varlist(i), units)</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="keywordflow">    end if</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keyword">call </span>ncfile%finalize()</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    dimextents = 0.0</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">do</span> i = 1, <span class="keyword">size</span>(backgroundims)</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">if</span> (backgroundims(i)%name == globals%Var%lon) <span class="keywordflow">then</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            dimextents(1,1) = backgroundims(i)%getFieldMinBound()</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            dimextents(1,2) = backgroundims(i)%getFieldMaxBound()</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (backgroundims(i)%name == globals%Var%lat) <span class="keywordflow">then</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            dimextents(2,1) = backgroundims(i)%getFieldMinBound()</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            dimextents(2,2) = backgroundims(i)%getFieldMaxBound()</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (backgroundims(i)%name == globals%Var%level) <span class="keywordflow">then</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            dimextents(3,1) = backgroundims(i)%getFieldMinBound()</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            dimextents(3,2) = backgroundims(i)%getFieldMaxBound()</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keywordflow">    end do</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    extents%pt = dimextents(1,1)*ex + dimextents(2,1)*ey + dimextents(3,1)*ez</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    pt = dimextents(1,2)*ex + dimextents(2,2)*ey + dimextents(3,2)*ez</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    extents%size = pt - extents%pt</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    name = filename%basename(strip_last_extension=.true.)</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    getfullfile = background(1, name, extents, backgroundims)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">do</span> i = 1, <span class="keyword">size</span>(gfield)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keyword">call </span>getfullfile%add(gfield(i))</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="comment">!call gfield(i)%print()</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="keywordflow">    end do</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">!call getFullFile%print()</span></div></div><!-- fragment -->
</div>
</div>
<a id="a6354ee8b3c773cc7a5ad247ad1e34eeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6354ee8b3c773cc7a5ad247ad1e34eeb">&#9670;&nbsp;</a></span>getncdimmetadata()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine netcdfparser_mod::getncdimmetadata </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnetcdfparser__mod_1_1ncfile__class.html">ncfile_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Inquires the nc file for dimension metadata. </p>
<dl class="section author"><dt>Author</dt><dd>Ricardo Birjukovs Canelas - MARETEC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_net_c_d_fparser_8f90_source.html#l00257">257</a> of file <a class="el" href="_net_c_d_fparser_8f90_source.html">NetCDFparser.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordtype">class</span>(ncfile_class), <span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordtype">integer</span> :: i, j, dimLength</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordtype">character(CHAR_LEN)</span> :: dimName</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keyword">allocate</span>(self%dimData(self%nDims))</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">do</span> i=1, self%nDims</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        self%status = nf90_inquire_dimension(self%ncID, i, dimname, dimlength)</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keyword">call </span>self%check()</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        self%dimData(i)%name = trim(dimname)</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        self%dimData(i)%simName = globals%Var%getVarSimName(self%dimData(i)%name)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        self%dimData(i)%length = dimlength</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        self%status = nf90_inq_dimid(self%ncID, self%dimData(i)%name%chars(), self%dimData(i)%dimid)</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keyword">call </span>self%check()</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">do</span> j=1, self%nVars</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="keywordflow">if</span> (self%dimData(i)%name == self%varData(j)%name) <span class="keywordflow">then</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                self%dimData(i)%units = self%varData(j)%units</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                self%dimData(i)%varid = self%varData(j)%varid</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                <span class="keywordflow">exit</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="keywordflow">    end do</span></div></div><!-- fragment -->
</div>
</div>
<a id="a409f59662d71fb63e5fb5e057fdfd6ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a409f59662d71fb63e5fb5e057fdfd6ee">&#9670;&nbsp;</a></span>getncglobalmetadata()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine netcdfparser_mod::getncglobalmetadata </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnetcdfparser__mod_1_1ncfile__class.html">ncfile_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Inquires the nc file for global metadata - number of dimensions, variables and attributes. </p>
<dl class="section author"><dt>Author</dt><dd>Ricardo Birjukovs Canelas - MARETEC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_net_c_d_fparser_8f90_source.html#l00210">210</a> of file <a class="el" href="_net_c_d_fparser_8f90_source.html">NetCDFparser.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordtype">class</span>(ncfile_class), <span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    self%status = nf90_inquire(self%ncID, self%nDims, self%nVars, self%nAtt, self%uDimID)</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keyword">call </span>self%check()</div></div><!-- fragment -->
</div>
</div>
<a id="a741dd5b5985255e73aa9d3cf08755e91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a741dd5b5985255e73aa9d3cf08755e91">&#9670;&nbsp;</a></span>getncid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine netcdfparser_mod::getncid </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnetcdfparser__mod_1_1ncfile__class.html">ncfile_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Opens the netcdf file, assigns the NCID and checks for errors. </p>
<dl class="section author"><dt>Author</dt><dd>Daniel Garaboa Paz - USC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_net_c_d_fparser_8f90_source.html#l00197">197</a> of file <a class="el" href="_net_c_d_fparser_8f90_source.html">NetCDFparser.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordtype">class</span>(ncfile_class), <span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    self%status = nf90_open(trim(self%filename%chars()), nf90_nowrite, self%ncID)</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keyword">call </span>self%check()</div></div><!-- fragment -->
</div>
</div>
<a id="a46989199271acb6205cc61ac413d5a56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46989199271acb6205cc61ac413d5a56">&#9670;&nbsp;</a></span>getncvarmetadata()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine netcdfparser_mod::getncvarmetadata </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnetcdfparser__mod_1_1ncfile__class.html">ncfile_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Inquires the nc file for variable metadata. </p>
<dl class="section author"><dt>Author</dt><dd>Ricardo Birjukovs Canelas - MARETEC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_net_c_d_fparser_8f90_source.html#l00222">222</a> of file <a class="el" href="_net_c_d_fparser_8f90_source.html">NetCDFparser.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordtype">class</span>(ncfile_class), <span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordtype">integer</span> :: i, j, ndims, nAtts</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">integer</span> :: dimids(self%nDims)</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">integer</span> :: tempStatus</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordtype">character(CHAR_LEN)</span> :: varName, units</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keyword">allocate</span>(self%varData(self%nVars))</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">do</span> i=1, self%nVars</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        self%status = nf90_inquire_variable(self%ncID, i, varname, ndims=ndims, dimids=dimids, natts=natts)</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keyword">call </span>self%check()</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        self%varData(i)%name = trim(varname)</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        self%varData(i)%simName = globals%Var%getVarSimName(self%varData(i)%name)</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        self%varData(i)%varid = i</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        self%varData(i)%ndims = ndims</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keyword">allocate</span>(self%varData(i)%dimids(ndims))</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        self%varData(i)%dimids = dimids(1:ndims)</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        self%varData(i)%nAtts = natts</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        tempstatus = nf90_get_att(self%ncID, i, <span class="stringliteral">&#39;units&#39;</span>, units)</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">if</span> (tempstatus == -43) units = <span class="stringliteral">&quot;not set&quot;</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        self%varData(i)%units = trim(units)</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        tempstatus = nf90_get_att(self%ncID, i, <span class="stringliteral">&quot;scale_factor&quot;</span>, self%varData(i)%scale)</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">if</span> (tempstatus == -43) self%varData(i)%scale = 1.0</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        tempstatus = nf90_get_att(self%ncID, i, <span class="stringliteral">&quot;add_offset&quot;</span>, self%varData(i)%offset)</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">if</span> (tempstatus == -43) self%varData(i)%offset = 0.0</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        tempstatus = nf90_get_att(self%ncID, i, <span class="stringliteral">&quot;_FillValue&quot;</span>, self%varData(i)%fillvalue)</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">if</span> (tempstatus == -43) self%varData(i)%fillvalue = mv</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="keywordflow">    end do</span></div></div><!-- fragment -->
</div>
</div>
<a id="aba877869db6bea7262d659133253cff7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba877869db6bea7262d659133253cff7">&#9670;&nbsp;</a></span>getvar()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine netcdfparser_mod::getvar </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnetcdfparser__mod_1_1ncfile__class.html">ncfile_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(string), intent(in)&#160;</td>
          <td class="paramname"><em>varName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(generic_field_class), intent(out)&#160;</td>
          <td class="paramname"><em>varField</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>binaryVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(string), intent(in), optional&#160;</td>
          <td class="paramname"><em>altName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(string), intent(in), optional&#160;</td>
          <td class="paramname"><em>altUnits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads the fields from the nc file for a given variable. returns a generic field, with a name, units and data. </p>
<dl class="section author"><dt>Author</dt><dd>Ricardo Birjukovs Canelas - MARETEC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self,varName,varField,binaryVar,altName,altUnits</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_net_c_d_fparser_8f90_source.html#l00390">390</a> of file <a class="el" href="_net_c_d_fparser_8f90_source.html">NetCDFparser.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordtype">class</span>(ncfile_class), <span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordtype">type</span>(string), <span class="keywordtype">intent(in)</span> :: varName</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordtype">type</span>(generic_field_class), <span class="keywordtype">intent(out)</span> :: varField</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordtype">logical</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: binaryVar</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordtype">type</span>(string), <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: altName, altUnits</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordtype">logical</span> :: bVar</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordtype">real(prec)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: tempRealField1D</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordtype">real(prec)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:,:)</span> :: tempRealField3D</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordtype">real(prec)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:,:,:)</span> :: tempRealField4D</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordtype">type</span>(string) :: dimName, varUnits</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordtype">integer</span> :: i, j, k, id_dim, first,last</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordtype">type</span>(dim_t) :: tempDim</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: varShape</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordtype">type</span>(string) :: outext</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    bvar= .false.</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">present</span>(binaryvar)) bvar = binaryvar</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">do</span> i=1, self%nVars <span class="comment">!going trough all variables</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keywordflow">if</span> (self%varData(i)%simName == varname ) <span class="keywordflow">then</span>   <span class="comment">!found the requested var</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <span class="keyword">allocate</span>(varshape(self%varData(i)%ndims))</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            <span class="keywordflow">do</span> j=1, self%varData(i)%ndims   <span class="comment">!going trough all of the variable dimensions</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                tempdim = self%getDimByDimID(self%varData(i)%dimids(j))</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                varshape(j) = tempdim%length</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="keywordflow">            end do</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <span class="keywordflow">if</span>(self%varData(i)%ndims == 3) <span class="keywordflow">then</span> <span class="comment">!3D variable</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                <span class="keyword">allocate</span>(temprealfield3d(varshape(1),varshape(2),varshape(3)))</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                self%status = nf90_get_var(self%ncID, self%varData(i)%varid, temprealfield3d)</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                <span class="keyword">call </span>self%check()</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                <span class="keywordflow">if</span> (.not.bvar) <span class="keywordflow">then</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                    <span class="keywordflow">where</span> (temprealfield3d == self%varData(i)%fillvalue) temprealfield3d = 0.0</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                    temprealfield3d = temprealfield3d*self%varData(i)%scale + self%varData(i)%offset <span class="comment">! scale + offset transform</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                    <span class="keywordflow">if</span> (self%varData(i)%fillvalue == mv) <span class="keywordflow">then</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                        outext = <span class="stringliteral">&#39;[NetCDFParser::getVar]:WARNING - variables without _fillvalue, you might have some problems in a few moments. Masks will not work properly (beaching, land exclusion,...)&#39;</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                    <span class="keyword">call </span>log%put(outext)</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="keywordflow">                    end if</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                    <span class="keywordflow">where</span> (temprealfield3d /= self%varData(i)%fillvalue) temprealfield3d = globals%Mask%waterVal</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                    <span class="keywordflow">where</span> (temprealfield3d == self%varData(i)%fillvalue) temprealfield3d = globals%Mask%landVal</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="keywordflow">                end if</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                <span class="keywordflow">do</span> id_dim=1,3 <span class="comment">!reverting fields to have &#39;natural&#39; coordinate-field storage</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                    <span class="keywordflow">if</span> (self%dimData(id_dim)%reverse_data) <span class="keywordflow">then</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                        <span class="keywordflow">if</span> (self%dimData(id_dim)%simName == globals%Var%lon) <span class="keywordflow">then</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                            temprealfield3d = temprealfield3d(varshape(1):1:-1,:,:)</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (self%dimData(id_dim)%simName == globals%Var%lat) <span class="keywordflow">then</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                            temprealfield3d = temprealfield3d(:,varshape(2):1:-1,:)</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (self%dimData(id_dim)%simName == globals%Var%level) <span class="keywordflow">then</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                            temprealfield3d = temprealfield3d(:,:,varshape(3):1:-1)</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="keywordflow">                        end if</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="keywordflow">                    end if</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="keywordflow">                end do</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                <span class="keywordflow">if</span> (.not.bvar) <span class="keywordflow">then</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                    <span class="keyword">call </span>varfield%initialize(varname, self%varData(i)%units, temprealfield3d)</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                    dimname = varname</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                    <span class="keywordflow">if</span>(<span class="keyword">present</span>(altname)) dimname = altname</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                    varunits = self%varData(i)%units</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                    <span class="keywordflow">if</span>(<span class="keyword">present</span>(altunits)) varunits = altunits</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                    <span class="keyword">call </span>varfield%initialize(dimname, varunits, temprealfield3d)</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="keywordflow">                end if</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(self%varData(i)%ndims == 4) <span class="keywordflow">then</span> <span class="comment">!4D variable</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                <span class="keyword">allocate</span>(temprealfield4d(varshape(1),varshape(2),varshape(3),varshape(4)))</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                self%status = nf90_get_var(self%ncID, self%varData(i)%varid, temprealfield4d)</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                <span class="keyword">call </span>self%check()</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                <span class="keywordflow">if</span> (.not.bvar) <span class="keywordflow">then</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                    <span class="keywordflow">where</span> (temprealfield4d == self%varData(i)%fillvalue) temprealfield4d = 0.0</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                    temprealfield4d = temprealfield4d*self%varData(i)%scale + self%varData(i)%offset    <span class="comment">! scale + offset transform</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                    <span class="keywordflow">if</span> (self%varData(i)%fillvalue == mv) <span class="keywordflow">then</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                        outext = <span class="stringliteral">&#39;[NetCDFParser::getVar]:WARNING - variables without _fillvalue, you might have some problems in a few moments. Masks will not work properly (beaching, land exclusion,...)&#39;</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                    <span class="keyword">call </span>log%put(outext)</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="keywordflow">                    end if</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                    <span class="keywordflow">where</span> (temprealfield4d /= self%varData(i)%fillvalue) temprealfield4d = globals%Mask%waterVal</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                    <span class="keywordflow">where</span> (temprealfield4d == self%varData(i)%fillvalue) temprealfield4d = globals%Mask%landVal</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keywordflow">                end if</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                <span class="keywordflow">do</span> id_dim=1,4 <span class="comment">!reverting fields to have &#39;natural&#39; coordinate-field storage</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                    <span class="keywordflow">if</span> (self%dimData(id_dim)%reverse_data) <span class="keywordflow">then</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                        <span class="keywordflow">if</span> (self%dimData(id_dim)%simName == globals%Var%lon) <span class="keywordflow">then</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                            temprealfield4d = temprealfield4d(varshape(1):1:-1,:,:,:)</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                        <span class="keywordflow">elseif</span> (self%dimData(id_dim)%simName == globals%Var%lat) <span class="keywordflow">then</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                            temprealfield4d = temprealfield4d(:,varshape(2):1:-1,:,:)</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                        <span class="keywordflow">elseif</span> (self%dimData(id_dim)%simName == globals%Var%level) <span class="keywordflow">then</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                            temprealfield4d = temprealfield4d(:,:,varshape(3):1:-1,:)</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                        <span class="keywordflow">elseif</span> (self%dimData(id_dim)%simName == globals%Var%time) <span class="keywordflow">then</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                            temprealfield4d = temprealfield4d(:,:,:,varshape(4):1:-1)</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="keywordflow">                        end if</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="keywordflow">                    end if</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="keywordflow">                end do</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                <span class="keywordflow">if</span> (.not.bvar) <span class="keywordflow">then</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                    <span class="keyword">call </span>varfield%initialize(varname, self%varData(i)%units, temprealfield4d)</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                    dimname = varname</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                    <span class="keywordflow">if</span>(<span class="keyword">present</span>(altname)) dimname = altname</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                    varunits = self%varData(i)%units</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                    <span class="keywordflow">if</span>(<span class="keyword">present</span>(altunits)) varunits = altunits</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                    <span class="keyword">call </span>varfield%initialize(dimname, varunits, temprealfield4d)</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="keywordflow">                end if</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                outext = <span class="stringliteral">&#39;[NetCDFparser::getVar]: Variable &#39;</span>//varname//<span class="stringliteral">&#39; has a non-supported dimensionality. Stopping&#39;</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                <span class="keyword">call </span>log%put(outext)</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                stop</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="keywordflow">            end if</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="keywordflow">    end do</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a0aea819b8a474ce2f4840d0bc44e95ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0aea819b8a474ce2f4840d0bc44e95ec">&#9670;&nbsp;</a></span>getvardimensions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine netcdfparser_mod::getvardimensions </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnetcdfparser__mod_1_1ncfile__class.html">ncfile_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(string), intent(in)&#160;</td>
          <td class="paramname"><em>varName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(scalar1d_field_class), dimension(:), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>dimsArrays</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads the dimension fields from the nc file for a given variable. returns an array of scalar 1D fields, each with a name, units and data. </p>
<dl class="section author"><dt>Author</dt><dd>Ricardo Birjukovs Canelas - MARETEC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self,varName,dimsArrays</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_net_c_d_fparser_8f90_source.html#l00287">287</a> of file <a class="el" href="_net_c_d_fparser_8f90_source.html">NetCDFparser.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">class</span>(ncfile_class), <span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordtype">type</span>(string), <span class="keywordtype">intent(in)</span> :: varName</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordtype">type</span>(scalar1d_field_class), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(out)</span> :: dimsArrays</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordtype">real(prec)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: tempRealArray, tempRealArrayDelta</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordtype">type</span>(string) :: dimName, dimUnits</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordtype">integer</span> :: i, j, k, l</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">do</span> i=1, self%nVars <span class="comment">!going trough all variables</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">if</span> (self%varData(i)%simName == varname) <span class="keywordflow">then</span>   <span class="comment">!found the requested var</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="keyword">allocate</span>(dimsarrays(self%varData(i)%ndims)) <span class="comment">!allocating output fields</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <span class="keywordflow">do</span> j=1, self%varData(i)%ndims   <span class="comment">!going trough all of the variable dimensions</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                <span class="keywordflow">do</span> k=1, self%nDims  <span class="comment">!going trough all available dimensions of the file</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                    <span class="keywordflow">if</span> (self%varData(i)%dimids(j) == self%dimData(k)%dimid) <span class="keywordflow">then</span>    <span class="comment">!found a corresponding dimension between the variable and the file</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                        <span class="keyword">allocate</span>(temprealarray(self%dimData(k)%length)) <span class="comment">!allocating a place to read the field data to</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                        dimname = self%dimData(k)%simName</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                        dimunits = self%dimData(k)%units</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                        self%status = nf90_get_var(self%ncID, self%dimData(k)%varid, temprealarray)</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                        <span class="keyword">call </span>self%check()</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                        <span class="comment">!need to check for &#39;level&#39; variable specific issues</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                        <span class="comment">!@Daniel</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                        <span class="comment">! To interpolate on regular meshes, the search cell method uses the lower bound data and the 1 index</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                        <span class="comment">! as a reference to locate the point inside the data cell in time, longitude and latitude axis.</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                        <span class="comment">! To be consistent, the cell search in depth dimension must be done in the same way. It means:</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                        <span class="comment">! The lower bound in depth axis (maximum depth) must be in the 1 index (lower bound) and growing </span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                        <span class="comment">! up till the surface (minimum depth, upper bound) .</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                        <span class="comment">! SO:</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                        <span class="comment">! 0) index = (1,2,3,.....n),</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                        <span class="comment">!    axis = (-bottom,..., +surface)</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                        <span class="comment">! To check this and adjust the data to this criteria, we need to check the two following conditions</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                        <span class="keywordflow">if</span> (dimname == globals%Var%level) <span class="keywordflow">then</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                            <span class="comment">!1) The depth must decrease in absolute value. If it does not decrease, must be reversed.</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                            <span class="comment">! |axis_i - axis_i+1| =&gt; 0</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                            <span class="keywordflow">if</span> (all(abs(temprealarray(:<span class="keyword">size</span>(temprealarray)-1) - temprealarray(2:)) &gt;= 0) .eqv. .false.)  <span class="keywordflow">then</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                self%dimData(k)%reverse_data = .true.</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                self%dimData(k)%reverse_axis = .true.</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="keywordflow">                            end if</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                            <span class="keywordflow">if</span> (self%dimData(k)%reverse_axis .eqv. .true.) <span class="keywordflow">then</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                                temprealarray = temprealarray(<span class="keyword">size</span>(temprealarray):1:-1)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="keywordflow">                            end if</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                            <span class="comment">!2) The axis must be negative and It grows to surface. If it does not grow, it must be negated.</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                            <span class="comment">! axis_i+1 &gt; axis_i</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                            <span class="keywordflow">if</span> (all(temprealarray(2:) &gt;= temprealarray(:<span class="keyword">size</span>(temprealarray)-1)) .eqv. .false.) <span class="keywordflow">then</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                                self%dimData(k)%negate = .true.</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="keywordflow">                            end if</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                            <span class="keywordflow">if</span> (self%dimData(k)%negate .eqv. .true.) <span class="keywordflow">then</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                                temprealarray = -temprealarray</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="keywordflow">                            end if</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                            <span class="comment">! if ((tempRealArray(1) &lt;= 0) .and. (tempRealArray(1)) &lt; tempRealArray(size(tempRealArray))) then</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                            <span class="comment">!     self%dimData(k)%reverse_axis = .false.</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                            <span class="comment">!     self%dimData(k)%negate = .false.</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                            <span class="comment">!     self%dimData(k)%reverse_data = .false.</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                            <span class="comment">! elseif ((tempRealArray(1) &lt;= 0) .and. (tempRealArray(1)) &gt; tempRealArray(size(tempRealArray))) then</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                            <span class="comment">!     self%dimData(k)%reverse_axis = .true.</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                            <span class="comment">!     self%dimData(k)%negate = .false.</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                            <span class="comment">!     self%dimData(k)%reverse_data = .true.</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                            <span class="comment">!     !print*, &#39;[NetCDFparser::warning]:&#39;, &#39;The axis&#39;,k,&#39;has wrong directon. Correcting...&#39;</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                            <span class="comment">! elseif ((tempRealArray(1) &gt;= 0) .and. (tempRealArray(1) &gt; tempRealArray(size(tempRealArray)))) then</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                            <span class="comment">!     self%dimData(k)%reverse_axis = .false.</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                            <span class="comment">!     self%dimData(k)%negate = .true.</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                            <span class="comment">!     self%dimData(k)%reverse_data = .false.</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                            <span class="comment">!     !print*, &#39;[NetCDFparser::warning]:&#39;, &#39;The axis&#39;,k,&#39;has wrong sing/direction. Correcting...&#39;</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                            <span class="comment">! elseif ((tempRealArray(1) &gt;= 0) .and. (tempRealArray(1) &lt; tempRealArray(size(tempRealArray)))) then</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                            <span class="comment">!     self%dimData(k)%reverse_axis = .true.</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                            <span class="comment">!     self%dimData(k)%negate = .true.</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                            <span class="comment">!     self%dimData(k)%reverse_data = .true.</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                            <span class="comment">!     !print*, &#39;[NetCDFparser::warning]:&#39;, &#39;The axis&#39;,k,&#39;has wrong sign. Correcting...&#39;</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                            <span class="comment">! end if</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="keywordflow">                        end if</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                        <span class="comment">!need to check for &#39;time&#39; variable specific issues</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                        <span class="keywordflow">if</span> (dimname == globals%Var%time) <span class="keywordflow">then</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                            <span class="keyword">call </span>correctnctime(dimunits, temprealarray)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="keywordflow">                        end if</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                        <span class="keyword">call </span>dimsarrays(j)%initialize(dimname, dimunits, 1, temprealarray)</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                        <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(temprealarray)) <span class="keyword">deallocate</span>(temprealarray)</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                        <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(temprealarraydelta)) <span class="keyword">deallocate</span>(temprealarraydelta)</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="keywordflow">                    end if</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="keywordflow">                end do</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="keywordflow">            end do</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="keywordflow">    end do</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacenetcdfparser__mod_a0aea819b8a474ce2f4840d0bc44e95ec_cgraph.png" border="0" usemap="#namespacenetcdfparser__mod_a0aea819b8a474ce2f4840d0bc44e95ec_cgraph" alt=""/></div>
<map name="namespacenetcdfparser__mod_a0aea819b8a474ce2f4840d0bc44e95ec_cgraph" id="namespacenetcdfparser__mod_a0aea819b8a474ce2f4840d0bc44e95ec_cgraph">
<area shape="rect" id="node2" href="namespacenetcdfparser__mod.html#af93319fde6cf6baedb7fe27bf3396e7b" title="corrects the time array to a more efficient format if needed. assumes netcdf comment as &#39;seconds sinc..." alt="" coords="287,5,499,32"/>
</map>
</div>

</div>
</div>
<a id="ac01c000a97d23613684155708249ce89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac01c000a97d23613684155708249ce89">&#9670;&nbsp;</a></span>printdimsnc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine netcdfparser_mod::printdimsnc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnetcdfparser__mod_1_1dim__t.html">dim_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>print dimensions metadata </p>
<dl class="section author"><dt>Author</dt><dd>Ricardo Birjukovs Canelas - MARETEC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_net_c_d_fparser_8f90_source.html#l00604">604</a> of file <a class="el" href="_net_c_d_fparser_8f90_source.html">NetCDFparser.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordtype">class</span>(dim_t), <span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordtype">type</span>(string) :: outext, temp</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    outext = <span class="stringliteral">&#39;---&gt;Dimension: &#39;</span>// self%name //new_line(<span class="stringliteral">&#39;a&#39;</span>)</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    temp = self%dimid</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    outext = outext//<span class="stringliteral">&#39;       dimid = &#39;</span>//temp//new_line(<span class="stringliteral">&#39;a&#39;</span>)</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    temp = self%varid</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    outext = outext//<span class="stringliteral">&#39;       varid = &#39;</span>//temp//new_line(<span class="stringliteral">&#39;a&#39;</span>)</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    outext = outext//<span class="stringliteral">&#39;       units = &#39;</span>//self%units//new_line(<span class="stringliteral">&#39;a&#39;</span>)</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    temp = self%length</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    outext = outext//<span class="stringliteral">&#39;       lenght = &#39;</span>//temp</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keyword">call </span>log%put(outext,.false.)</div></div><!-- fragment -->
</div>
</div>
<a id="aeb48d33c014bae21b2fceaaa70cbdc67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb48d33c014bae21b2fceaaa70cbdc67">&#9670;&nbsp;</a></span>printncinfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine netcdfparser_mod::printncinfo </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnetcdfparser__mod_1_1ncfile__class.html">ncfile_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>prints most of the file model metadata </p>
<dl class="section author"><dt>Author</dt><dd>Daniel Garaboa Paz - USC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_net_c_d_fparser_8f90_source.html#l00562">562</a> of file <a class="el" href="_net_c_d_fparser_8f90_source.html">NetCDFparser.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordtype">class</span>(ncfile_class), <span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordtype">type</span>(string) :: outext, temp</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    outext = <span class="stringliteral">&#39;--&gt;Reading NetCDF file &#39;</span>//self%filename%chars()//new_line(<span class="stringliteral">&#39;a&#39;</span>)</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    temp = self%ncid</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    outext = outext//<span class="stringliteral">&#39;       file ID = &#39;</span>//temp//new_line(<span class="stringliteral">&#39;a&#39;</span>)</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    temp = self%nDims</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    outext = outext//<span class="stringliteral">&#39;       Number of dimensions = &#39;</span>//temp//new_line(<span class="stringliteral">&#39;a&#39;</span>)</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    temp = self%nVars</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    outext = outext//<span class="stringliteral">&#39;       Number of variable fields = &#39;</span>//temp</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keyword">call </span>log%put(outext,.false.)</div></div><!-- fragment -->
</div>
</div>
<a id="a6b57fa47d7bd796c75483216a51e5e04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b57fa47d7bd796c75483216a51e5e04">&#9670;&nbsp;</a></span>printvarsnc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine netcdfparser_mod::printvarsnc </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnetcdfparser__mod_1_1var__t.html">var_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>print variable metadata </p>
<dl class="section author"><dt>Author</dt><dd>Ricardo Birjukovs Canelas - MARETEC </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_net_c_d_fparser_8f90_source.html#l00581">581</a> of file <a class="el" href="_net_c_d_fparser_8f90_source.html">NetCDFparser.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordtype">class</span>(var_t), <span class="keywordtype">intent(inout)</span> :: self</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordtype">type</span>(string) :: outext, temp</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordtype">integer</span> :: i</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    outext = <span class="stringliteral">&#39;---&gt;Variable: &#39;</span>// self%name //new_line(<span class="stringliteral">&#39;a&#39;</span>)</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    temp = self%varid</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    outext = outext//<span class="stringliteral">&#39;       varid = &#39;</span>//temp//new_line(<span class="stringliteral">&#39;a&#39;</span>)</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    outext = outext//<span class="stringliteral">&#39;       units = &#39;</span>//self%units//new_line(<span class="stringliteral">&#39;a&#39;</span>)</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    temp = self%dimids(1)</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    outext = outext//<span class="stringliteral">&#39;       dimids = &#39;</span>//temp</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">do</span> i=2, <span class="keyword">size</span>(self%dimids)</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        temp = self%dimids(i)</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        outext = outext//<span class="stringliteral">&#39;, &#39;</span>//temp</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="keywordflow">    end do</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keyword">call </span>log%put(outext,.false.)</div></div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacenetcdfparser__mod.html">netcdfparser_mod</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
