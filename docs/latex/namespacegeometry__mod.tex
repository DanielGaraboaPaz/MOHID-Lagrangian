\hypertarget{namespacegeometry__mod}{}\section{geometry\+\_\+mod Module Reference}
\label{namespacegeometry__mod}\index{geometry\+\_\+mod@{geometry\+\_\+mod}}


Module that defines geometry classes and related methods.  


\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structgeometry__mod_1_1box}{box}}
\begin{DoxyCompactList}\small\item\em Type -\/ point class. \end{DoxyCompactList}\item 
type \mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}
\item 
type \mbox{\hyperlink{structgeometry__mod_1_1line}{line}}
\begin{DoxyCompactList}\small\item\em Type -\/ line class. \end{DoxyCompactList}\item 
type \mbox{\hyperlink{structgeometry__mod_1_1point}{point}}
\begin{DoxyCompactList}\small\item\em Type -\/ point class. \end{DoxyCompactList}\item 
type \mbox{\hyperlink{structgeometry__mod_1_1shape}{shape}}
\begin{DoxyCompactList}\small\item\em Type -\/ extendable shape class. \end{DoxyCompactList}\item 
type \mbox{\hyperlink{structgeometry__mod_1_1sphere}{sphere}}
\begin{DoxyCompactList}\small\item\em Type -\/ sphere class. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacegeometry__mod_a1b6f259b0b6be71e02ffae7670f7d8ba}{allocatelist}} (self)
\begin{DoxyCompactList}\small\item\em Public routine to allocate the possible geometry name list. \end{DoxyCompactList}\item 
logical function \mbox{\hyperlink{namespacegeometry__mod_a22dd77024fce56da299445a697256155}{inlist}} (self, geomname)
\begin{DoxyCompactList}\small\item\em Public function that returns a logical if the input geometry name is valid. \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacegeometry__mod_a92602e1198d3607613ea2722fb002685}{fillsize}} (self, shapetype)
\begin{DoxyCompactList}\small\item\em method to get the number of points that fill a given geometry \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacegeometry__mod_a095a8b47b3c23e154dcd31ab1441a065}{fill}} (self, shapetype, \mbox{\hyperlink{namespacegeometry__mod_a92602e1198d3607613ea2722fb002685}{fillsize}}, ptlist)
\begin{DoxyCompactList}\small\item\em method to get the list of points that fill a given geometry \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacegeometry__mod_aed4426181ca851b41717edd50268e5f3}{printgeometry}} (self, shapetype)
\begin{DoxyCompactList}\small\item\em method to print the details of a given geometry \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacegeometry__mod_a05de7940b4e7df5a2b31f3d0414e3743}{sphere\+\_\+np\+\_\+count}} (dp, r)
\begin{DoxyCompactList}\small\item\em private function that returns the number of points distributed on a grid with spacing dp inside a sphere \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacegeometry__mod_a6c03a4ea3de6763940396dbeb3908ebc}{sphere\+\_\+grid}} (dp, r, np, ptlist)
\begin{DoxyCompactList}\small\item\em private routine that returns the points distributed on a grid with spacing dp inside a sphere \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacegeometry__mod_ae87e4ecff2d21a839da2b82919b5fd0b}{box\+\_\+grid}} (dp, size, np, ptlist)
\begin{DoxyCompactList}\small\item\em private routine that returns the points distributed on a grid with spacing dp inside a box \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacegeometry__mod_abcb09c0f5274c27cb79b0dd009ed94b3}{line\+\_\+grid}} (dp, dist, np, ptlist)
\begin{DoxyCompactList}\small\item\em private routine that returns the points distributed on a grid with spacing dp along a line \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
type(\mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}), public \mbox{\hyperlink{namespacegeometry__mod_ad2ad4f7e1138beaad5f37d5c15b7b457}{geometry}}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Module that defines geometry classes and related methods. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas 
\end{DoxyAuthor}


\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacegeometry__mod_a1b6f259b0b6be71e02ffae7670f7d8ba}\label{namespacegeometry__mod_a1b6f259b0b6be71e02ffae7670f7d8ba}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!allocatelist@{allocatelist}}
\index{allocatelist@{allocatelist}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{allocatelist()}{allocatelist()}}
{\footnotesize\ttfamily subroutine geometry\+\_\+mod\+::allocatelist (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}), intent(inout)}]{self }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Public routine to allocate the possible geometry name list. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}


Definition at line 77 of file geometry.\+f90.


\begin{DoxyCode}
77     \textcolor{keywordtype}{implicit none}
78     \textcolor{keywordtype}{class}(geometry\_class), \textcolor{keywordtype}{intent(inout)} :: self
79     \textcolor{keyword}{allocate}(self%list(4))
80     self%list(1) =\textcolor{stringliteral}{'point'}
81     self%list(2) =\textcolor{stringliteral}{'line'}
82     self%list(3) =\textcolor{stringliteral}{'box'}
83     self%list(4) =\textcolor{stringliteral}{'sphere'}
\end{DoxyCode}
\mbox{\Hypertarget{namespacegeometry__mod_ae87e4ecff2d21a839da2b82919b5fd0b}\label{namespacegeometry__mod_ae87e4ecff2d21a839da2b82919b5fd0b}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!box\+\_\+grid@{box\+\_\+grid}}
\index{box\+\_\+grid@{box\+\_\+grid}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{box\+\_\+grid()}{box\_grid()}}
{\footnotesize\ttfamily subroutine geometry\+\_\+mod\+::box\+\_\+grid (\begin{DoxyParamCaption}\item[{real(prec), intent(in)}]{dp,  }\item[{type(vector), intent(in)}]{size,  }\item[{integer, intent(in)}]{np,  }\item[{type(vector), dimension(np), intent(out)}]{ptlist }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



private routine that returns the points distributed on a grid with spacing dp inside a box 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em dp,size,np,ptlist} & \\
\hline
\end{DoxyParams}


Definition at line 316 of file geometry.\+f90.


\begin{DoxyCode}
316     \textcolor{keywordtype}{implicit none}
317     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{intent(in)} :: dp
318     \textcolor{keywordtype}{type}(vector), \textcolor{keywordtype}{intent(in)} :: size
319     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}::  np
320     \textcolor{keywordtype}{type}(vector), \textcolor{keywordtype}{intent(out)} :: ptlist(np)
321     \textcolor{keywordtype}{integer} :: i, j, k, p
322     p=0
323     \textcolor{keywordflow}{do} i=1, int(size%x/dp)+1
324         \textcolor{keywordflow}{do} j=1, int(size%y/dp)+1
325             \textcolor{keywordflow}{do} k=1, int(size%z/dp)+1
326                 p=p+1
327                 ptlist(p) = dp*(ex*(i-1)+ey*(j-1)+ez*(k-1))
328 \textcolor{keywordflow}{            end do}
329 \textcolor{keywordflow}{        end do}
330 \textcolor{keywordflow}{    end do}
331     \textcolor{keywordflow}{if} (np == 1) \textcolor{keywordflow}{then} \textcolor{comment}{!Just the origin}
332         ptlist(1)= 0*ex + 0*ey +0*ez
333 \textcolor{keywordflow}{    end if}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=336pt]{namespacegeometry__mod_ae87e4ecff2d21a839da2b82919b5fd0b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacegeometry__mod_a095a8b47b3c23e154dcd31ab1441a065}\label{namespacegeometry__mod_a095a8b47b3c23e154dcd31ab1441a065}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!fill@{fill}}
\index{fill@{fill}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{fill()}{fill()}}
{\footnotesize\ttfamily subroutine geometry\+\_\+mod\+::fill (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}), intent(in)}]{self,  }\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1shape}{shape}})}]{shapetype,  }\item[{integer, intent(in)}]{fillsize,  }\item[{type(vector), dimension(\mbox{\hyperlink{namespacegeometry__mod_a92602e1198d3607613ea2722fb002685}{fillsize}}), intent(out)}]{ptlist }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



method to get the list of points that fill a given geometry 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em shapetype,fillsize,ptlist} & \\
\hline
\end{DoxyParams}


Definition at line 156 of file geometry.\+f90.


\begin{DoxyCode}
156     \textcolor{keywordtype}{implicit none}
157     \textcolor{keywordtype}{class}(geometry\_class), \textcolor{keywordtype}{intent(in)} :: self
158     \textcolor{keywordtype}{class}(shape) :: shapetype
159     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: fillsize
160     \textcolor{keywordtype}{type}(vector), \textcolor{keywordtype}{intent(out)} :: ptlist(fillsize)
161     \textcolor{keywordtype}{type}(vector) :: temp
162     \textcolor{keywordtype}{type}(string) :: outext
163 
164     \textcolor{keywordflow}{select type} (shapetype)
165 \textcolor{keywordflow}{    type is} (shape)
166 \textcolor{keywordflow}{    class is} (box)
167         \textcolor{keyword}{call }box\_grid(globals%SimDefs%Dp, shapetype%size, fillsize, ptlist)
168 \textcolor{keywordflow}{    class is} (point)
169         ptlist(1)=shapetype%pt
170 \textcolor{keywordflow}{    class is} (line)
171         \textcolor{keyword}{call }line\_grid(globals%SimDefs%Dp, shapetype%last-shapetype%pt, fillsize, ptlist)
172 \textcolor{keywordflow}{    class is} (sphere)
173         \textcolor{keyword}{call }sphere\_grid(globals%SimDefs%Dp, shapetype%radius, fillsize, ptlist)
174 \textcolor{keywordflow}{        class default}
175         outext=\textcolor{stringliteral}{'[geometry::fill] : unexpected type for geometry object, stoping'}
176         \textcolor{keyword}{call }log%put(outext)
177         stop
178 \textcolor{keywordflow}{    end select}
179 
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=349pt]{namespacegeometry__mod_a095a8b47b3c23e154dcd31ab1441a065_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacegeometry__mod_a92602e1198d3607613ea2722fb002685}\label{namespacegeometry__mod_a92602e1198d3607613ea2722fb002685}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!fillsize@{fillsize}}
\index{fillsize@{fillsize}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{fillsize()}{fillsize()}}
{\footnotesize\ttfamily integer function geometry\+\_\+mod\+::fillsize (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}), intent(in)}]{self,  }\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1shape}{shape}}), intent(in)}]{shapetype }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



method to get the number of points that fill a given geometry 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em shapetype} & \\
\hline
\end{DoxyParams}


Definition at line 118 of file geometry.\+f90.


\begin{DoxyCode}
118     \textcolor{keywordtype}{implicit none}
119     \textcolor{keywordtype}{class}(geometry\_class), \textcolor{keywordtype}{intent(in)} :: self
120     \textcolor{keywordtype}{class}(shape), \textcolor{keywordtype}{intent(in)} :: shapetype
121     \textcolor{keywordtype}{real(prec)} :: dp
122     \textcolor{keywordtype}{integer} :: fillsize
123     \textcolor{keywordtype}{type}(vector) :: temp
124     \textcolor{keywordtype}{type}(string) :: outext
125 
126     dp = globals%SimDefs%Dp
127     \textcolor{keywordflow}{select type} (shapetype)
128 \textcolor{keywordflow}{    type is} (shape)
129 \textcolor{keywordflow}{    class is} (box)
130         fillsize = max((int(shapetype%size%x/dp)+1)*(int(shapetype%size%y/dp)+1)*(int(shapetype%size%z/dp)+
      1),1)
131 \textcolor{keywordflow}{    class is} (point)
132         fillsize = 1
133 \textcolor{keywordflow}{    class is} (line)
134         temp = shapetype%pt-shapetype%last
135         fillsize = max(int(temp%normL2()/dp),1)
136 \textcolor{keywordflow}{    class is} (sphere)
137         fillsize = sphere\_np\_count(dp, shapetype%radius)
138 \textcolor{keywordflow}{        class default}
139         outext=\textcolor{stringliteral}{'[geometry::np] : unexpected type for geometry object, stoping'}
140         \textcolor{keyword}{call }log%put(outext)
141         stop
142 \textcolor{keywordflow}{    end select}
143 
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=346pt]{namespacegeometry__mod_a92602e1198d3607613ea2722fb002685_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacegeometry__mod_a22dd77024fce56da299445a697256155}\label{namespacegeometry__mod_a22dd77024fce56da299445a697256155}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!inlist@{inlist}}
\index{inlist@{inlist}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{inlist()}{inlist()}}
{\footnotesize\ttfamily logical function geometry\+\_\+mod\+::inlist (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}), intent(in)}]{self,  }\item[{type(string), intent(in)}]{geomname }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Public function that returns a logical if the input geometry name is valid. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em geomname} & \\
\hline
\end{DoxyParams}


Definition at line 96 of file geometry.\+f90.


\begin{DoxyCode}
96     \textcolor{keywordtype}{implicit none}
97     \textcolor{keywordtype}{class}(geometry\_class), \textcolor{keywordtype}{intent(in)} :: self
98     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: geomname
99     \textcolor{keywordtype}{integer} :: i
100     tf = .false.
101     \textcolor{keywordflow}{do} i=1, \textcolor{keyword}{size}(self%list)
102         \textcolor{keywordflow}{if} (geomname == self%list(i)) \textcolor{keywordflow}{then}
103             tf = .true.
104 \textcolor{keywordflow}{        endif}
105 \textcolor{keywordflow}{    enddo}
\end{DoxyCode}
\mbox{\Hypertarget{namespacegeometry__mod_abcb09c0f5274c27cb79b0dd009ed94b3}\label{namespacegeometry__mod_abcb09c0f5274c27cb79b0dd009ed94b3}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!line\+\_\+grid@{line\+\_\+grid}}
\index{line\+\_\+grid@{line\+\_\+grid}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{line\+\_\+grid()}{line\_grid()}}
{\footnotesize\ttfamily subroutine geometry\+\_\+mod\+::line\+\_\+grid (\begin{DoxyParamCaption}\item[{real(prec), intent(in)}]{dp,  }\item[{type(vector), intent(in)}]{dist,  }\item[{integer, intent(in)}]{np,  }\item[{type(vector), dimension(np), intent(out)}]{ptlist }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



private routine that returns the points distributed on a grid with spacing dp along a line 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em dp,size,np,ptlist} & \\
\hline
\end{DoxyParams}


Definition at line 347 of file geometry.\+f90.


\begin{DoxyCode}
347     \textcolor{keywordtype}{implicit none}
348     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{intent(in)} :: dp
349     \textcolor{keywordtype}{type}(vector), \textcolor{keywordtype}{intent(in)} :: dist
350     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}::  np
351     \textcolor{keywordtype}{type}(vector), \textcolor{keywordtype}{intent(out)} :: ptlist(np)
352     \textcolor{keywordtype}{integer} :: i, j, k, p
353 
354     \textcolor{keywordflow}{do} p=1, np
355         ptlist(p) = dp/np*(dist*(p-1))
356 \textcolor{keywordflow}{    end do}
357     \textcolor{keywordflow}{if} (np == 1) \textcolor{keywordflow}{then} \textcolor{comment}{!Just the origin}
358         ptlist(1)= 0*ex + 0*ey +0*ez
359 \textcolor{keywordflow}{    end if}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=335pt]{namespacegeometry__mod_abcb09c0f5274c27cb79b0dd009ed94b3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacegeometry__mod_aed4426181ca851b41717edd50268e5f3}\label{namespacegeometry__mod_aed4426181ca851b41717edd50268e5f3}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!printgeometry@{printgeometry}}
\index{printgeometry@{printgeometry}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{printgeometry()}{printgeometry()}}
{\footnotesize\ttfamily subroutine geometry\+\_\+mod\+::printgeometry (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}), intent(in)}]{self,  }\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1shape}{shape}})}]{shapetype }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



method to print the details of a given geometry 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em shapetype} & \\
\hline
\end{DoxyParams}


Definition at line 191 of file geometry.\+f90.


\begin{DoxyCode}
191     \textcolor{keywordtype}{implicit none}
192     \textcolor{keywordtype}{class}(geometry\_class), \textcolor{keywordtype}{intent(in)} :: self
193     \textcolor{keywordtype}{class}(shape) :: shapetype
194     
195     \textcolor{keywordtype}{type}(vector) :: temp(2)
196     \textcolor{keywordtype}{type}(string) :: temp\_str(6)
197     \textcolor{keywordtype}{type}(string) :: outext
198 
199     temp\_str(1) = shapetype%pt%x
200     temp\_str(2) = shapetype%pt%y
201     temp\_str(3) = shapetype%pt%z
202     \textcolor{keywordflow}{select type} (shapetype)
203 \textcolor{keywordflow}{    type is} (shape)
204 \textcolor{keywordflow}{    class is} (box)
205         temp\_str(4) = shapetype%size%x
206         temp\_str(5) = shapetype%size%y
207         temp\_str(6) = shapetype%size%z
208         outext=\textcolor{stringliteral}{'      Box at '}//temp\_str(1)//\textcolor{stringliteral}{' '}//temp\_str(2)//\textcolor{stringliteral}{' '}//temp\_str(3)//new\_line(\textcolor{stringliteral}{'a'})//&
209                \textcolor{stringliteral}{'       with '}//temp\_str(4)//\textcolor{stringliteral}{' X '}//temp\_str(5)//\textcolor{stringliteral}{' X '}//temp\_str(6)      
210 \textcolor{keywordflow}{    class is} (point)
211         outext=\textcolor{stringliteral}{'      Point at '}//temp\_str(1)//\textcolor{stringliteral}{' '}//temp\_str(2)//\textcolor{stringliteral}{' '}//temp\_str(3)
212 \textcolor{keywordflow}{    class is} (line)
213         temp\_str(4) = shapetype%last%x
214         temp\_str(5) = shapetype%last%y
215         temp\_str(6) = shapetype%last%z
216         outext=\textcolor{stringliteral}{'      Line from '}//temp\_str(1)//\textcolor{stringliteral}{' '}//temp\_str(2)//\textcolor{stringliteral}{' '}//temp\_str(3)//new\_line(\textcolor{stringliteral}{'a'})//&
217                \textcolor{stringliteral}{'       to '}//temp\_str(4)//\textcolor{stringliteral}{' X '}//temp\_str(5)//\textcolor{stringliteral}{' X '}//temp\_str(6)
218 \textcolor{keywordflow}{    class is} (sphere)
219         temp\_str(4) = shapetype%radius
220         outext=\textcolor{stringliteral}{'      Sphere at '}//temp\_str(1)//\textcolor{stringliteral}{' '}//temp\_str(2)//\textcolor{stringliteral}{' '}//temp\_str(3)//new\_line(\textcolor{stringliteral}{'a'})//&
221                \textcolor{stringliteral}{'       with radius '}//temp\_str(4)        
222 \textcolor{keywordflow}{        class default}
223         outext=\textcolor{stringliteral}{'[geometry::print] : unexpected type for geometry object, stoping'}
224         \textcolor{keyword}{call }log%put(outext)
225         stop
226 \textcolor{keywordflow}{    end select}
227     \textcolor{keyword}{call }log%put(outext,.false.)
228 
\end{DoxyCode}
\mbox{\Hypertarget{namespacegeometry__mod_a6c03a4ea3de6763940396dbeb3908ebc}\label{namespacegeometry__mod_a6c03a4ea3de6763940396dbeb3908ebc}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!sphere\+\_\+grid@{sphere\+\_\+grid}}
\index{sphere\+\_\+grid@{sphere\+\_\+grid}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{sphere\+\_\+grid()}{sphere\_grid()}}
{\footnotesize\ttfamily subroutine geometry\+\_\+mod\+::sphere\+\_\+grid (\begin{DoxyParamCaption}\item[{real(prec), intent(in)}]{dp,  }\item[{real(prec), intent(in)}]{r,  }\item[{integer, intent(in)}]{np,  }\item[{type(vector), dimension(np), intent(out)}]{ptlist }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



private routine that returns the points distributed on a grid with spacing dp inside a sphere 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em dp,r,np,ptlist} & \\
\hline
\end{DoxyParams}


Definition at line 278 of file geometry.\+f90.


\begin{DoxyCode}
278     \textcolor{keywordtype}{implicit none}
279     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{intent(in)} :: dp
280     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{intent(in)} :: r
281     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}::  np
282     \textcolor{keywordtype}{type}(vector), \textcolor{keywordtype}{intent(out)} :: ptlist(np)
283     \textcolor{keywordtype}{integer} :: i, j, k, p, n
284     \textcolor{keywordtype}{type}(vector) :: pts
285     n=int(3*r/dp)
286     p=0
287     \textcolor{keywordflow}{do} i=1, n
288         \textcolor{keywordflow}{do} j=1, n
289             \textcolor{keywordflow}{do} k=1, n
290                 pts = dp*(ex*(i-1)+ey*(j-1)+ez*(k-1)) - r*(ex+ey+ez)
291                 \textcolor{keywordflow}{if} (pts%normL2() .le. r) \textcolor{keywordflow}{then}
292                     p=p+1
293                     ptlist(p)=pts
294 \textcolor{keywordflow}{                end if}
295 \textcolor{keywordflow}{            end do}
296 \textcolor{keywordflow}{        end do}
297 \textcolor{keywordflow}{    end do}
298     \textcolor{keywordflow}{if} (np == 1) \textcolor{keywordflow}{then} \textcolor{comment}{!Just the center point}
299         ptlist(1)= 0*ex + 0*ey +0*ez
300 \textcolor{keywordflow}{    end if}
301 
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=349pt]{namespacegeometry__mod_a6c03a4ea3de6763940396dbeb3908ebc_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacegeometry__mod_a05de7940b4e7df5a2b31f3d0414e3743}\label{namespacegeometry__mod_a05de7940b4e7df5a2b31f3d0414e3743}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!sphere\+\_\+np\+\_\+count@{sphere\+\_\+np\+\_\+count}}
\index{sphere\+\_\+np\+\_\+count@{sphere\+\_\+np\+\_\+count}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{sphere\+\_\+np\+\_\+count()}{sphere\_np\_count()}}
{\footnotesize\ttfamily integer function geometry\+\_\+mod\+::sphere\+\_\+np\+\_\+count (\begin{DoxyParamCaption}\item[{real(prec), intent(in)}]{dp,  }\item[{real(prec), intent(in)}]{r }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



private function that returns the number of points distributed on a grid with spacing dp inside a sphere 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em dp,r} & \\
\hline
\end{DoxyParams}


Definition at line 243 of file geometry.\+f90.


\begin{DoxyCode}
243     \textcolor{keywordtype}{implicit none}
244     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{intent(in)} :: dp
245     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{intent(in)} :: r
246     \textcolor{keywordtype}{integer} :: np
247     \textcolor{keywordtype}{integer} :: i, j, k, n
248     \textcolor{keywordtype}{type}(vector) :: pts
249     np=0
250     n=int(3*r/dp)
251     \textcolor{keywordflow}{do} i=1, n
252         \textcolor{keywordflow}{do} j=1, n
253             \textcolor{keywordflow}{do} k=1, n
254                 pts = dp*(ex*(i-1)+ey*(j-1)+ez*(k-1)) - r*(ex+ey+ez)
255                 \textcolor{keywordflow}{if} (pts%normL2() .le. r) \textcolor{keywordflow}{then}
256                     np=np+1
257 \textcolor{keywordflow}{                end if}
258 \textcolor{keywordflow}{            end do}
259 \textcolor{keywordflow}{        end do}
260 \textcolor{keywordflow}{    end do}
261     \textcolor{keywordflow}{if} (np == 0) \textcolor{keywordflow}{then} \textcolor{comment}{!Just the center point}
262         np=1
263 \textcolor{keywordflow}{    end if}
264 
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=346pt]{namespacegeometry__mod_a05de7940b4e7df5a2b31f3d0414e3743_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{namespacegeometry__mod_ad2ad4f7e1138beaad5f37d5c15b7b457}\label{namespacegeometry__mod_ad2ad4f7e1138beaad5f37d5c15b7b457}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!geometry@{geometry}}
\index{geometry@{geometry}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{geometry}{geometry}}
{\footnotesize\ttfamily type(\mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}), public geometry\+\_\+mod\+::geometry}



Definition at line 61 of file geometry.\+f90.


\begin{DoxyCode}
61     \textcolor{keywordtype}{type}(geometry\_class) :: Geometry
\end{DoxyCode}
