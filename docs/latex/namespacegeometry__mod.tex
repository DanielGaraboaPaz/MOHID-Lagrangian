\hypertarget{namespacegeometry__mod}{}\section{geometry\+\_\+mod Module Reference}
\label{namespacegeometry__mod}\index{geometry\+\_\+mod@{geometry\+\_\+mod}}


Module that defines geometry classes and related methods.  


\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structgeometry__mod_1_1box}{box}}
\begin{DoxyCompactList}\small\item\em Type -\/ point class. \end{DoxyCompactList}\item 
type \mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}
\item 
type \mbox{\hyperlink{structgeometry__mod_1_1line}{line}}
\begin{DoxyCompactList}\small\item\em Type -\/ line class. \end{DoxyCompactList}\item 
type \mbox{\hyperlink{structgeometry__mod_1_1point}{point}}
\begin{DoxyCompactList}\small\item\em Type -\/ point class. \end{DoxyCompactList}\item 
type \mbox{\hyperlink{structgeometry__mod_1_1shape}{shape}}
\begin{DoxyCompactList}\small\item\em Type -\/ extendable shape class. \end{DoxyCompactList}\item 
type \mbox{\hyperlink{structgeometry__mod_1_1sphere}{sphere}}
\begin{DoxyCompactList}\small\item\em Type -\/ sphere class. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacegeometry__mod_a571a294c2a1869259d21267005c32025}{allocateshape}} (self, name, shape\+\_\+obj)
\begin{DoxyCompactList}\small\item\em Returns allocated Shape with a specific shape given a name. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacegeometry__mod_a1b6f259b0b6be71e02ffae7670f7d8ba}{allocatelist}} (self)
\begin{DoxyCompactList}\small\item\em Public routine to allocate the possible geometry name list. \end{DoxyCompactList}\item 
logical function \mbox{\hyperlink{namespacegeometry__mod_a22dd77024fce56da299445a697256155}{inlist}} (self, geomname)
\begin{DoxyCompactList}\small\item\em Public function that returns a logical if the input geometry name is valid. \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacegeometry__mod_ad790edd694561b33dad20cfa3a14e8f2}{fillsize}} (self, shapetype, dp)
\begin{DoxyCompactList}\small\item\em method to get the number of points that fill a given geometry \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacegeometry__mod_a1d97564e04562532b5389bfb91aa676b}{fill}} (self, shapetype, dp, \mbox{\hyperlink{namespacegeometry__mod_ad790edd694561b33dad20cfa3a14e8f2}{fillsize}}, ptlist)
\begin{DoxyCompactList}\small\item\em method to get the list of points that fill a given geometry \end{DoxyCompactList}\item 
type(vector) function \mbox{\hyperlink{namespacegeometry__mod_a4a38edbff02aa0ff5f16a16c39bf778e}{getcenter}} (self, shapetype)
\begin{DoxyCompactList}\small\item\em method to get the baricenter of a given geometry \end{DoxyCompactList}\item 
type(vector) function, dimension(\+:), allocatable \mbox{\hyperlink{namespacegeometry__mod_a0b1a3c5aa414292ace34d59487082e3a}{getpoints}} (self, shapetype)
\begin{DoxyCompactList}\small\item\em method that returns the points defining a given geometry \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacegeometry__mod_a524c5d28a80fb6729b102126485605ce}{getnumpoints}} (self, shapetype)
\begin{DoxyCompactList}\small\item\em method the points defining a given geometry \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacegeometry__mod_aed4426181ca851b41717edd50268e5f3}{printgeometry}} (self, shapetype)
\begin{DoxyCompactList}\small\item\em method to print the details of a given geometry \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacegeometry__mod_a05de7940b4e7df5a2b31f3d0414e3743}{sphere\+\_\+np\+\_\+count}} (dp, r)
\begin{DoxyCompactList}\small\item\em private function that returns the number of points distributed on a grid with spacing dp inside a sphere \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacegeometry__mod_a6c03a4ea3de6763940396dbeb3908ebc}{sphere\+\_\+grid}} (dp, r, np, ptlist)
\begin{DoxyCompactList}\small\item\em private routine that returns the points distributed on a grid with spacing dp inside a sphere \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacegeometry__mod_ae87e4ecff2d21a839da2b82919b5fd0b}{box\+\_\+grid}} (dp, size, np, ptlist)
\begin{DoxyCompactList}\small\item\em private routine that returns the points distributed on a grid with spacing dp inside a box \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacegeometry__mod_abcb09c0f5274c27cb79b0dd009ed94b3}{line\+\_\+grid}} (dp, dist, np, ptlist)
\begin{DoxyCompactList}\small\item\em private routine that returns the points distributed on a grid with spacing dp along a line \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
type(\mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}), public \mbox{\hyperlink{namespacegeometry__mod_ad2ad4f7e1138beaad5f37d5c15b7b457}{geometry}}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Module that defines geometry classes and related methods. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas 
\end{DoxyAuthor}


\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacegeometry__mod_a1b6f259b0b6be71e02ffae7670f7d8ba}\label{namespacegeometry__mod_a1b6f259b0b6be71e02ffae7670f7d8ba}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!allocatelist@{allocatelist}}
\index{allocatelist@{allocatelist}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{allocatelist()}{allocatelist()}}
{\footnotesize\ttfamily subroutine geometry\+\_\+mod\+::allocatelist (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}), intent(inout)}]{self }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Public routine to allocate the possible geometry name list. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}


Definition at line 106 of file geometry.\+f90.


\begin{DoxyCode}
106     \textcolor{keywordtype}{implicit none}
107     \textcolor{keywordtype}{class}(geometry\_class), \textcolor{keywordtype}{intent(inout)} :: self
108     \textcolor{keyword}{allocate}(self%list(4))
109     self%list(1) =\textcolor{stringliteral}{'point'}
110     self%list(2) =\textcolor{stringliteral}{'line'}
111     self%list(3) =\textcolor{stringliteral}{'box'}
112     self%list(4) =\textcolor{stringliteral}{'sphere'}
\end{DoxyCode}
\mbox{\Hypertarget{namespacegeometry__mod_a571a294c2a1869259d21267005c32025}\label{namespacegeometry__mod_a571a294c2a1869259d21267005c32025}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!allocateshape@{allocateshape}}
\index{allocateshape@{allocateshape}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{allocateshape()}{allocateshape()}}
{\footnotesize\ttfamily subroutine geometry\+\_\+mod\+::allocateshape (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}), intent(in)}]{self,  }\item[{type(string), intent(in)}]{name,  }\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1shape}{shape}}), intent(inout), allocatable}]{shape\+\_\+obj }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Returns allocated Shape with a specific shape given a name. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,name,shape\+\_\+obj} & \\
\hline
\end{DoxyParams}


Definition at line 80 of file geometry.\+f90.


\begin{DoxyCode}
80     \textcolor{keywordtype}{class}(geometry\_class), \textcolor{keywordtype}{intent(in)} :: self
81     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: name
82     \textcolor{keywordtype}{class}(shape), \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{intent(inout)} :: shape\_obj
83     \textcolor{keywordtype}{type}(string) :: outext
84     \textcolor{keywordflow}{select case} (name%chars())
85     \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'point'})
86         \textcolor{keyword}{allocate}(point::shape\_obj)
87     \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'sphere'})
88         \textcolor{keyword}{allocate}(sphere::shape\_obj)
89     \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'box'})
90         \textcolor{keyword}{allocate}(box::shape\_obj)
91     \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'line'})
92         \textcolor{keyword}{allocate}(line::shape\_obj)
93 \textcolor{keywordflow}{    case default}
94         outext=\textcolor{stringliteral}{'[Geometry::allocateShape]: unexpected type for geometry object "'}//name//\textcolor{stringliteral}{'", stoping'}
95         \textcolor{keyword}{call }log%put(outext)
96         stop
97 \textcolor{keywordflow}{    end select}
\end{DoxyCode}
\mbox{\Hypertarget{namespacegeometry__mod_ae87e4ecff2d21a839da2b82919b5fd0b}\label{namespacegeometry__mod_ae87e4ecff2d21a839da2b82919b5fd0b}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!box\+\_\+grid@{box\+\_\+grid}}
\index{box\+\_\+grid@{box\+\_\+grid}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{box\+\_\+grid()}{box\_grid()}}
{\footnotesize\ttfamily subroutine geometry\+\_\+mod\+::box\+\_\+grid (\begin{DoxyParamCaption}\item[{real(prec), intent(in)}]{dp,  }\item[{type(vector), intent(in)}]{size,  }\item[{integer, intent(in)}]{np,  }\item[{type(vector), dimension(np), intent(out)}]{ptlist }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



private routine that returns the points distributed on a grid with spacing dp inside a box 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em dp,size,np,ptlist} & \\
\hline
\end{DoxyParams}


Definition at line 423 of file geometry.\+f90.


\begin{DoxyCode}
423     \textcolor{keywordtype}{implicit none}
424     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{intent(in)} :: dp
425     \textcolor{keywordtype}{type}(vector), \textcolor{keywordtype}{intent(in)} :: size
426     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}::  np
427     \textcolor{keywordtype}{type}(vector), \textcolor{keywordtype}{intent(out)} :: ptlist(np)
428     \textcolor{keywordtype}{integer} :: i, j, k, p
429     p=0
430     \textcolor{keywordflow}{do} i=1, int(size%x/dp)+1
431         \textcolor{keywordflow}{do} j=1, int(size%y/dp)+1
432             \textcolor{keywordflow}{do} k=1, int(size%z/dp)+1
433                 p=p+1
434                 ptlist(p) = dp*(ex*(i-1) + ey*(j-1) + ez*(k-1))
435 \textcolor{keywordflow}{            end do}
436 \textcolor{keywordflow}{        end do}
437 \textcolor{keywordflow}{    end do}
438     \textcolor{keywordflow}{if} (np == 1) \textcolor{keywordflow}{then} \textcolor{comment}{!Just the origin}
439         ptlist(1)= 0*ex + 0*ey +0*ez
440 \textcolor{keywordflow}{    end if}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=336pt]{namespacegeometry__mod_ae87e4ecff2d21a839da2b82919b5fd0b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacegeometry__mod_a1d97564e04562532b5389bfb91aa676b}\label{namespacegeometry__mod_a1d97564e04562532b5389bfb91aa676b}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!fill@{fill}}
\index{fill@{fill}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{fill()}{fill()}}
{\footnotesize\ttfamily subroutine geometry\+\_\+mod\+::fill (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}), intent(in)}]{self,  }\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1shape}{shape}})}]{shapetype,  }\item[{real(prec), intent(in)}]{dp,  }\item[{integer, intent(in)}]{fillsize,  }\item[{type(vector), dimension(\mbox{\hyperlink{namespacegeometry__mod_ad790edd694561b33dad20cfa3a14e8f2}{fillsize}}), intent(out)}]{ptlist }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



method to get the list of points that fill a given geometry 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,shapetype,dp,fillsize,ptlist} & \\
\hline
\end{DoxyParams}


Definition at line 174 of file geometry.\+f90.


\begin{DoxyCode}
174     \textcolor{keywordtype}{implicit none}
175     \textcolor{keywordtype}{class}(geometry\_class), \textcolor{keywordtype}{intent(in)} :: self
176     \textcolor{keywordtype}{class}(shape) :: shapetype
177     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{intent(in)} :: dp
178     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: fillsize
179     \textcolor{keywordtype}{type}(vector), \textcolor{keywordtype}{intent(out)} :: ptlist(fillsize)
180     \textcolor{keywordtype}{type}(vector) :: temp
181     \textcolor{keywordtype}{type}(string) :: outext
182     \textcolor{keywordflow}{select type} (shapetype)
183 \textcolor{keywordflow}{    type is} (shape)
184 \textcolor{keywordflow}{    class is} (box)
185         \textcolor{keyword}{call }box\_grid(dp, shapetype%size, fillsize, ptlist)
186 \textcolor{keywordflow}{    class is} (point)
187         ptlist(1)=0
188 \textcolor{keywordflow}{    class is} (line)
189         \textcolor{keyword}{call }line\_grid(dp, utils%geo2m(shapetype%last-shapetype%pt, shapetype%pt%y), fillsize, ptlist)
190 \textcolor{keywordflow}{    class is} (sphere)
191         \textcolor{keyword}{call }sphere\_grid(dp, shapetype%radius, fillsize, ptlist)
192 \textcolor{keywordflow}{        class default}
193         outext=\textcolor{stringliteral}{'[geometry::fill] : unexpected type for geometry object, stoping'}
194         \textcolor{keyword}{call }log%put(outext)
195         stop
196 \textcolor{keywordflow}{    end select}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=349pt]{namespacegeometry__mod_a1d97564e04562532b5389bfb91aa676b_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacegeometry__mod_ad790edd694561b33dad20cfa3a14e8f2}\label{namespacegeometry__mod_ad790edd694561b33dad20cfa3a14e8f2}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!fillsize@{fillsize}}
\index{fillsize@{fillsize}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{fillsize()}{fillsize()}}
{\footnotesize\ttfamily integer function geometry\+\_\+mod\+::fillsize (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}), intent(in)}]{self,  }\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1shape}{shape}}), intent(in)}]{shapetype,  }\item[{real(prec), intent(in)}]{dp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



method to get the number of points that fill a given geometry 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,shapetype,dp} & \\
\hline
\end{DoxyParams}


Definition at line 141 of file geometry.\+f90.


\begin{DoxyCode}
141     \textcolor{keywordtype}{implicit none}
142     \textcolor{keywordtype}{class}(geometry\_class), \textcolor{keywordtype}{intent(in)} :: self
143     \textcolor{keywordtype}{class}(shape), \textcolor{keywordtype}{intent(in)} :: shapetype
144     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{intent(in)} :: dp
145     \textcolor{keywordtype}{integer} :: fillsize
146     \textcolor{keywordtype}{type}(vector) :: temp
147     \textcolor{keywordtype}{type}(string) :: outext
148     \textcolor{keywordflow}{select type} (shapetype)
149 \textcolor{keywordflow}{    type is} (shape)
150 \textcolor{keywordflow}{    class is} (box)
151         fillsize = max((int(shapetype%size%x/dp)+1)*(int(shapetype%size%y/dp)+1)*(int(shapetype%size%z/dp)+
      1),1)
152 \textcolor{keywordflow}{    class is} (point)
153         fillsize = 1
154 \textcolor{keywordflow}{    class is} (line)
155         temp = shapetype%pt - shapetype%last
156         temp = utils%geo2m(temp, shapetype%pt%y)
157         fillsize = max(int(temp%normL2()/dp),1)
158 \textcolor{keywordflow}{    class is} (sphere)
159         fillsize = sphere\_np\_count(dp, shapetype%radius)
160 \textcolor{keywordflow}{        class default}
161         outext=\textcolor{stringliteral}{'[geometry::fillsize] : unexpected type for geometry object, stoping'}
162         \textcolor{keyword}{call }log%put(outext)
163         stop
164 \textcolor{keywordflow}{    end select}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=346pt]{namespacegeometry__mod_ad790edd694561b33dad20cfa3a14e8f2_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacegeometry__mod_a4a38edbff02aa0ff5f16a16c39bf778e}\label{namespacegeometry__mod_a4a38edbff02aa0ff5f16a16c39bf778e}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!getcenter@{getcenter}}
\index{getcenter@{getcenter}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{getcenter()}{getcenter()}}
{\footnotesize\ttfamily type(vector) function geometry\+\_\+mod\+::getcenter (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}), intent(in)}]{self,  }\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1shape}{shape}}), intent(in)}]{shapetype }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



method to get the baricenter of a given geometry 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,shapetype} & \\
\hline
\end{DoxyParams}


Definition at line 206 of file geometry.\+f90.


\begin{DoxyCode}
206     \textcolor{keywordtype}{implicit none}
207     \textcolor{keywordtype}{class}(geometry\_class), \textcolor{keywordtype}{intent(in)} :: self
208     \textcolor{keywordtype}{class}(shape), \textcolor{keywordtype}{intent(in)} :: shapetype
209     \textcolor{keywordtype}{type}(vector) :: center
210     \textcolor{keywordtype}{type}(string) :: outext
211     \textcolor{keywordflow}{select type} (shapetype)
212 \textcolor{keywordflow}{    type is} (shape)
213 \textcolor{keywordflow}{    class is} (box)
214         center = shapetype%pt + utils%m2geo(shapetype%size, shapetype%pt%y)/2.0
215 \textcolor{keywordflow}{    class is} (point)
216         center = shapetype%pt
217 \textcolor{keywordflow}{    class is} (line)
218         center = shapetype%pt + (shapetype%last-shapetype%pt)/2.0
219 \textcolor{keywordflow}{    class is} (sphere)
220         center = shapetype%pt
221 \textcolor{keywordflow}{        class default}
222         outext=\textcolor{stringliteral}{'[geometry::getCenter] : unexpected type for geometry object, stoping'}
223         \textcolor{keyword}{call }log%put(outext)
224         stop
225 \textcolor{keywordflow}{    end select}
\end{DoxyCode}
\mbox{\Hypertarget{namespacegeometry__mod_a524c5d28a80fb6729b102126485605ce}\label{namespacegeometry__mod_a524c5d28a80fb6729b102126485605ce}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!getnumpoints@{getnumpoints}}
\index{getnumpoints@{getnumpoints}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{getnumpoints()}{getnumpoints()}}
{\footnotesize\ttfamily integer function geometry\+\_\+mod\+::getnumpoints (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}), intent(in)}]{self,  }\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1shape}{shape}}), intent(in)}]{shapetype }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



method the points defining a given geometry 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,shapetype} & \\
\hline
\end{DoxyParams}


Definition at line 282 of file geometry.\+f90.


\begin{DoxyCode}
282     \textcolor{keywordtype}{class}(geometry\_class), \textcolor{keywordtype}{intent(in)} :: self
283     \textcolor{keywordtype}{class}(shape), \textcolor{keywordtype}{intent(in)} :: shapetype
284     \textcolor{keywordtype}{integer} :: n
285     \textcolor{keywordtype}{type}(string) :: outext
286     \textcolor{keywordflow}{select type} (shapetype)
287 \textcolor{keywordflow}{    type is} (shape)
288 \textcolor{keywordflow}{    class is} (box)
289         n=8
290 \textcolor{keywordflow}{    class is} (point)
291         n=1
292 \textcolor{keywordflow}{    class is} (line)
293         n=2
294 \textcolor{keywordflow}{    class is} (sphere)
295         n=1
296 \textcolor{keywordflow}{        class default}
297         outext=\textcolor{stringliteral}{'[geometry::getnumPoints] : unexpected type for geometry object, stoping'}
298         \textcolor{keyword}{call }log%put(outext)
299         stop
300 \textcolor{keywordflow}{    end select}
\end{DoxyCode}
\mbox{\Hypertarget{namespacegeometry__mod_a0b1a3c5aa414292ace34d59487082e3a}\label{namespacegeometry__mod_a0b1a3c5aa414292ace34d59487082e3a}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!getpoints@{getpoints}}
\index{getpoints@{getpoints}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{getpoints()}{getpoints()}}
{\footnotesize\ttfamily type(vector) function, dimension(\+:), allocatable geometry\+\_\+mod\+::getpoints (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}), intent(in)}]{self,  }\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1shape}{shape}}), intent(in)}]{shapetype }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



method that returns the points defining a given geometry 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,shapetype} & \\
\hline
\end{DoxyParams}


Definition at line 235 of file geometry.\+f90.


\begin{DoxyCode}
235     \textcolor{keywordtype}{class}(geometry\_class), \textcolor{keywordtype}{intent(in)} :: self
236     \textcolor{keywordtype}{class}(shape), \textcolor{keywordtype}{intent(in)} :: shapetype
237     \textcolor{keywordtype}{type}(vector), \textcolor{keywordtype}{allocatable} :: pts(:)
238     \textcolor{keywordtype}{type}(string) :: outext
239     \textcolor{keywordtype}{integer} :: n
240     \textcolor{keywordtype}{type}(vector) :: temp
241     \textcolor{keywordflow}{select type} (shapetype)
242 \textcolor{keywordflow}{    type is} (shape)
243 \textcolor{keywordflow}{    class is} (box)
244         n=8
245         \textcolor{keyword}{allocate}(pts(n))
246         temp = shapetype%size
247         pts(1) = shapetype%pt
248         pts(2) = shapetype%pt + temp%y*ey
249         pts(3) = pts(2) + temp%z*ez
250         pts(4) = shapetype%pt + temp%z*ez
251         pts(5) = shapetype%pt + temp%x*ex
252         pts(6) = pts(5) + temp%y*ey
253         pts(7) = shapetype%pt + temp
254         pts(8) = pts(5) + temp%z*ez
255 \textcolor{keywordflow}{    class is} (point)
256         n=1
257         \textcolor{keyword}{allocate}(pts(n))
258         pts(1) = shapetype%pt
259 \textcolor{keywordflow}{    class is} (line)
260         n=2
261         \textcolor{keyword}{allocate}(pts(n))
262         pts(1) = shapetype%pt
263         pts(2) = shapetype%last
264 \textcolor{keywordflow}{    class is} (sphere)
265         n=1
266         \textcolor{keyword}{allocate}(pts(n))
267         pts(1) = shapetype%pt
268 \textcolor{keywordflow}{        class default}
269         outext=\textcolor{stringliteral}{'[geometry::getPoints] : unexpected type for geometry object, stoping'}
270         \textcolor{keyword}{call }log%put(outext)
271         stop
272 \textcolor{keywordflow}{    end select}
\end{DoxyCode}
\mbox{\Hypertarget{namespacegeometry__mod_a22dd77024fce56da299445a697256155}\label{namespacegeometry__mod_a22dd77024fce56da299445a697256155}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!inlist@{inlist}}
\index{inlist@{inlist}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{inlist()}{inlist()}}
{\footnotesize\ttfamily logical function geometry\+\_\+mod\+::inlist (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}), intent(in)}]{self,  }\item[{type(string), intent(in)}]{geomname }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Public function that returns a logical if the input geometry name is valid. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,geomname} & \\
\hline
\end{DoxyParams}


Definition at line 122 of file geometry.\+f90.


\begin{DoxyCode}
122     \textcolor{keywordtype}{implicit none}
123     \textcolor{keywordtype}{class}(geometry\_class), \textcolor{keywordtype}{intent(in)} :: self
124     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: geomname
125     \textcolor{keywordtype}{integer} :: i
126     tf = .false.
127     \textcolor{keywordflow}{do} i=1, \textcolor{keyword}{size}(self%list)
128         \textcolor{keywordflow}{if} (geomname == self%list(i)) \textcolor{keywordflow}{then}
129             tf = .true.
130 \textcolor{keywordflow}{        endif}
131 \textcolor{keywordflow}{    enddo}
\end{DoxyCode}
\mbox{\Hypertarget{namespacegeometry__mod_abcb09c0f5274c27cb79b0dd009ed94b3}\label{namespacegeometry__mod_abcb09c0f5274c27cb79b0dd009ed94b3}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!line\+\_\+grid@{line\+\_\+grid}}
\index{line\+\_\+grid@{line\+\_\+grid}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{line\+\_\+grid()}{line\_grid()}}
{\footnotesize\ttfamily subroutine geometry\+\_\+mod\+::line\+\_\+grid (\begin{DoxyParamCaption}\item[{real(prec), intent(in)}]{dp,  }\item[{type(vector), intent(in)}]{dist,  }\item[{integer, intent(in)}]{np,  }\item[{type(vector), dimension(np), intent(out)}]{ptlist }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



private routine that returns the points distributed on a grid with spacing dp along a line 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em dp,dist,np,ptlist} & \\
\hline
\end{DoxyParams}


Definition at line 451 of file geometry.\+f90.


\begin{DoxyCode}
451     \textcolor{keywordtype}{implicit none}
452     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{intent(in)} :: dp
453     \textcolor{keywordtype}{type}(vector), \textcolor{keywordtype}{intent(in)} :: dist
454     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}::  np
455     \textcolor{keywordtype}{type}(vector), \textcolor{keywordtype}{intent(out)} :: ptlist(np)
456     \textcolor{keywordtype}{integer} :: i, j, k, p
457 
458     \textcolor{keywordflow}{do} p=1, np
459         ptlist(p) = dist*(p-1)/np
460 \textcolor{keywordflow}{    end do}
461     \textcolor{keywordflow}{if} (np == 1) \textcolor{keywordflow}{then} \textcolor{comment}{!Just the origin}
462         ptlist(1)= 0*ex + 0*ey +0*ez
463 \textcolor{keywordflow}{    end if}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=335pt]{namespacegeometry__mod_abcb09c0f5274c27cb79b0dd009ed94b3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacegeometry__mod_aed4426181ca851b41717edd50268e5f3}\label{namespacegeometry__mod_aed4426181ca851b41717edd50268e5f3}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!printgeometry@{printgeometry}}
\index{printgeometry@{printgeometry}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{printgeometry()}{printgeometry()}}
{\footnotesize\ttfamily subroutine geometry\+\_\+mod\+::printgeometry (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}), intent(in)}]{self,  }\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1shape}{shape}})}]{shapetype }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



method to print the details of a given geometry 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,shapetype} & \\
\hline
\end{DoxyParams}


Definition at line 310 of file geometry.\+f90.


\begin{DoxyCode}
310     \textcolor{keywordtype}{implicit none}
311     \textcolor{keywordtype}{class}(geometry\_class), \textcolor{keywordtype}{intent(in)} :: self
312     \textcolor{keywordtype}{class}(shape) :: shapetype
313 
314     \textcolor{keywordtype}{type}(vector) :: temp(2)
315     \textcolor{keywordtype}{type}(string) :: temp\_str(6)
316     \textcolor{keywordtype}{type}(string) :: outext
317 
318     temp\_str(1) = shapetype%pt%x
319     temp\_str(2) = shapetype%pt%y
320     temp\_str(3) = shapetype%pt%z
321     \textcolor{keywordflow}{select type} (shapetype)
322 \textcolor{keywordflow}{    type is} (shape)
323 \textcolor{keywordflow}{    class is} (box)
324         temp\_str(4) = shapetype%size%x
325         temp\_str(5) = shapetype%size%y
326         temp\_str(6) = shapetype%size%z
327         outext=\textcolor{stringliteral}{'      Box at '}//temp\_str(1)//\textcolor{stringliteral}{' '}//temp\_str(2)//\textcolor{stringliteral}{' '}//temp\_str(3)//new\_line(\textcolor{stringliteral}{'a'})//&
328             \textcolor{stringliteral}{'       with '}//temp\_str(4)//\textcolor{stringliteral}{' X '}//temp\_str(5)//\textcolor{stringliteral}{' X '}//temp\_str(6)
329 \textcolor{keywordflow}{    class is} (point)
330         outext=\textcolor{stringliteral}{'      Point at '}//temp\_str(1)//\textcolor{stringliteral}{' '}//temp\_str(2)//\textcolor{stringliteral}{' '}//temp\_str(3)
331 \textcolor{keywordflow}{    class is} (line)
332         temp\_str(4) = shapetype%last%x
333         temp\_str(5) = shapetype%last%y
334         temp\_str(6) = shapetype%last%z
335         outext=\textcolor{stringliteral}{'      Line from '}//temp\_str(1)//\textcolor{stringliteral}{' '}//temp\_str(2)//\textcolor{stringliteral}{' '}//temp\_str(3)//new\_line(\textcolor{stringliteral}{'a'})//&
336             \textcolor{stringliteral}{'       to '}//temp\_str(4)//\textcolor{stringliteral}{' X '}//temp\_str(5)//\textcolor{stringliteral}{' X '}//temp\_str(6)
337 \textcolor{keywordflow}{    class is} (sphere)
338         temp\_str(4) = shapetype%radius
339         outext=\textcolor{stringliteral}{'      Sphere at '}//temp\_str(1)//\textcolor{stringliteral}{' '}//temp\_str(2)//\textcolor{stringliteral}{' '}//temp\_str(3)//new\_line(\textcolor{stringliteral}{'a'})//&
340             \textcolor{stringliteral}{'       with radius '}//temp\_str(4)
341 \textcolor{keywordflow}{        class default}
342         outext=\textcolor{stringliteral}{'[geometry::print] : unexpected type for geometry object, stoping'}
343         \textcolor{keyword}{call }log%put(outext)
344         stop
345 \textcolor{keywordflow}{    end select}
346     \textcolor{keyword}{call }log%put(outext,.false.)
347 
\end{DoxyCode}
\mbox{\Hypertarget{namespacegeometry__mod_a6c03a4ea3de6763940396dbeb3908ebc}\label{namespacegeometry__mod_a6c03a4ea3de6763940396dbeb3908ebc}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!sphere\+\_\+grid@{sphere\+\_\+grid}}
\index{sphere\+\_\+grid@{sphere\+\_\+grid}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{sphere\+\_\+grid()}{sphere\_grid()}}
{\footnotesize\ttfamily subroutine geometry\+\_\+mod\+::sphere\+\_\+grid (\begin{DoxyParamCaption}\item[{real(prec), intent(in)}]{dp,  }\item[{real(prec), intent(in)}]{r,  }\item[{integer, intent(in)}]{np,  }\item[{type(vector), dimension(np), intent(out)}]{ptlist }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



private routine that returns the points distributed on a grid with spacing dp inside a sphere 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em dp,r,np,ptlist} & \\
\hline
\end{DoxyParams}


Definition at line 389 of file geometry.\+f90.


\begin{DoxyCode}
389     \textcolor{keywordtype}{implicit none}
390     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{intent(in)} :: dp
391     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{intent(in)} :: r
392     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}::  np
393     \textcolor{keywordtype}{type}(vector), \textcolor{keywordtype}{intent(out)} :: ptlist(np)
394     \textcolor{keywordtype}{integer} :: i, j, k, p, n
395     \textcolor{keywordtype}{type}(vector) :: pts
396     n=int(3*r/dp)
397     p=0
398     \textcolor{keywordflow}{do} i=1, n
399         \textcolor{keywordflow}{do} j=1, n
400             \textcolor{keywordflow}{do} k=1, n
401                 pts = dp*(ex*(i-1)+ey*(j-1)+ez*(k-1)) - r*(ex+ey+ez)
402                 \textcolor{keywordflow}{if} (pts%normL2() .le. r) \textcolor{keywordflow}{then}
403                     p=p+1
404                     ptlist(p)=pts
405 \textcolor{keywordflow}{                end if}
406 \textcolor{keywordflow}{            end do}
407 \textcolor{keywordflow}{        end do}
408 \textcolor{keywordflow}{    end do}
409     \textcolor{keywordflow}{if} (np == 1) \textcolor{keywordflow}{then} \textcolor{comment}{!Just the center point}
410         ptlist(1)= 0*ex + 0*ey +0*ez
411 \textcolor{keywordflow}{    end if}
412 
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=349pt]{namespacegeometry__mod_a6c03a4ea3de6763940396dbeb3908ebc_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacegeometry__mod_a05de7940b4e7df5a2b31f3d0414e3743}\label{namespacegeometry__mod_a05de7940b4e7df5a2b31f3d0414e3743}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!sphere\+\_\+np\+\_\+count@{sphere\+\_\+np\+\_\+count}}
\index{sphere\+\_\+np\+\_\+count@{sphere\+\_\+np\+\_\+count}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{sphere\+\_\+np\+\_\+count()}{sphere\_np\_count()}}
{\footnotesize\ttfamily integer function geometry\+\_\+mod\+::sphere\+\_\+np\+\_\+count (\begin{DoxyParamCaption}\item[{real(prec), intent(in)}]{dp,  }\item[{real(prec), intent(in)}]{r }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



private function that returns the number of points distributed on a grid with spacing dp inside a sphere 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em dp,r} & \\
\hline
\end{DoxyParams}


Definition at line 358 of file geometry.\+f90.


\begin{DoxyCode}
358     \textcolor{keywordtype}{implicit none}
359     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{intent(in)} :: dp
360     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{intent(in)} :: r
361     \textcolor{keywordtype}{integer} :: np
362     \textcolor{keywordtype}{integer} :: i, j, k, n
363     \textcolor{keywordtype}{type}(vector) :: pts
364     np=0
365     n=int(3*r/dp)
366     \textcolor{keywordflow}{do} i=1, n
367         \textcolor{keywordflow}{do} j=1, n
368             \textcolor{keywordflow}{do} k=1, n
369                 pts = dp*(ex*(i-1)+ey*(j-1)+ez*(k-1)) - r*(ex+ey+ez)
370                 \textcolor{keywordflow}{if} (pts%normL2() .le. r) \textcolor{keywordflow}{then}
371                     np=np+1
372 \textcolor{keywordflow}{                end if}
373 \textcolor{keywordflow}{            end do}
374 \textcolor{keywordflow}{        end do}
375 \textcolor{keywordflow}{    end do}
376     \textcolor{keywordflow}{if} (np == 0) \textcolor{keywordflow}{then} \textcolor{comment}{!Just the center point}
377         np=1
378 \textcolor{keywordflow}{    end if}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=346pt]{namespacegeometry__mod_a05de7940b4e7df5a2b31f3d0414e3743_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{namespacegeometry__mod_ad2ad4f7e1138beaad5f37d5c15b7b457}\label{namespacegeometry__mod_ad2ad4f7e1138beaad5f37d5c15b7b457}} 
\index{geometry\+\_\+mod@{geometry\+\_\+mod}!geometry@{geometry}}
\index{geometry@{geometry}!geometry\+\_\+mod@{geometry\+\_\+mod}}
\subsubsection{\texorpdfstring{geometry}{geometry}}
{\footnotesize\ttfamily type(\mbox{\hyperlink{structgeometry__mod_1_1geometry__class}{geometry\+\_\+class}}), public geometry\+\_\+mod\+::geometry}



Definition at line 66 of file geometry.\+f90.


\begin{DoxyCode}
66     \textcolor{keywordtype}{type}(geometry\_class) :: Geometry
\end{DoxyCode}
