\hypertarget{namespacesolver__mod}{}\section{solver\+\_\+mod Module Reference}
\label{namespacesolver__mod}\index{solver\+\_\+mod@{solver\+\_\+mod}}


Defines an Solver class. This class invokes the different available integration algorithms as methods, and these invoke the necessary interpolation objects.  


\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structsolver__mod_1_1solver__class}{solver\+\_\+class}}
\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacesolver__mod_a75c5c8b01ae4ae193ff03dbe7e5fc6af}{runstep}} (self, state, bdata, time, dt)
\begin{DoxyCompactList}\small\item\em Method that integrates the Tracer State Vector in one time-\/step, according to the selected integration algorithm. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesolver__mod_a21533e195501ebb46c1814aeaede4c55}{runstepeuler}} (self, sv, bdata, time, dt)
\begin{DoxyCompactList}\small\item\em Method that integrates the Tracer state array in one time-\/step, using a Velocity Euler integration algorithm. This is a one-\/shot type explicit scheme with low computational cost. Implements $ {\vec {x}}_{t+\Delta t}={\vec {x}}_{t}+{\vec {v}}_{t}\Delta t+{\frac {1}{2}}{\vec {a}}({\vec {x}}_{t})\Delta t^{2}$ $ {\vec {v}}_{t+\Delta t}={\vec {v}}_{t}+\frac{{\vec {a}}_{t+\Delta t}+{\vec {a}}_{t}}{2}\Delta t$. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesolver__mod_a326292ff19880a914317109520b200b2}{initsolver}} (self, flag, name)
\begin{DoxyCompactList}\small\item\em Initializer method for the Solver class. Sets the type of integrator and name of the algorithm this Solver will call. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesolver__mod_a54ea6899cce026a7a5da2dd05922628f}{printsolver}} (self)
\begin{DoxyCompactList}\small\item\em Method that prints the Solver information. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Defines an Solver class. This class invokes the different available integration algorithms as methods, and these invoke the necessary interpolation objects. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas 
\end{DoxyAuthor}


\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacesolver__mod_a326292ff19880a914317109520b200b2}\label{namespacesolver__mod_a326292ff19880a914317109520b200b2}} 
\index{solver\+\_\+mod@{solver\+\_\+mod}!initsolver@{initsolver}}
\index{initsolver@{initsolver}!solver\+\_\+mod@{solver\+\_\+mod}}
\subsubsection{\texorpdfstring{initsolver()}{initsolver()}}
{\footnotesize\ttfamily subroutine solver\+\_\+mod\+::initsolver (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsolver__mod_1_1solver__class}{solver\+\_\+class}}), intent(inout)}]{self,  }\item[{integer, intent(in)}]{flag,  }\item[{type(string), intent(in)}]{name }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Initializer method for the Solver class. Sets the type of integrator and name of the algorithm this Solver will call. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,flag,name} & \\
\hline
\end{DoxyParams}


Definition at line 282 of file solver.\+f90.


\begin{DoxyCode}
282     \textcolor{keywordtype}{class}(solver\_class), \textcolor{keywordtype}{intent(inout)} :: self
283     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: flag
284     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: name
285     \textcolor{keywordtype}{type}(string) :: interpName
286     self%solverType = flag
287     self%name = name   
288     \textcolor{keyword}{call }self%Kernel%initialize()
\end{DoxyCode}
\mbox{\Hypertarget{namespacesolver__mod_a54ea6899cce026a7a5da2dd05922628f}\label{namespacesolver__mod_a54ea6899cce026a7a5da2dd05922628f}} 
\index{solver\+\_\+mod@{solver\+\_\+mod}!printsolver@{printsolver}}
\index{printsolver@{printsolver}!solver\+\_\+mod@{solver\+\_\+mod}}
\subsubsection{\texorpdfstring{printsolver()}{printsolver()}}
{\footnotesize\ttfamily subroutine solver\+\_\+mod\+::printsolver (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsolver__mod_1_1solver__class}{solver\+\_\+class}}), intent(inout)}]{self }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Method that prints the Solver information. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}


Definition at line 297 of file solver.\+f90.


\begin{DoxyCode}
297     \textcolor{keywordtype}{class}(solver\_class), \textcolor{keywordtype}{intent(inout)} :: self
298     \textcolor{keywordtype}{type}(string) :: outext, t
299     outext = \textcolor{stringliteral}{'Solver algorithm is '}//self%name
300     \textcolor{keyword}{call }log%put(outext,.false.)
\end{DoxyCode}
\mbox{\Hypertarget{namespacesolver__mod_a75c5c8b01ae4ae193ff03dbe7e5fc6af}\label{namespacesolver__mod_a75c5c8b01ae4ae193ff03dbe7e5fc6af}} 
\index{solver\+\_\+mod@{solver\+\_\+mod}!runstep@{runstep}}
\index{runstep@{runstep}!solver\+\_\+mod@{solver\+\_\+mod}}
\subsubsection{\texorpdfstring{runstep()}{runstep()}}
{\footnotesize\ttfamily subroutine solver\+\_\+mod\+::runstep (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsolver__mod_1_1solver__class}{solver\+\_\+class}}), intent(inout)}]{self,  }\item[{type(statevector\+\_\+class), dimension(\+:), intent(inout)}]{state,  }\item[{type(\mbox{\hyperlink{structbackground__mod_1_1background__class}{background\+\_\+class}}), dimension(\+:), intent(in)}]{bdata,  }\item[{real(prec), intent(in)}]{time,  }\item[{real(prec), intent(in)}]{dt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Method that integrates the Tracer State Vector in one time-\/step, according to the selected integration algorithm. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,state,bdata,time,dt} & \\
\hline
\end{DoxyParams}


Definition at line 58 of file solver.\+f90.


\begin{DoxyCode}
58     \textcolor{keywordtype}{class}(solver\_class), \textcolor{keywordtype}{intent(inout)} :: self
59     \textcolor{keywordtype}{type}(stateVector\_class), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(inout)} :: state
60     \textcolor{keywordtype}{type}(background\_class), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)} :: bdata
61     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{intent(in)} :: time, dt
62     \textcolor{comment}{!so the forward integrators don't overextend beyond calendar time}
63     \textcolor{keywordflow}{if} (time+dt < globals%Parameters%TimeMax) \textcolor{keywordflow}{then}
64         \textcolor{keywordflow}{if} (self%solverType == 1) \textcolor{keyword}{call }self%runStepEuler(state, bdata, time, dt)
65         \textcolor{comment}{!if (self%solverType == 2) call self%runStepMSEuler(state, bdata, time, dt)}
66         \textcolor{comment}{!if (self%solverType == 3) call self%runStepRK4(state, bdata, time, dt)}
67 \textcolor{keywordflow}{    end if}
\end{DoxyCode}
\mbox{\Hypertarget{namespacesolver__mod_a21533e195501ebb46c1814aeaede4c55}\label{namespacesolver__mod_a21533e195501ebb46c1814aeaede4c55}} 
\index{solver\+\_\+mod@{solver\+\_\+mod}!runstepeuler@{runstepeuler}}
\index{runstepeuler@{runstepeuler}!solver\+\_\+mod@{solver\+\_\+mod}}
\subsubsection{\texorpdfstring{runstepeuler()}{runstepeuler()}}
{\footnotesize\ttfamily subroutine solver\+\_\+mod\+::runstepeuler (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsolver__mod_1_1solver__class}{solver\+\_\+class}}), intent(inout)}]{self,  }\item[{type(statevector\+\_\+class), dimension(\+:), intent(inout)}]{sv,  }\item[{type(\mbox{\hyperlink{structbackground__mod_1_1background__class}{background\+\_\+class}}), dimension(\+:), intent(in)}]{bdata,  }\item[{real(prec), intent(in)}]{time,  }\item[{real(prec), intent(in)}]{dt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Method that integrates the Tracer state array in one time-\/step, using a Velocity Euler integration algorithm. This is a one-\/shot type explicit scheme with low computational cost. Implements $ {\vec {x}}_{t+\Delta t}={\vec {x}}_{t}+{\vec {v}}_{t}\Delta t+{\frac {1}{2}}{\vec {a}}({\vec {x}}_{t})\Delta t^{2}$ $ {\vec {v}}_{t+\Delta t}={\vec {v}}_{t}+\frac{{\vec {a}}_{t+\Delta t}+{\vec {a}}_{t}}{2}\Delta t$. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,state,bdata,time,dt} & \\
\hline
\end{DoxyParams}


Definition at line 81 of file solver.\+f90.


\begin{DoxyCode}
81     \textcolor{keywordtype}{class}(solver\_class), \textcolor{keywordtype}{intent(inout)} :: self
82     \textcolor{keywordtype}{type}(stateVector\_class), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(inout)} :: sv
83     \textcolor{keywordtype}{type}(background\_class), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)} :: bdata
84     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{intent(in)} :: time, dt
85     \textcolor{keywordtype}{integer} :: i
86 
87     \textcolor{keywordflow}{do} i=1, \textcolor{keyword}{size}(sv)
88         sv(i)%state = sv(i)%state + self%Kernel%run(sv(i), bdata, time, dt)*dt
89 \textcolor{keywordflow}{    end do}
90     
\end{DoxyCode}
