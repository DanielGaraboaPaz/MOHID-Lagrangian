\hypertarget{namespacesolver__mod}{}\section{solver\+\_\+mod Module Reference}
\label{namespacesolver__mod}\index{solver\+\_\+mod@{solver\+\_\+mod}}


Defines an Solver class. This class invokes the different available integration algorithms as methods, and these invoke the necessary interpolation objects.  


\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structsolver__mod_1_1solver__class}{solver\+\_\+class}}
\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacesolver__mod_ab87d71c6c8aa1709901ec14f9bf12505}{runstep}} (self, aot, bdata, time, dt)
\begin{DoxyCompactList}\small\item\em Method that integrates the Tracer state array in one time-\/step, according to the selected integration algorithm. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesolver__mod_a91ddfd70d0f6d65b00fe6b08f4113cd6}{runstepsymplectic}} (self, aot, bdata, time, dt)
\begin{DoxyCompactList}\small\item\em Method that integrates the Tracer state array in one time-\/step, using a Symplectic integration algorithm. This is a predictor-\/corrector type explicit scheme with excelent conservation properties and average cost. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesolver__mod_acf893016edd8e0eb4bc77666aed1096f}{runstepverlet}} (self, aot, bdata, time, dt)
\begin{DoxyCompactList}\small\item\em Method that integrates the Tracer state array in one time-\/step, using a Verlet integration algorithm. This is a one-\/shot type explicit scheme with low computational cost, mostly for quick tests and debug. Implements $ {\vec {x}}_{1}={\vec {x}}_{0}+{\vec {v}}_{0}\Delta t+{\frac {1}{2}}{\vec {A}}({\vec {x}}_{0})\Delta t^{2}$. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesolver__mod_ae59da54f053ae369d76f130b3790f3b7}{runsteprk4}} (self, aot, bdata, time, dt)
\begin{DoxyCompactList}\small\item\em Method that integrates the Tracer state array in one time-\/step, using a Runge-\/\+Kuta 4th order integration algorithm. This is an explicit scheme with medium to high computational cost. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesolver__mod_a326292ff19880a914317109520b200b2}{initsolver}} (self, flag, name)
\begin{DoxyCompactList}\small\item\em Initializer method for the Solver class. Sets the type of integrator and name of the algorithm this Solver will call. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesolver__mod_a54ea6899cce026a7a5da2dd05922628f}{printsolver}} (self)
\begin{DoxyCompactList}\small\item\em Method that prints the Solver information. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Defines an Solver class. This class invokes the different available integration algorithms as methods, and these invoke the necessary interpolation objects. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas 
\end{DoxyAuthor}


\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacesolver__mod_a326292ff19880a914317109520b200b2}\label{namespacesolver__mod_a326292ff19880a914317109520b200b2}} 
\index{solver\+\_\+mod@{solver\+\_\+mod}!initsolver@{initsolver}}
\index{initsolver@{initsolver}!solver\+\_\+mod@{solver\+\_\+mod}}
\subsubsection{\texorpdfstring{initsolver()}{initsolver()}}
{\footnotesize\ttfamily subroutine solver\+\_\+mod\+::initsolver (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsolver__mod_1_1solver__class}{solver\+\_\+class}}), intent(inout)}]{self,  }\item[{integer, intent(in)}]{flag,  }\item[{type(string), intent(in)}]{name }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Initializer method for the Solver class. Sets the type of integrator and name of the algorithm this Solver will call. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,flag,name} & \\
\hline
\end{DoxyParams}


Definition at line 139 of file solver.\+f90.


\begin{DoxyCode}
139     \textcolor{keywordtype}{class}(solver\_class), \textcolor{keywordtype}{intent(inout)} :: self
140     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: flag
141     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: name
142     \textcolor{keywordtype}{type}(string) :: interpName
143     self%solverType = flag
144     self%name = name
145     interpname = \textcolor{stringliteral}{'linear'}
146     \textcolor{keyword}{call }self%Interpolator%initialize(1,interpname)
\end{DoxyCode}
\mbox{\Hypertarget{namespacesolver__mod_a54ea6899cce026a7a5da2dd05922628f}\label{namespacesolver__mod_a54ea6899cce026a7a5da2dd05922628f}} 
\index{solver\+\_\+mod@{solver\+\_\+mod}!printsolver@{printsolver}}
\index{printsolver@{printsolver}!solver\+\_\+mod@{solver\+\_\+mod}}
\subsubsection{\texorpdfstring{printsolver()}{printsolver()}}
{\footnotesize\ttfamily subroutine solver\+\_\+mod\+::printsolver (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsolver__mod_1_1solver__class}{solver\+\_\+class}}), intent(inout)}]{self }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Method that prints the Solver information. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}


Definition at line 155 of file solver.\+f90.


\begin{DoxyCode}
155     \textcolor{keywordtype}{class}(solver\_class), \textcolor{keywordtype}{intent(inout)} :: self
156     \textcolor{keywordtype}{type}(string) :: outext, t
157     outext = \textcolor{stringliteral}{'Solver algorithm is '}//self%name
158     \textcolor{keyword}{call }log%put(outext,.false.)
\end{DoxyCode}
\mbox{\Hypertarget{namespacesolver__mod_ab87d71c6c8aa1709901ec14f9bf12505}\label{namespacesolver__mod_ab87d71c6c8aa1709901ec14f9bf12505}} 
\index{solver\+\_\+mod@{solver\+\_\+mod}!runstep@{runstep}}
\index{runstep@{runstep}!solver\+\_\+mod@{solver\+\_\+mod}}
\subsubsection{\texorpdfstring{runstep()}{runstep()}}
{\footnotesize\ttfamily subroutine solver\+\_\+mod\+::runstep (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsolver__mod_1_1solver__class}{solver\+\_\+class}}), intent(inout)}]{self,  }\item[{type(aot\+\_\+class), intent(inout)}]{aot,  }\item[{type(\mbox{\hyperlink{structbackground__mod_1_1background__class}{background\+\_\+class}}), dimension(\+:), intent(in)}]{bdata,  }\item[{real(prec\+\_\+time), intent(in)}]{time,  }\item[{real(prec\+\_\+time), intent(in)}]{dt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Method that integrates the Tracer state array in one time-\/step, according to the selected integration algorithm. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,aot,bdata,dt} & \\
\hline
\end{DoxyParams}


Definition at line 56 of file solver.\+f90.


\begin{DoxyCode}
56     \textcolor{keywordtype}{class}(solver\_class), \textcolor{keywordtype}{intent(inout)} :: self
57     \textcolor{keywordtype}{type}(aot\_class), \textcolor{keywordtype}{intent(inout)} :: aot
58     \textcolor{keywordtype}{type}(background\_class), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)} :: bdata
59     \textcolor{keywordtype}{real(prec\_time)}, \textcolor{keywordtype}{intent(in)} :: time, dt
60     \textcolor{keywordflow}{if} (self%solverType == 2) \textcolor{keyword}{call }self%runStepSymplectic(aot, bdata, time, dt)
61     \textcolor{keywordflow}{if} (self%solverType == 1) \textcolor{keyword}{call }self%runStepVerlet(aot, bdata, time, dt)
62     \textcolor{keywordflow}{if} (self%solverType == 3) \textcolor{keyword}{call }self%runStepRK4(aot, bdata, time, dt)
\end{DoxyCode}
\mbox{\Hypertarget{namespacesolver__mod_ae59da54f053ae369d76f130b3790f3b7}\label{namespacesolver__mod_ae59da54f053ae369d76f130b3790f3b7}} 
\index{solver\+\_\+mod@{solver\+\_\+mod}!runsteprk4@{runsteprk4}}
\index{runsteprk4@{runsteprk4}!solver\+\_\+mod@{solver\+\_\+mod}}
\subsubsection{\texorpdfstring{runsteprk4()}{runsteprk4()}}
{\footnotesize\ttfamily subroutine solver\+\_\+mod\+::runsteprk4 (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsolver__mod_1_1solver__class}{solver\+\_\+class}}), intent(inout)}]{self,  }\item[{type(aot\+\_\+class), intent(inout)}]{aot,  }\item[{type(\mbox{\hyperlink{structbackground__mod_1_1background__class}{background\+\_\+class}}), dimension(\+:), intent(in)}]{bdata,  }\item[{real(prec\+\_\+time), intent(in)}]{time,  }\item[{real(prec\+\_\+time), intent(in)}]{dt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Method that integrates the Tracer state array in one time-\/step, using a Runge-\/\+Kuta 4th order integration algorithm. This is an explicit scheme with medium to high computational cost. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,aot,bdata,dt} & \\
\hline
\end{DoxyParams}


Definition at line 124 of file solver.\+f90.


\begin{DoxyCode}
124     \textcolor{keywordtype}{class}(solver\_class), \textcolor{keywordtype}{intent(inout)} :: self
125     \textcolor{keywordtype}{type}(aot\_class), \textcolor{keywordtype}{intent(inout)} :: aot
126     \textcolor{keywordtype}{type}(background\_class), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)} :: bdata
127     \textcolor{keywordtype}{real(prec\_time)}, \textcolor{keywordtype}{intent(in)} :: time, dt
128 
\end{DoxyCode}
\mbox{\Hypertarget{namespacesolver__mod_a91ddfd70d0f6d65b00fe6b08f4113cd6}\label{namespacesolver__mod_a91ddfd70d0f6d65b00fe6b08f4113cd6}} 
\index{solver\+\_\+mod@{solver\+\_\+mod}!runstepsymplectic@{runstepsymplectic}}
\index{runstepsymplectic@{runstepsymplectic}!solver\+\_\+mod@{solver\+\_\+mod}}
\subsubsection{\texorpdfstring{runstepsymplectic()}{runstepsymplectic()}}
{\footnotesize\ttfamily subroutine solver\+\_\+mod\+::runstepsymplectic (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsolver__mod_1_1solver__class}{solver\+\_\+class}}), intent(inout)}]{self,  }\item[{type(aot\+\_\+class), intent(inout)}]{aot,  }\item[{type(\mbox{\hyperlink{structbackground__mod_1_1background__class}{background\+\_\+class}}), dimension(\+:), intent(in)}]{bdata,  }\item[{real(prec\+\_\+time), intent(in)}]{time,  }\item[{real(prec\+\_\+time), intent(in)}]{dt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Method that integrates the Tracer state array in one time-\/step, using a Symplectic integration algorithm. This is a predictor-\/corrector type explicit scheme with excelent conservation properties and average cost. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,aot,bdata,dt} & \\
\hline
\end{DoxyParams}


Definition at line 74 of file solver.\+f90.


\begin{DoxyCode}
74     \textcolor{keywordtype}{class}(solver\_class), \textcolor{keywordtype}{intent(inout)} :: self
75     \textcolor{keywordtype}{type}(aot\_class), \textcolor{keywordtype}{intent(inout)} :: aot
76     \textcolor{keywordtype}{type}(background\_class), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)} :: bdata
77     \textcolor{keywordtype}{real(prec\_time)}, \textcolor{keywordtype}{intent(in)} :: time, dt
78 
\end{DoxyCode}
\mbox{\Hypertarget{namespacesolver__mod_acf893016edd8e0eb4bc77666aed1096f}\label{namespacesolver__mod_acf893016edd8e0eb4bc77666aed1096f}} 
\index{solver\+\_\+mod@{solver\+\_\+mod}!runstepverlet@{runstepverlet}}
\index{runstepverlet@{runstepverlet}!solver\+\_\+mod@{solver\+\_\+mod}}
\subsubsection{\texorpdfstring{runstepverlet()}{runstepverlet()}}
{\footnotesize\ttfamily subroutine solver\+\_\+mod\+::runstepverlet (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsolver__mod_1_1solver__class}{solver\+\_\+class}}), intent(inout)}]{self,  }\item[{type(aot\+\_\+class), intent(inout)}]{aot,  }\item[{type(\mbox{\hyperlink{structbackground__mod_1_1background__class}{background\+\_\+class}}), dimension(\+:), intent(in)}]{bdata,  }\item[{real(prec\+\_\+time), intent(in)}]{time,  }\item[{real(prec\+\_\+time), intent(in)}]{dt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Method that integrates the Tracer state array in one time-\/step, using a Verlet integration algorithm. This is a one-\/shot type explicit scheme with low computational cost, mostly for quick tests and debug. Implements $ {\vec {x}}_{1}={\vec {x}}_{0}+{\vec {v}}_{0}\Delta t+{\frac {1}{2}}{\vec {A}}({\vec {x}}_{0})\Delta t^{2}$. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,aot,bdata,dt} & \\
\hline
\end{DoxyParams}


Definition at line 92 of file solver.\+f90.


\begin{DoxyCode}
92     \textcolor{keywordtype}{class}(solver\_class), \textcolor{keywordtype}{intent(inout)} :: self
93     \textcolor{keywordtype}{type}(aot\_class), \textcolor{keywordtype}{intent(inout)} :: aot
94     \textcolor{keywordtype}{type}(background\_class), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)} :: bdata
95     \textcolor{keywordtype}{real(prec\_time)}, \textcolor{keywordtype}{intent(in)} :: time, dt
96     \textcolor{keywordtype}{integer} :: np, nf, bkg
97     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{dimension(:,:)}, \textcolor{keywordtype}{allocatable} :: var\_dt
98 
99     \textcolor{comment}{! interpolate each background}
100     \textcolor{keywordflow}{do} bkg = 1, \textcolor{keyword}{size}(bdata)
101         np = \textcolor{keyword}{size}(aot%id)
102         nf = bdata(bkg)%fields%getSize()
103         \textcolor{keyword}{allocate}(var\_dt(np,nf))
104         \textcolor{keyword}{call }self%Interpolator%run(aot, bdata(bkg), time, var\_dt)
105         \textcolor{comment}{!put the interpolated vars from var\_dt back into the AoT}
106 \textcolor{keywordflow}{    end do}
107 
108     \textcolor{comment}{!now that we interpolated the variables, we need to know what to do with them.}
109     \textcolor{comment}{!need to find a way to save velocity to velocity and temperature to temperature.}
110     \textcolor{comment}{!list with vars to interpolate from input xml, and config xml with standard}
111     \textcolor{comment}{!netcdf name overrides is needed for specific institution files?}
112 
\end{DoxyCode}
