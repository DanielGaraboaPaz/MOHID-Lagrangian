\hypertarget{namespacesimulationinitialize__mod}{}\section{simulationinitialize\+\_\+mod Module Reference}
\label{namespacesimulationinitialize__mod}\index{simulationinitialize\+\_\+mod@{simulationinitialize\+\_\+mod}}


Module with the simulation initialization related definitions and methods. Has one public access routine that is incharge of building the simulation space from input files.  


\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacesimulationinitialize__mod_aa4c1099b84c9901ab1286a3796a54f71}{linkpropertysources}} (links\+Node)
\begin{DoxyCompactList}\small\item\em Private property xml parser routine. Reads the properties tab from the xml file and links these to the corresponding Source. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesimulationinitialize__mod_a532cb4960e93dc27cff5dc2e04afe070}{init\+\_\+properties}} (case\+\_\+node)
\begin{DoxyCompactList}\small\item\em Private property xml parser routine. Reads the properties tab from the xml file and links these to the corresponding source. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesimulationinitialize__mod_a4909cc4cb57549e6eed3f69d6dfa30b5}{init\+\_\+naming}} (case\+\_\+node)
\begin{DoxyCompactList}\small\item\em naming xml parser routine. Reads the naming file(s), opens the file(s) and stores the naming conventions for input files \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesimulationinitialize__mod_ab65ac868a57f2cc124ec29f87a239424}{read\+\_\+xml\+\_\+geometry}} (source, source\+\_\+detail, source\+\_\+shape)
\begin{DoxyCompactList}\small\item\em Private geometry xml parser routine. Reads a geometry from the xml depending on the geometry type of the node. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesimulationinitialize__mod_acaa6b217159e3a10e7db04dd7b0e4058}{init\+\_\+sources}} (case\+\_\+node)
\begin{DoxyCompactList}\small\item\em Private source definitions parser routine. Builds the tracer sources from the input xml case file. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesimulationinitialize__mod_af6b2508d52e9e29aeb6e7dfbabd88e8d}{init\+\_\+simdefs}} (case\+\_\+node)
\begin{DoxyCompactList}\small\item\em Private simulation definitions parser routine. Builds the simulation geometric space from the input xml case file. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesimulationinitialize__mod_ae41256ca5e72ebf27660ffdfe5c08e46}{init\+\_\+caseconstants}} (case\+\_\+node)
\begin{DoxyCompactList}\small\item\em Private case constant parser routine. Builds the simulation parametric space from the input xml case file. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesimulationinitialize__mod_a0b32e8c950fc615198d1e47ba1d36cd6}{init\+\_\+parameters}} (execution\+\_\+node)
\begin{DoxyCompactList}\small\item\em Private parameter parser routine. Builds the simulation parametric space from the input xml case file. \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacesimulationinitialize__mod_ada0310fe0d45fa2eec30deaf3ad25ba7}{initfromxml}} (xmlfilename)
\begin{DoxyCompactList}\small\item\em Public xml parser routine. Builds the simulation space from the input xml case file. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Module with the simulation initialization related definitions and methods. Has one public access routine that is incharge of building the simulation space from input files. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas 
\end{DoxyAuthor}


\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacesimulationinitialize__mod_ae41256ca5e72ebf27660ffdfe5c08e46}\label{namespacesimulationinitialize__mod_ae41256ca5e72ebf27660ffdfe5c08e46}} 
\index{simulationinitialize\+\_\+mod@{simulationinitialize\+\_\+mod}!init\+\_\+caseconstants@{init\+\_\+caseconstants}}
\index{init\+\_\+caseconstants@{init\+\_\+caseconstants}!simulationinitialize\+\_\+mod@{simulationinitialize\+\_\+mod}}
\subsubsection{\texorpdfstring{init\+\_\+caseconstants()}{init\_caseconstants()}}
{\footnotesize\ttfamily subroutine simulationinitialize\+\_\+mod\+::init\+\_\+caseconstants (\begin{DoxyParamCaption}\item[{type(node), intent(in), pointer}]{case\+\_\+node }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Private case constant parser routine. Builds the simulation parametric space from the input xml case file. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em case\+\_\+node} & \\
\hline
\end{DoxyParams}


Definition at line 360 of file simulation\+Initialize.\+f90.


\begin{DoxyCode}
360     \textcolor{keywordtype}{implicit none}
361     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{pointer} :: case\_node
362 
363     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{pointer} :: constants\_node
364     \textcolor{keywordtype}{type}(string) :: outext
365     \textcolor{keywordtype}{type}(string) :: tag, att\_name, att\_val
366     \textcolor{keywordtype}{type}(vector) :: coords
367     \textcolor{keywordtype}{logical} :: readflag
368 
369     outext=\textcolor{stringliteral}{'-->Reading case constants'}
370     \textcolor{keyword}{call }log%put(outext,.false.)
371 
372     tag=\textcolor{stringliteral}{"constantsdef"}    \textcolor{comment}{!the node we want}
373     \textcolor{keyword}{call }xmlreader%gotoNode(case\_node,constants\_node,tag,readflag,.false.)
374     \textcolor{keywordflow}{if} (readflag) \textcolor{keywordflow}{then} \textcolor{comment}{!if the node exists, since his one is not mandatory}
375         tag=\textcolor{stringliteral}{"Gravity"}
376         \textcolor{keyword}{call }xmlreader%getNodeVector(constants\_node,tag,coords,readflag,.false.)
377         \textcolor{keywordflow}{if} (readflag) \textcolor{keywordflow}{then}
378             \textcolor{keyword}{call }globals%Constants%setgravity(coords)
379 \textcolor{keywordflow}{        endif}
380         tag=\textcolor{stringliteral}{"Z0"}
381         att\_name=\textcolor{stringliteral}{"value"}
382         \textcolor{keyword}{call }xmlreader%getNodeAttribute(constants\_node, tag, att\_name, att\_val,readflag,.false.)
383         \textcolor{keywordflow}{if} (readflag) \textcolor{keywordflow}{then}
384             \textcolor{keyword}{call }globals%Constants%setz0(att\_val)
385 \textcolor{keywordflow}{        endif}
386         tag=\textcolor{stringliteral}{"RhoRef"}
387         att\_name=\textcolor{stringliteral}{"value"}
388         \textcolor{keyword}{call }xmlreader%getNodeAttribute(constants\_node, tag, att\_name, att\_val,readflag,.false.)
389         \textcolor{keywordflow}{if} (readflag) \textcolor{keywordflow}{then}
390             \textcolor{keyword}{call }globals%Constants%setrho(att\_val)
391 \textcolor{keywordflow}{        endif}
392         tag=\textcolor{stringliteral}{"BeachingLevel"}
393         att\_name=\textcolor{stringliteral}{"value"}
394         \textcolor{keyword}{call }xmlreader%getNodeAttribute(constants\_node, tag, att\_name, att\_val,readflag,.false.)
395         \textcolor{keywordflow}{if} (readflag) \textcolor{keywordflow}{then}
396             \textcolor{keyword}{call }globals%Constants%setBeachingLevel(att\_val)
397 \textcolor{keywordflow}{        endif}
398 \textcolor{keywordflow}{    endif}
399     \textcolor{keyword}{call }globals%Constants%print()
400 
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesimulationinitialize__mod_ae41256ca5e72ebf27660ffdfe5c08e46_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesimulationinitialize__mod_a4909cc4cb57549e6eed3f69d6dfa30b5}\label{namespacesimulationinitialize__mod_a4909cc4cb57549e6eed3f69d6dfa30b5}} 
\index{simulationinitialize\+\_\+mod@{simulationinitialize\+\_\+mod}!init\+\_\+naming@{init\+\_\+naming}}
\index{init\+\_\+naming@{init\+\_\+naming}!simulationinitialize\+\_\+mod@{simulationinitialize\+\_\+mod}}
\subsubsection{\texorpdfstring{init\+\_\+naming()}{init\_naming()}}
{\footnotesize\ttfamily subroutine simulationinitialize\+\_\+mod\+::init\+\_\+naming (\begin{DoxyParamCaption}\item[{type(node), intent(in), pointer}]{case\+\_\+node }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



naming xml parser routine. Reads the naming file(s), opens the file(s) and stores the naming conventions for input files 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em case\+\_\+node} & \\
\hline
\end{DoxyParams}


Definition at line 148 of file simulation\+Initialize.\+f90.


\begin{DoxyCode}
148     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{pointer} :: case\_node
149 
150     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{pointer} :: naming\_node
151     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{pointer} :: temp
152     \textcolor{keywordtype}{type}(NodeList), \textcolor{keywordtype}{pointer} :: namingfileList
153     \textcolor{keywordtype}{type}(string) :: outext
154     \textcolor{keywordtype}{type}(string) :: tag, att\_name
155     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{dimension(:)} :: namingFilename
156     \textcolor{keywordtype}{integer} :: i
157 
158     tag=\textcolor{stringliteral}{"variableNaming"}    \textcolor{comment}{!the node we want}
159     \textcolor{keyword}{call }xmlreader%gotoNode(case\_node,naming\_node,tag,mandatory =.false.)
160     \textcolor{keywordflow}{if} (\textcolor{keyword}{associated}(naming\_node)) \textcolor{keywordflow}{then}
161         namingfilelist => getelementsbytagname(naming\_node, \textcolor{stringliteral}{"file"})       \textcolor{comment}{!searching for tags with the
       'namingfile' name}
162         \textcolor{keyword}{allocate}(namingfilename(getlength(namingfilelist)))
163         \textcolor{keywordflow}{do} i = 0, getlength(namingfilelist) - 1
164             temp => item(namingfilelist, i)
165             att\_name=\textcolor{stringliteral}{"name"}
166             \textcolor{keyword}{call }xmlreader%getLeafAttribute(temp,att\_name,namingfilename(i+1))
167 \textcolor{keywordflow}{        end do}
168         \textcolor{keyword}{call }globals%setNamingConventions(namingfilename)
169     \textcolor{keywordflow}{else}
170         outext=\textcolor{stringliteral}{'-->No naming files, assuming basic naming settings for variables from input files'}
171         \textcolor{keyword}{call }log%put(outext,.false.)
172 \textcolor{keywordflow}{    endif}
173 
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesimulationinitialize__mod_a4909cc4cb57549e6eed3f69d6dfa30b5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesimulationinitialize__mod_a0b32e8c950fc615198d1e47ba1d36cd6}\label{namespacesimulationinitialize__mod_a0b32e8c950fc615198d1e47ba1d36cd6}} 
\index{simulationinitialize\+\_\+mod@{simulationinitialize\+\_\+mod}!init\+\_\+parameters@{init\+\_\+parameters}}
\index{init\+\_\+parameters@{init\+\_\+parameters}!simulationinitialize\+\_\+mod@{simulationinitialize\+\_\+mod}}
\subsubsection{\texorpdfstring{init\+\_\+parameters()}{init\_parameters()}}
{\footnotesize\ttfamily subroutine simulationinitialize\+\_\+mod\+::init\+\_\+parameters (\begin{DoxyParamCaption}\item[{type(node), intent(in), pointer}]{execution\+\_\+node }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Private parameter parser routine. Builds the simulation parametric space from the input xml case file. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em execution\+\_\+node} & \\
\hline
\end{DoxyParams}


Definition at line 410 of file simulation\+Initialize.\+f90.


\begin{DoxyCode}
410     \textcolor{keywordtype}{implicit none}
411     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{pointer} :: execution\_node
412 
413     \textcolor{keywordtype}{type}(string) :: outext
414     \textcolor{keywordtype}{type}(NodeList), \textcolor{keywordtype}{pointer} :: parameterList
415     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{pointer} :: parmt, parameters\_node
416     \textcolor{keywordtype}{integer} :: i
417     \textcolor{keywordtype}{type}(string) :: parmkey, parmvalue, tag, att\_name
418 
419     outext=\textcolor{stringliteral}{'-->Reading case parameters'}
420     \textcolor{keyword}{call }log%put(outext,.false.)
421 
422     tag=\textcolor{stringliteral}{"parameters"}    \textcolor{comment}{!the node we want}
423     \textcolor{keyword}{call }xmlreader%gotoNode(execution\_node,parameters\_node,tag)
424     parameterlist => getelementsbytagname(parameters\_node, \textcolor{stringliteral}{"parameter"})       \textcolor{comment}{!searching for tags with the
       'parameter' name}
425     \textcolor{keywordflow}{do} i = 0, getlength(parameterlist) - 1                          \textcolor{comment}{!extracting parameter tags one by one}
426         parmt => item(parameterlist, i)
427         att\_name=\textcolor{stringliteral}{"key"}
428         \textcolor{keyword}{call }xmlreader%getLeafAttribute(parmt,att\_name,parmkey)
429         att\_name=\textcolor{stringliteral}{"value"}
430         \textcolor{keyword}{call }xmlreader%getLeafAttribute(parmt,att\_name,parmvalue)
431         \textcolor{keyword}{call }globals%Parameters%setParam(parmkey,parmvalue)
432 \textcolor{keywordflow}{    end do}
433     \textcolor{keyword}{call }globals%Parameters%check()
434     \textcolor{keyword}{call }globals%Parameters%print()
435     
436     \textcolor{keyword}{call }globals%setTimeDate()
437     \textcolor{keyword}{call }globals%SimTime%print()
438 
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesimulationinitialize__mod_a0b32e8c950fc615198d1e47ba1d36cd6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesimulationinitialize__mod_a532cb4960e93dc27cff5dc2e04afe070}\label{namespacesimulationinitialize__mod_a532cb4960e93dc27cff5dc2e04afe070}} 
\index{simulationinitialize\+\_\+mod@{simulationinitialize\+\_\+mod}!init\+\_\+properties@{init\+\_\+properties}}
\index{init\+\_\+properties@{init\+\_\+properties}!simulationinitialize\+\_\+mod@{simulationinitialize\+\_\+mod}}
\subsubsection{\texorpdfstring{init\+\_\+properties()}{init\_properties()}}
{\footnotesize\ttfamily subroutine simulationinitialize\+\_\+mod\+::init\+\_\+properties (\begin{DoxyParamCaption}\item[{type(node), intent(in), pointer}]{case\+\_\+node }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Private property xml parser routine. Reads the properties tab from the xml file and links these to the corresponding source. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em case\+\_\+node} & \\
\hline
\end{DoxyParams}


Definition at line 116 of file simulation\+Initialize.\+f90.


\begin{DoxyCode}
116     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{pointer} :: case\_node
117 
118     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{pointer} :: props\_node
119     \textcolor{keywordtype}{type}(string) :: outext
120     \textcolor{keywordtype}{type}(string) :: tag, att\_name
121 
122     tag=\textcolor{stringliteral}{"sourceTypes"}    \textcolor{comment}{!the node we want}
123     \textcolor{keyword}{call }xmlreader%gotoNode(case\_node,props\_node,tag,mandatory =.false.)
124     \textcolor{keywordflow}{if} (\textcolor{keyword}{associated}(props\_node)) \textcolor{keywordflow}{then}
125         tag=\textcolor{stringliteral}{"file"}
126         att\_name=\textcolor{stringliteral}{"name"}
127         \textcolor{keyword}{call }xmlreader%getNodeAttribute(props\_node, tag, att\_name, globals%Names%propsxmlfilename) \textcolor{comment}{!getting
       the file name from that tag}
128         outext=\textcolor{stringliteral}{'-->Properties to link to Sources found at '}//globals%Names%propsxmlfilename
129         \textcolor{keyword}{call }log%put(outext,.false.)
130         tag=\textcolor{stringliteral}{"types"}
131         \textcolor{keyword}{call }xmlreader%gotoNode(props\_node,props\_node,tag) \textcolor{comment}{!getting the links node}
132         \textcolor{keyword}{call }linkpropertysources(props\_node)          \textcolor{comment}{!calling the property linker}
133     \textcolor{keywordflow}{else}
134         outext=\textcolor{stringliteral}{'-->No properties to link to Sources, assuming pure Lagrangian tracers'}
135         \textcolor{keyword}{call }log%put(outext,.false.)
136 \textcolor{keywordflow}{    endif}
137 
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesimulationinitialize__mod_a532cb4960e93dc27cff5dc2e04afe070_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesimulationinitialize__mod_a532cb4960e93dc27cff5dc2e04afe070_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesimulationinitialize__mod_af6b2508d52e9e29aeb6e7dfbabd88e8d}\label{namespacesimulationinitialize__mod_af6b2508d52e9e29aeb6e7dfbabd88e8d}} 
\index{simulationinitialize\+\_\+mod@{simulationinitialize\+\_\+mod}!init\+\_\+simdefs@{init\+\_\+simdefs}}
\index{init\+\_\+simdefs@{init\+\_\+simdefs}!simulationinitialize\+\_\+mod@{simulationinitialize\+\_\+mod}}
\subsubsection{\texorpdfstring{init\+\_\+simdefs()}{init\_simdefs()}}
{\footnotesize\ttfamily subroutine simulationinitialize\+\_\+mod\+::init\+\_\+simdefs (\begin{DoxyParamCaption}\item[{type(node), intent(in), pointer}]{case\+\_\+node }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Private simulation definitions parser routine. Builds the simulation geometric space from the input xml case file. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em case\+\_\+node} & \\
\hline
\end{DoxyParams}


Definition at line 320 of file simulation\+Initialize.\+f90.


\begin{DoxyCode}
320     \textcolor{keywordtype}{implicit none}
321     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{pointer} :: case\_node
322 
323     \textcolor{keywordtype}{type}(NodeList), \textcolor{keywordtype}{pointer} :: defsList
324     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{pointer} :: simdefs\_node
325     \textcolor{keywordtype}{type}(string) :: outext
326     \textcolor{keywordtype}{integer} :: i
327     \textcolor{keywordtype}{type}(string) :: pts(2), tag, att\_name, att\_val
328     \textcolor{keywordtype}{type}(vector) :: coords
329 
330     outext=\textcolor{stringliteral}{'-->Reading case simulation definitions'}
331     \textcolor{keyword}{call }log%put(outext,.false.)
332 
333     tag=\textcolor{stringliteral}{"simulation"}    \textcolor{comment}{!the node we want}
334     \textcolor{keyword}{call }xmlreader%gotoNode(case\_node,simdefs\_node,tag)
335     tag=\textcolor{stringliteral}{"resolution"}
336     att\_name=\textcolor{stringliteral}{"dp"}
337     \textcolor{keyword}{call }xmlreader%getNodeAttribute(simdefs\_node, tag, att\_name, att\_val)
338     \textcolor{keyword}{call }globals%SimDefs%setdp(att\_val)
339     tag=\textcolor{stringliteral}{"timestep"}
340     att\_name=\textcolor{stringliteral}{"dt"}
341     \textcolor{keyword}{call }xmlreader%getNodeAttribute(simdefs\_node, tag, att\_name, att\_val)
342     \textcolor{keyword}{call }globals%SimDefs%setdt(att\_val)
343     \textcolor{keyword}{call }globals%Constants%setSmallDt(globals%SimDefs%dt)
344     pts=(/ \textcolor{stringliteral}{'BoundingBoxMin'}, \textcolor{stringliteral}{'BoundingBoxMax'}/) \textcolor{comment}{!strings to search for}
345     \textcolor{keywordflow}{do} i=1, \textcolor{keyword}{size}(pts)
346         \textcolor{keyword}{call }xmlreader%getNodeVector(simdefs\_node, pts(i), coords)
347         \textcolor{keyword}{call }globals%SimDefs%setboundingbox(pts(i), coords)
348 \textcolor{keywordflow}{    enddo}
349     \textcolor{keyword}{call }globals%SimDefs%print()
350 
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesimulationinitialize__mod_af6b2508d52e9e29aeb6e7dfbabd88e8d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesimulationinitialize__mod_acaa6b217159e3a10e7db04dd7b0e4058}\label{namespacesimulationinitialize__mod_acaa6b217159e3a10e7db04dd7b0e4058}} 
\index{simulationinitialize\+\_\+mod@{simulationinitialize\+\_\+mod}!init\+\_\+sources@{init\+\_\+sources}}
\index{init\+\_\+sources@{init\+\_\+sources}!simulationinitialize\+\_\+mod@{simulationinitialize\+\_\+mod}}
\subsubsection{\texorpdfstring{init\+\_\+sources()}{init\_sources()}}
{\footnotesize\ttfamily subroutine simulationinitialize\+\_\+mod\+::init\+\_\+sources (\begin{DoxyParamCaption}\item[{type(node), intent(in), pointer}]{case\+\_\+node }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Private source definitions parser routine. Builds the tracer sources from the input xml case file. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em case\+\_\+node} & \\
\hline
\end{DoxyParams}


Definition at line 223 of file simulation\+Initialize.\+f90.


\begin{DoxyCode}
223     \textcolor{keywordtype}{implicit none}
224     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{pointer} :: case\_node
225     \textcolor{keywordtype}{type}(string) :: outext
226     \textcolor{keywordtype}{type}(NodeList), \textcolor{keywordtype}{pointer} :: sourceList
227     \textcolor{keywordtype}{type}(NodeList), \textcolor{keywordtype}{pointer} :: sourceChildren
228     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{pointer} :: sourcedef
229     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{pointer} :: source\_node
230     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{pointer} :: source\_detail
231     \textcolor{keywordtype}{integer} :: i, j
232     \textcolor{keywordtype}{logical} :: readflag
233     \textcolor{keywordtype}{integer} :: id
234     \textcolor{keywordtype}{type}(string) :: name, source\_geometry, tag, att\_name, att\_val, rate\_file
235     \textcolor{keywordtype}{real(prec)} :: emitting\_rate, start, finish
236     \textcolor{keywordtype}{logical} :: emitting\_fixed
237     \textcolor{keywordtype}{class}(shape), \textcolor{keywordtype}{allocatable} :: source\_shape
238 
239     rate\_file = \textcolor{stringliteral}{'not\_set'}
240     readflag = .false.
241     outext=\textcolor{stringliteral}{'-->Reading case Sources'}
242     \textcolor{keyword}{call }log%put(outext,.false.)
243     tag=\textcolor{stringliteral}{"sourceDefinitions"}    \textcolor{comment}{!the node we want}
244     \textcolor{keyword}{call }xmlreader%gotoNode(case\_node,sourcedef,tag)
245     sourcelist => getelementsbytagname(sourcedef, \textcolor{stringliteral}{"source"})
246     \textcolor{comment}{!allocating the temporary source objects}
247     \textcolor{keyword}{call }tempsources%initialize(getlength(sourcelist))
248 
249     \textcolor{keywordflow}{do} j = 0, getlength(sourcelist) - 1
250         source\_node => item(sourcelist,j)
251         tag=\textcolor{stringliteral}{"setsource"}
252         att\_name=\textcolor{stringliteral}{"id"}
253         \textcolor{keyword}{call }xmlreader%getNodeAttribute(source\_node, tag, att\_name, att\_val)
254         id=att\_val%to\_number(kind=1\_i1p)
255         att\_name=\textcolor{stringliteral}{"name"}
256         \textcolor{keyword}{call }xmlreader%getNodeAttribute(source\_node, tag, att\_name, name)
257         \textcolor{comment}{!reading emission rate, need to check for options}
258         tag=\textcolor{stringliteral}{"rate\_dt"}
259         att\_name=\textcolor{stringliteral}{"value"}
260         \textcolor{keyword}{call }xmlreader%getNodeAttribute(source\_node, tag, att\_name, att\_val,readflag,.false.)
261         \textcolor{keywordflow}{if} (readflag) \textcolor{keywordflow}{then}
262             emitting\_rate = 1.0/(att\_val%to\_number(kind=1.\_r4p)*globals%SimDefs%dt)
263             emitting\_fixed = .true.
264 \textcolor{keywordflow}{        end if}
265         tag=\textcolor{stringliteral}{"rate"}
266         att\_name=\textcolor{stringliteral}{"value"}
267         \textcolor{keyword}{call }xmlreader%getNodeAttribute(source\_node, tag, att\_name, att\_val,readflag,.false.)
268         \textcolor{keywordflow}{if} (readflag) \textcolor{keywordflow}{then}
269             emitting\_rate = att\_val%to\_number(kind=1.\_r4p)
270             emitting\_fixed = .true.
271 \textcolor{keywordflow}{        end if}
272         tag=\textcolor{stringliteral}{"rate\_file"}
273         att\_name=\textcolor{stringliteral}{"name"}
274         \textcolor{keyword}{call }xmlreader%getNodeAttribute(source\_node, tag, att\_name, att\_val,readflag,.false.)
275         \textcolor{keywordflow}{if} (readflag) \textcolor{keywordflow}{then}
276             rate\_file = att\_val
277             emitting\_fixed = .false.
278 \textcolor{keywordflow}{        end if}
279         tag=\textcolor{stringliteral}{"active"}
280         att\_name=\textcolor{stringliteral}{"start"}
281         \textcolor{keyword}{call }xmlreader%getNodeAttribute(source\_node, tag, att\_name, att\_val,readflag,.false.)
282         \textcolor{keywordflow}{if} (readflag) \textcolor{keywordflow}{then}
283             start = att\_val%to\_number(kind=1.\_r4p)
284         \textcolor{keywordflow}{else}
285             start = 0.0
286 \textcolor{keywordflow}{        end if}
287         att\_name=\textcolor{stringliteral}{"end"}
288         \textcolor{keyword}{call }xmlreader%getNodeAttribute(source\_node, tag, att\_name, att\_val,readflag,.false.)
289         \textcolor{keywordflow}{if} (readflag.and.att\_val%is\_number()) \textcolor{keywordflow}{then}
290             finish = att\_val%to\_number(kind=1.\_r4p)
291         \textcolor{keywordflow}{else}
292             finish = globals%Parameters%TimeMax
293 \textcolor{keywordflow}{        end if}
294         \textcolor{comment}{!now we need to find out the geometry of the source and read accordingly}
295         sourcechildren => getchildnodes(source\_node) \textcolor{comment}{!getting all of the nodes bellow the main source node
       (all of it's private info)}
296         \textcolor{keywordflow}{do} i=0, getlength(sourcechildren)-1
297             source\_detail => item(sourcechildren,i) \textcolor{comment}{!grabing a node}
298             source\_geometry = getlocalname(source\_detail)  \textcolor{comment}{!finding its name}
299             \textcolor{keywordflow}{if} (geometry%inlist(source\_geometry)) \textcolor{keywordflow}{then}  \textcolor{comment}{!if the node is a valid geometry name}
300                 \textcolor{keyword}{call }geometry%allocateShape(source\_geometry,source\_shape)                
301                 \textcolor{keyword}{call }read\_xml\_geometry(source\_node,source\_detail,source\_shape)
302                 \textcolor{keywordflow}{exit}
303 \textcolor{keywordflow}{            end if}
304 \textcolor{keywordflow}{        end do}
305         \textcolor{comment}{!initializing Source j}
306         \textcolor{keyword}{call }tempsources%src(j+1)%initialize(id,name,emitting\_rate,emitting\_fixed,rate\_file,start,finish,
      source\_geometry,source\_shape)
307 
308         \textcolor{keyword}{deallocate}(source\_shape)
309 \textcolor{keywordflow}{    enddo}
310 
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=347pt]{namespacesimulationinitialize__mod_acaa6b217159e3a10e7db04dd7b0e4058_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesimulationinitialize__mod_acaa6b217159e3a10e7db04dd7b0e4058_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesimulationinitialize__mod_ada0310fe0d45fa2eec30deaf3ad25ba7}\label{namespacesimulationinitialize__mod_ada0310fe0d45fa2eec30deaf3ad25ba7}} 
\index{simulationinitialize\+\_\+mod@{simulationinitialize\+\_\+mod}!initfromxml@{initfromxml}}
\index{initfromxml@{initfromxml}!simulationinitialize\+\_\+mod@{simulationinitialize\+\_\+mod}}
\subsubsection{\texorpdfstring{initfromxml()}{initfromxml()}}
{\footnotesize\ttfamily subroutine, public simulationinitialize\+\_\+mod\+::initfromxml (\begin{DoxyParamCaption}\item[{type(string), intent(in)}]{xmlfilename }\end{DoxyParamCaption})}



Public xml parser routine. Builds the simulation space from the input xml case file. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em xmlfilename} & \\
\hline
\mbox{\tt in}  & {\em xmlfilename} & .xml file name \\
\hline
\end{DoxyParams}


Definition at line 448 of file simulation\+Initialize.\+f90.


\begin{DoxyCode}
448     \textcolor{keywordtype}{implicit none}
449     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: xmlfilename
450     \textcolor{keywordtype}{type}(string) :: outext, tag
451     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{pointer} :: xmldoc
452     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{pointer} :: case\_node
453     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{pointer} :: execution\_node
454 
455     \textcolor{keyword}{call }xmlreader%getFile(xmldoc,xmlfilename)
456     globals%Names%mainxmlfilename = xmlfilename
457     globals%Names%casename = xmlfilename%basename(extension=\textcolor{stringliteral}{'.xml'})
458     outext=\textcolor{stringliteral}{'->Case name is '}//globals%Names%casename
459     \textcolor{keyword}{call }log%put(outext)
460     globals%Names%inputsXmlFilename = globals%Names%outpath//xmlfilename%basename(extension=\textcolor{stringliteral}{'.xml'})//\textcolor{stringliteral}{
      '\_inputs.xml'}
461     outext=\textcolor{stringliteral}{'->Input files index file name is '}//globals%Names%inputsXmlFilename
462     \textcolor{keyword}{call }log%put(outext)
463 
464     tag=\textcolor{stringliteral}{"case"}          \textcolor{comment}{!base document node}
465     \textcolor{keyword}{call }xmlreader%gotoNode(xmldoc,execution\_node,tag)
466     tag=\textcolor{stringliteral}{"execution"}     \textcolor{comment}{!finding execution node}
467     \textcolor{keyword}{call }xmlreader%gotoNode(execution\_node,execution\_node,tag)
468     tag=\textcolor{stringliteral}{"case"}          \textcolor{comment}{!base document node}
469     \textcolor{keyword}{call }xmlreader%gotoNode(xmldoc,case\_node,tag)
470     tag=\textcolor{stringliteral}{"caseDefinitions"}     \textcolor{comment}{!finding execution node}
471     \textcolor{keyword}{call }xmlreader%gotoNode(case\_node,case\_node,tag)
472 
473     \textcolor{comment}{! building the simulation basic structures according to the case definition file}
474     \textcolor{comment}{! every other structure in the simulation is built from these, i.e., not defined by the user directly}
475     \textcolor{keyword}{call }init\_parameters(execution\_node)
476     \textcolor{keyword}{call }init\_caseconstants(case\_node)
477     \textcolor{keyword}{call }init\_simdefs(case\_node)
478     \textcolor{keyword}{call }init\_sources(case\_node)
479     \textcolor{keyword}{call }init\_properties(case\_node)
480     \textcolor{keyword}{call }init\_naming(case\_node)
481 
482     \textcolor{comment}{!setting the number of blocks to the correct ammount of selected threads}
483     globals%SimDefs%numblocks = globals%Parameters%numOPMthreads
484 
485     \textcolor{keyword}{call }xmlreader%closeFile(xmldoc)
486 
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesimulationinitialize__mod_ada0310fe0d45fa2eec30deaf3ad25ba7_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesimulationinitialize__mod_ada0310fe0d45fa2eec30deaf3ad25ba7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesimulationinitialize__mod_aa4c1099b84c9901ab1286a3796a54f71}\label{namespacesimulationinitialize__mod_aa4c1099b84c9901ab1286a3796a54f71}} 
\index{simulationinitialize\+\_\+mod@{simulationinitialize\+\_\+mod}!linkpropertysources@{linkpropertysources}}
\index{linkpropertysources@{linkpropertysources}!simulationinitialize\+\_\+mod@{simulationinitialize\+\_\+mod}}
\subsubsection{\texorpdfstring{linkpropertysources()}{linkpropertysources()}}
{\footnotesize\ttfamily subroutine simulationinitialize\+\_\+mod\+::linkpropertysources (\begin{DoxyParamCaption}\item[{type(node), intent(in), pointer}]{links\+Node }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Private property xml parser routine. Reads the properties tab from the xml file and links these to the corresponding Source. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em links\+Node} & \\
\hline
\end{DoxyParams}


Definition at line 47 of file simulation\+Initialize.\+f90.


\begin{DoxyCode}
47     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{pointer} :: linksNode
48 
49     \textcolor{keywordtype}{type}(NodeList), \textcolor{keywordtype}{pointer} :: linkList
50     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{pointer} :: anode
51     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{pointer} :: xmlProps
52     \textcolor{keywordtype}{type}(string) :: xmlfilename, outext
53     \textcolor{keywordtype}{integer} :: i, p
54     \textcolor{keywordtype}{type}(string) :: att\_name, att\_val, tag
55     \textcolor{keywordtype}{type}(string) :: sourceid, sourcetype, sourceprop
56 
57     linklist => getelementsbytagname(linksnode, \textcolor{stringliteral}{"type"})
58     \textcolor{keywordflow}{do} i = 0, getlength(linklist) - 1
59         anode => item(linklist,i)
60         att\_name=\textcolor{stringliteral}{"source"}
61         \textcolor{keyword}{call }xmlreader%getLeafAttribute(anode,att\_name,sourceid)
62         att\_name=\textcolor{stringliteral}{"type"}
63         \textcolor{keyword}{call }xmlreader%getLeafAttribute(anode,att\_name,sourcetype)
64         att\_name=\textcolor{stringliteral}{"property"}
65         \textcolor{keyword}{call }xmlreader%getLeafAttribute(anode,att\_name,sourceprop)
66         \textcolor{comment}{!find the source and save the type and property name}
67         \textcolor{keyword}{call }tempsources%setPropertyNames(sourceid,sourcetype,sourceprop)
68 \textcolor{keywordflow}{    enddo}
69 
70     \textcolor{comment}{!parse the properties file}
71     xmlfilename = globals%Names%propsxmlfilename
72     \textcolor{keyword}{call }xmlreader%getFile(xmlprops,xmlfilename)
73 
74     \textcolor{comment}{!Go to the materials node}
75     tag = \textcolor{stringliteral}{"materials"}
76     \textcolor{keyword}{call }xmlreader%gotoNode(xmlprops,xmlprops,tag)
77 
78     \textcolor{comment}{!find and set the actual atributes of the properties}
79     att\_name=\textcolor{stringliteral}{"value"}
80     \textcolor{keywordflow}{do} i = 1, \textcolor{keyword}{size}(tempsources%src)
81         tag = tempsources%src(i)%prop%property\_type
82         \textcolor{keywordflow}{if} (tag .ne. \textcolor{stringliteral}{'base'}) \textcolor{keywordflow}{then}
83             \textcolor{keyword}{call }xmlreader%gotoNode(xmlprops,anode,tag) \textcolor{comment}{!finding the material type node}
84             tag = tempsources%src(i)%prop%property\_name
85             \textcolor{keyword}{call }xmlreader%gotoNode(anode,anode,tag)     \textcolor{comment}{!finding the actual material node}
86             \textcolor{keywordflow}{do} p = 1, \textcolor{keyword}{size}(globals%SrcProp%baselist)
87                 \textcolor{keyword}{call }xmlreader%getNodeAttribute(anode, globals%SrcProp%baselist(p), att\_name, att\_val)
88                 \textcolor{keyword}{call }tempsources%src(i)%setPropertyAtributes(globals%SrcProp%baselist(p), att\_val)
89 \textcolor{keywordflow}{            end do}
90             \textcolor{keywordflow}{if} (tempsources%src(i)%isParticulate()) \textcolor{keywordflow}{then}
91                 \textcolor{keywordflow}{do} p = 1, \textcolor{keyword}{size}(globals%SrcProp%particulatelist)
92                     \textcolor{keyword}{call }xmlreader%getNodeAttribute(anode, globals%SrcProp%particulatelist(p), att\_name, 
      att\_val)
93                     \textcolor{keyword}{call }tempsources%src(i)%setPropertyAtributes(globals%SrcProp%particulatelist(p), 
      att\_val)
94 \textcolor{keywordflow}{                end do}
95 \textcolor{keywordflow}{            end if}
96             \textcolor{comment}{!Run integrety check on the properties to see if Source is well defined}
97             \textcolor{keyword}{call }tempsources%src(i)%check()
98 \textcolor{keywordflow}{        end if}
99 \textcolor{keywordflow}{    end do}
100     outext=\textcolor{stringliteral}{'-->Sources properties are set'}
101     \textcolor{keyword}{call }log%put(outext,.false.)
102 
103     \textcolor{keyword}{call }xmlreader%closeFile(xmlprops)
104 
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesimulationinitialize__mod_aa4c1099b84c9901ab1286a3796a54f71_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesimulationinitialize__mod_ab65ac868a57f2cc124ec29f87a239424}\label{namespacesimulationinitialize__mod_ab65ac868a57f2cc124ec29f87a239424}} 
\index{simulationinitialize\+\_\+mod@{simulationinitialize\+\_\+mod}!read\+\_\+xml\+\_\+geometry@{read\+\_\+xml\+\_\+geometry}}
\index{read\+\_\+xml\+\_\+geometry@{read\+\_\+xml\+\_\+geometry}!simulationinitialize\+\_\+mod@{simulationinitialize\+\_\+mod}}
\subsubsection{\texorpdfstring{read\+\_\+xml\+\_\+geometry()}{read\_xml\_geometry()}}
{\footnotesize\ttfamily subroutine simulationinitialize\+\_\+mod\+::read\+\_\+xml\+\_\+geometry (\begin{DoxyParamCaption}\item[{type(node), intent(in), pointer}]{source,  }\item[{type(node), intent(in), pointer}]{source\+\_\+detail,  }\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1shape}{shape}}), intent(inout)}]{source\+\_\+shape }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Private geometry xml parser routine. Reads a geometry from the xml depending on the geometry type of the node. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em source,source\+\_\+detail,source\+\_\+shape} & \\
\hline
\mbox{\tt in}  & {\em source} & Working xml node\\
\hline
\mbox{\tt in}  & {\em source\+\_\+detail} & Working xml node details\\
\hline
\mbox{\tt in,out}  & {\em source\+\_\+shape} & Geometrical object to fill \\
\hline
\end{DoxyParams}


Definition at line 184 of file simulation\+Initialize.\+f90.


\begin{DoxyCode}
184     \textcolor{keywordtype}{implicit none}
185     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{pointer} :: source
186     \textcolor{keywordtype}{type}(Node), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{pointer} :: source\_detail
187     \textcolor{keywordtype}{class}(shape), \textcolor{keywordtype}{intent(inout)} :: source\_shape
188     \textcolor{keywordtype}{type}(string) :: outext
189     \textcolor{keywordtype}{type}(string) :: tag
190     \textcolor{keywordflow}{select type} (source\_shape)
191 \textcolor{keywordflow}{    type is} (shape)
192 \textcolor{keywordflow}{    class is} (box)
193         tag=\textcolor{stringliteral}{'point'}
194         \textcolor{keyword}{call }xmlreader%getNodeVector(source\_detail,tag,source\_shape%pt)
195         tag=\textcolor{stringliteral}{'size'}
196         \textcolor{keyword}{call }xmlreader%getNodeVector(source\_detail,tag,source\_shape%size)
197 \textcolor{keywordflow}{    class is} (point)
198         tag=\textcolor{stringliteral}{'point'}
199         \textcolor{keyword}{call }xmlreader%getNodeVector(source,tag,source\_shape%pt)
200 \textcolor{keywordflow}{    class is} (line)
201         tag=\textcolor{stringliteral}{'pointa'}
202         \textcolor{keyword}{call }xmlreader%getNodeVector(source\_detail,tag,source\_shape%pt)
203         tag=\textcolor{stringliteral}{'pointb'}
204         \textcolor{keyword}{call }xmlreader%getNodeVector(source\_detail,tag,source\_shape%last)
205 \textcolor{keywordflow}{    class is} (sphere)
206         tag=\textcolor{stringliteral}{'point'}
207         \textcolor{keyword}{call }xmlreader%getNodeVector(source\_detail,tag,source\_shape%pt)
208         \textcolor{keyword}{call }extractdataattribute(source\_detail, \textcolor{stringliteral}{"radius"}, source\_shape%radius)
209 \textcolor{keywordflow}{        class default}
210         outext=\textcolor{stringliteral}{'[read\_xml\_geometry]: unexpected type for geometry object!'}
211         \textcolor{keyword}{call }log%put(outext)
212         stop
213 \textcolor{keywordflow}{    end select}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesimulationinitialize__mod_ab65ac868a57f2cc124ec29f87a239424_icgraph}
\end{center}
\end{figure}
