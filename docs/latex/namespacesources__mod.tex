\hypertarget{namespacesources__mod}{}\section{sources\+\_\+mod Module Reference}
\label{namespacesources__mod}\index{sources\+\_\+mod@{sources\+\_\+mod}}


Module that defines a source class and related methods.  


\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structsources__mod_1_1source__class}{source\+\_\+class}}
\begin{DoxyCompactList}\small\item\em Type -\/ The source class. \end{DoxyCompactList}\item 
type \mbox{\hyperlink{structsources__mod_1_1source__group__class}{source\+\_\+group\+\_\+class}}
\item 
type \mbox{\hyperlink{structsources__mod_1_1source__par}{source\+\_\+par}}
\item 
type \mbox{\hyperlink{structsources__mod_1_1source__prop}{source\+\_\+prop}}
\begin{DoxyCompactList}\small\item\em Type -\/ material properties of a source object. \end{DoxyCompactList}\item 
type \mbox{\hyperlink{structsources__mod_1_1source__state}{source\+\_\+state}}
\begin{DoxyCompactList}\small\item\em Type -\/ state variables of a source object. \end{DoxyCompactList}\item 
type \mbox{\hyperlink{structsources__mod_1_1source__stats}{source\+\_\+stats}}
\begin{DoxyCompactList}\small\item\em Type -\/ statistical variables of a source object. \end{DoxyCompactList}\item 
type \mbox{\hyperlink{structsources__mod_1_1source__stencil}{source\+\_\+stencil}}
\begin{DoxyCompactList}\small\item\em Type -\/ holder for the tracer creation stencil of the source. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacesources__mod_a6da3303e5c39d77c0111ec50623bf5fe}{initsources}} (self, nsources)
\begin{DoxyCompactList}\small\item\em source allocation routine -\/ allocates sources objects \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesources__mod_aee745aa084adcfa41ecfc3469b90aa8e}{killsources}} (self)
\begin{DoxyCompactList}\small\item\em source group destructor -\/ deallocates sources objects \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesources__mod_a683ca7e4aca7a0050aad9f506569fca9}{linkproperty}} (src, ptype, pname)
\begin{DoxyCompactList}\small\item\em source property setting proceadure -\/ initializes Source variables \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesources__mod_aa76f16f8ee96bc86b553aa54d420321c}{setpropertynames}} (self, srcid\+\_\+str, ptype, pname)
\begin{DoxyCompactList}\small\item\em source property setting routine, calls source by id to set its properties \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesources__mod_abbb4557b46c533439fe258cecf31a76c}{setpropertyatributes}} (src, pname, pvalue)
\begin{DoxyCompactList}\small\item\em source property atribute setting proceadure -\/ initializes Source variables \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesources__mod_a6fcfcb690cd1b9375915b01f7ddbe801}{check}} (self)
\begin{DoxyCompactList}\small\item\em Method that checks for the consistency of the Source properties. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesources__mod_af7fab14b56573184d5ca4371409118b0}{setvariablerate}} (self, filename)
\begin{DoxyCompactList}\small\item\em Method that reads a csv file with variable emission rate data, allocates the space, and stores the data in the Source. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesources__mod_a0d56083fdc0453f03f9dfdb24f704ac4}{getvariablerate}} (self, index)
\begin{DoxyCompactList}\small\item\em Method that sets the rate for the current time step, in case of a variable rate. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesources__mod_aef3551e97236f03fc73fcf77276bb318}{initializesource}} (src, id, name, emitting\+\_\+rate, emitting\+\_\+fixed\+\_\+rate, rate\+\_\+file, start, finish, source\+\_\+geometry, shapetype)
\begin{DoxyCompactList}\small\item\em source inititialization proceadure -\/ initializes Source variables \end{DoxyCompactList}\item 
logical function \mbox{\hyperlink{namespacesources__mod_ac4e4f33da78d030e1b56a48789da6a05}{isparticulate}} (self)
\begin{DoxyCompactList}\small\item\em Returns particulate status of this Source, i.\+e, true if the emitted Tracers are actually a collection of particles with an evolving concentration. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesources__mod_a9a62c41b71d2d6ad85def74087542ef5}{setotalnp}} (self)
\begin{DoxyCompactList}\small\item\em method that sets the total number of tracers a source will potentially create ${NP}_{total}^{source-i}=int((T_{end}^{source-i}-T_{start}^{source-i})/(Dt/{Rate}^{source-i})*{NP}_{emission}^{source-i})$ \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesources__mod_a641fe9ecc295e486a714c1aaa133d991}{printsource}} (src)
\begin{DoxyCompactList}\small\item\em source print routine -\/ prints a source info on console/log \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
type(\mbox{\hyperlink{structsources__mod_1_1source__group__class}{source\+\_\+group\+\_\+class}}), public \mbox{\hyperlink{namespacesources__mod_ab04ea8c02cdf83a1a356c8710ae811d5}{tempsources}}
\begin{DoxyCompactList}\small\item\em Temporary Source array, used exclusively for building the case from a description file. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Module that defines a source class and related methods. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas 
\end{DoxyAuthor}


\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacesources__mod_a6fcfcb690cd1b9375915b01f7ddbe801}\label{namespacesources__mod_a6fcfcb690cd1b9375915b01f7ddbe801}} 
\index{sources\+\_\+mod@{sources\+\_\+mod}!check@{check}}
\index{check@{check}!sources\+\_\+mod@{sources\+\_\+mod}}
\subsubsection{\texorpdfstring{check()}{check()}}
{\footnotesize\ttfamily subroutine sources\+\_\+mod\+::check (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsources__mod_1_1source__class}{source\+\_\+class}}), intent(in)}]{self }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Method that checks for the consistency of the Source properties. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}


Definition at line 244 of file sources.\+f90.


\begin{DoxyCode}
244     \textcolor{keywordtype}{class}(source\_class), \textcolor{keywordtype}{intent(in)} :: self
245     \textcolor{keywordtype}{type}(string) :: outext, temp(2)
246     \textcolor{keywordtype}{logical} :: failed
247     failed = .false.
248     temp(1) = self%par%id
249     \textcolor{keywordflow}{if} (self%prop%radius == mv) \textcolor{keywordflow}{then}
250         failed = .true.
251         temp(2) = \textcolor{stringliteral}{'radius'}
252     \textcolor{keywordflow}{elseif} (self%prop%density == mv) \textcolor{keywordflow}{then}
253         failed = .true.
254         temp(2) = \textcolor{stringliteral}{'density'}
255     \textcolor{keywordflow}{elseif} (self%prop%condition == mv) \textcolor{keywordflow}{then}
256         failed = .true.
257         temp(2) = \textcolor{stringliteral}{'condition'}
258     \textcolor{keywordflow}{elseif} (self%prop%degrd\_rate == mv) \textcolor{keywordflow}{then}
259         failed = .true.
260         temp(2) = \textcolor{stringliteral}{'degradation rate'}
261     \textcolor{keywordflow}{elseif} (self%prop%particulate) \textcolor{keywordflow}{then}
262         \textcolor{keywordflow}{if} (self%prop%pt\_radius == mv) \textcolor{keywordflow}{then}
263             failed = .true.
264             temp(2) = \textcolor{stringliteral}{'particle radius'}
265         \textcolor{keywordflow}{elseif} (self%prop%ini\_concentration == mv) \textcolor{keywordflow}{then}
266             failed = .true.
267             temp(2) = \textcolor{stringliteral}{'initial concentration'}
268 \textcolor{keywordflow}{        end if}
269 \textcolor{keywordflow}{    end if}
270     \textcolor{keywordflow}{if} (failed) \textcolor{keywordflow}{then}
271         outext = \textcolor{stringliteral}{'Property '}//temp(2)//\textcolor{stringliteral}{' from Source id = '}//temp(1)//\textcolor{stringliteral}{' is not set, stoping'}
272         \textcolor{keyword}{call }log%put(outext)
273         stop
274 \textcolor{keywordflow}{    end if}
\end{DoxyCode}
\mbox{\Hypertarget{namespacesources__mod_a0d56083fdc0453f03f9dfdb24f704ac4}\label{namespacesources__mod_a0d56083fdc0453f03f9dfdb24f704ac4}} 
\index{sources\+\_\+mod@{sources\+\_\+mod}!getvariablerate@{getvariablerate}}
\index{getvariablerate@{getvariablerate}!sources\+\_\+mod@{sources\+\_\+mod}}
\subsubsection{\texorpdfstring{getvariablerate()}{getvariablerate()}}
{\footnotesize\ttfamily subroutine sources\+\_\+mod\+::getvariablerate (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsources__mod_1_1source__class}{source\+\_\+class}}), intent(inout)}]{self,  }\item[{integer}]{index }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Method that sets the rate for the current time step, in case of a variable rate. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,index} & \\
\hline
\end{DoxyParams}


Definition at line 328 of file sources.\+f90.


\begin{DoxyCode}
328     \textcolor{keywordtype}{class}(source\_class), \textcolor{keywordtype}{intent(inout)} :: self        
329     \textcolor{keywordtype}{integer} :: index
330     \textcolor{keywordtype}{type}(string) :: outext
331     self%par%emitting\_rate = self%par%variable\_rate(min(index,\textcolor{keyword}{size}(self%par%variable\_rate)))
\end{DoxyCode}
\mbox{\Hypertarget{namespacesources__mod_aef3551e97236f03fc73fcf77276bb318}\label{namespacesources__mod_aef3551e97236f03fc73fcf77276bb318}} 
\index{sources\+\_\+mod@{sources\+\_\+mod}!initializesource@{initializesource}}
\index{initializesource@{initializesource}!sources\+\_\+mod@{sources\+\_\+mod}}
\subsubsection{\texorpdfstring{initializesource()}{initializesource()}}
{\footnotesize\ttfamily subroutine sources\+\_\+mod\+::initializesource (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsources__mod_1_1source__class}{source\+\_\+class}})}]{src,  }\item[{integer, intent(in)}]{id,  }\item[{type(string), intent(in)}]{name,  }\item[{real(prec), intent(in)}]{emitting\+\_\+rate,  }\item[{logical, intent(in)}]{emitting\+\_\+fixed\+\_\+rate,  }\item[{type(string), intent(in)}]{rate\+\_\+file,  }\item[{real(prec), intent(in)}]{start,  }\item[{real(prec), intent(in)}]{finish,  }\item[{type(string), intent(in)}]{source\+\_\+geometry,  }\item[{class(\mbox{\hyperlink{structgeometry__mod_1_1shape}{shape}}), intent(in)}]{shapetype }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



source inititialization proceadure -\/ initializes Source variables 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em src,id,name,emitting\+\_\+rate,emitting\+\_\+fixed\+\_\+rate,rate\+\_\+file,start,finish,source\+\_\+geometry,shapetype} & \\
\hline
\end{DoxyParams}


Definition at line 341 of file sources.\+f90.


\begin{DoxyCode}
341     \textcolor{keywordtype}{class}(source\_class) :: src
342     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: id
343     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: name
344     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{intent(in)} :: emitting\_rate
345     \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)} :: emitting\_fixed\_rate
346     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: rate\_file
347     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{intent(in)} :: start
348     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{intent(in)} :: finish
349     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: source\_geometry
350     \textcolor{keywordtype}{class}(shape), \textcolor{keywordtype}{intent(in)} :: shapetype
351     \textcolor{keywordtype}{integer} :: sizem, i
352     \textcolor{keywordtype}{type}(string) :: outext
353     \textcolor{keywordtype}{integer} :: err
354 
355     \textcolor{comment}{!Setting parameters}
356     src%par%id=id
357     src%par%name=name
358     src%par%emitting\_rate=emitting\_rate
359     src%par%emitting\_fixed\_rate = emitting\_fixed\_rate
360     src%par%rate\_file = rate\_file
361     \textcolor{keywordflow}{if} (emitting\_fixed\_rate .eqv. .false.) \textcolor{keywordflow}{then}
362         \textcolor{keyword}{call }src%setVariableRate(src%par%rate\_file)
363         \textcolor{keyword}{call }src%getVariableRate(globals%Sim%getnumdt())
364 \textcolor{keywordflow}{    end if}
365     src%par%startime=start
366     src%par%stoptime=finish
367     src%par%source\_geometry=source\_geometry
368     \textcolor{keyword}{allocate}(src%par%geometry, source=shapetype)
369     \textcolor{comment}{!Setting properties}
370     src%prop%property\_type = \textcolor{stringliteral}{"base"} \textcolor{comment}{! pure Lagrangian trackers by default}
371     src%prop%property\_name = \textcolor{stringliteral}{"base"}
372     src%prop%particulate = .false.
373     src%prop%radius = mv
374     src%prop%density = mv
375     src%prop%condition = mv
376     src%prop%degrd\_rate = mv
377     src%prop%pt\_radius = mv
378     src%prop%ini\_concentration = mv
379     \textcolor{comment}{!Setting state variables}
380     src%now%age=0.0
381     src%now%active=.false. \textcolor{comment}{!disabled by default}
382     src%now%emission\_stack = 1
383     src%now%pos=src%par%geometry%pt \textcolor{comment}{!coords of the Source (meaning depends on the geometry type!)}
384     \textcolor{comment}{!setting statistical samplers}
385     src%stats%particles\_emitted=0
386     src%stats%ns=0
387     \textcolor{comment}{!setting stencil variables}
388     src%stencil%np = geometry%fillsize(src%par%geometry, globals%SimDefs%Dp)
389     \textcolor{keyword}{call }src%setotalnp()
390     \textcolor{keyword}{allocate}(src%stencil%ptlist(src%stencil%np), stat=err)
391     \textcolor{keywordflow}{if}(err/=0)\textcolor{keywordflow}{then}
392         outext=\textcolor{stringliteral}{'[Sources::initialize]:Cannot allocate point list for Source '}// src%par%name //\textcolor{stringliteral}{', stoping'}
393         \textcolor{keyword}{call }log%put(outext)
394         stop
395 \textcolor{keywordflow}{    endif}
396     \textcolor{keyword}{call }geometry%fill(src%par%geometry, globals%SimDefs%Dp, src%stencil%np, src%stencil%ptlist)
397     \textcolor{keywordflow}{do} i=1, src%stencil%np
398         src%stencil%ptlist(i) = utils%m2geo(src%stencil%ptlist(i), src%stencil%ptlist(i)%y)
399 \textcolor{keywordflow}{    end do}
400 
401     sizem = sizeof(src)
402     \textcolor{keyword}{call }simmemory%addsource(sizem)
403     \textcolor{keyword}{call }src%print()
404 
\end{DoxyCode}
\mbox{\Hypertarget{namespacesources__mod_a6da3303e5c39d77c0111ec50623bf5fe}\label{namespacesources__mod_a6da3303e5c39d77c0111ec50623bf5fe}} 
\index{sources\+\_\+mod@{sources\+\_\+mod}!initsources@{initsources}}
\index{initsources@{initsources}!sources\+\_\+mod@{sources\+\_\+mod}}
\subsubsection{\texorpdfstring{initsources()}{initsources()}}
{\footnotesize\ttfamily subroutine sources\+\_\+mod\+::initsources (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsources__mod_1_1source__group__class}{source\+\_\+group\+\_\+class}}), intent(inout)}]{self,  }\item[{integer, intent(in)}]{nsources }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



source allocation routine -\/ allocates sources objects 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,nsources} & \\
\hline
\end{DoxyParams}


Definition at line 118 of file sources.\+f90.


\begin{DoxyCode}
118     \textcolor{keywordtype}{implicit none}
119     \textcolor{keywordtype}{class}(source\_group\_class), \textcolor{keywordtype}{intent(inout)} :: self
120     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: nsources
121     \textcolor{keywordtype}{integer} err
122     \textcolor{keywordtype}{type}(string) :: outext, temp
123     \textcolor{keyword}{allocate}(self%src(nsources), stat=err)
124     \textcolor{keywordflow}{if}(err/=0)\textcolor{keywordflow}{then}
125         outext=\textcolor{stringliteral}{'[initSources]: Cannot allocate Sources, stoping'}
126         \textcolor{keyword}{call }log%put(outext)
127         stop
128     \textcolor{keywordflow}{else}
129         temp = nsources
130         outext = \textcolor{stringliteral}{'Allocated '}// temp // \textcolor{stringliteral}{' Sources.'}
131         \textcolor{keyword}{call }log%put(outext)
132 \textcolor{keywordflow}{    endif}
\end{DoxyCode}
\mbox{\Hypertarget{namespacesources__mod_ac4e4f33da78d030e1b56a48789da6a05}\label{namespacesources__mod_ac4e4f33da78d030e1b56a48789da6a05}} 
\index{sources\+\_\+mod@{sources\+\_\+mod}!isparticulate@{isparticulate}}
\index{isparticulate@{isparticulate}!sources\+\_\+mod@{sources\+\_\+mod}}
\subsubsection{\texorpdfstring{isparticulate()}{isparticulate()}}
{\footnotesize\ttfamily logical function sources\+\_\+mod\+::isparticulate (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsources__mod_1_1source__class}{source\+\_\+class}})}]{self }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Returns particulate status of this Source, i.\+e, true if the emitted Tracers are actually a collection of particles with an evolving concentration. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}


Definition at line 415 of file sources.\+f90.


\begin{DoxyCode}
415     \textcolor{keywordtype}{class}(source\_class) :: self
416     isparticulate = self%prop%particulate
\end{DoxyCode}
\mbox{\Hypertarget{namespacesources__mod_aee745aa084adcfa41ecfc3469b90aa8e}\label{namespacesources__mod_aee745aa084adcfa41ecfc3469b90aa8e}} 
\index{sources\+\_\+mod@{sources\+\_\+mod}!killsources@{killsources}}
\index{killsources@{killsources}!sources\+\_\+mod@{sources\+\_\+mod}}
\subsubsection{\texorpdfstring{killsources()}{killsources()}}
{\footnotesize\ttfamily subroutine sources\+\_\+mod\+::killsources (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsources__mod_1_1source__group__class}{source\+\_\+group\+\_\+class}}), intent(inout)}]{self }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



source group destructor -\/ deallocates sources objects 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}


Definition at line 141 of file sources.\+f90.


\begin{DoxyCode}
141     \textcolor{keywordtype}{implicit none}
142     \textcolor{keywordtype}{class}(source\_group\_class), \textcolor{keywordtype}{intent(inout)} :: self
143     \textcolor{keywordtype}{integer} err
144     \textcolor{keywordtype}{type}(string) :: outext
145     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(self%src)) \textcolor{keyword}{deallocate}(self%src, stat=err)
146     \textcolor{keywordflow}{if}(err/=0)\textcolor{keywordflow}{then}
147         outext=\textcolor{stringliteral}{'[killSources]: Cannot deallocate Sources, stoping'}
148         \textcolor{keyword}{call }log%put(outext)
149         stop
150 \textcolor{keywordflow}{    endif}
\end{DoxyCode}
\mbox{\Hypertarget{namespacesources__mod_a683ca7e4aca7a0050aad9f506569fca9}\label{namespacesources__mod_a683ca7e4aca7a0050aad9f506569fca9}} 
\index{sources\+\_\+mod@{sources\+\_\+mod}!linkproperty@{linkproperty}}
\index{linkproperty@{linkproperty}!sources\+\_\+mod@{sources\+\_\+mod}}
\subsubsection{\texorpdfstring{linkproperty()}{linkproperty()}}
{\footnotesize\ttfamily subroutine sources\+\_\+mod\+::linkproperty (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsources__mod_1_1source__class}{source\+\_\+class}}), intent(inout)}]{src,  }\item[{type(string), intent(in)}]{ptype,  }\item[{type(string), intent(in)}]{pname }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



source property setting proceadure -\/ initializes Source variables 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em src,ptype,pname} & \\
\hline
\end{DoxyParams}


Definition at line 160 of file sources.\+f90.


\begin{DoxyCode}
160     \textcolor{keywordtype}{implicit none}
161     \textcolor{keywordtype}{class}(source\_class), \textcolor{keywordtype}{intent(inout)} :: src
162     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: ptype
163     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: pname
164     src%prop%property\_type = ptype
165     src%prop%property\_name = pname
\end{DoxyCode}
\mbox{\Hypertarget{namespacesources__mod_a641fe9ecc295e486a714c1aaa133d991}\label{namespacesources__mod_a641fe9ecc295e486a714c1aaa133d991}} 
\index{sources\+\_\+mod@{sources\+\_\+mod}!printsource@{printsource}}
\index{printsource@{printsource}!sources\+\_\+mod@{sources\+\_\+mod}}
\subsubsection{\texorpdfstring{printsource()}{printsource()}}
{\footnotesize\ttfamily subroutine sources\+\_\+mod\+::printsource (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsources__mod_1_1source__class}{source\+\_\+class}})}]{src }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



source print routine -\/ prints a source info on console/log 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em src} & \\
\hline
\end{DoxyParams}


Definition at line 438 of file sources.\+f90.


\begin{DoxyCode}
438     \textcolor{keywordtype}{implicit none}
439     \textcolor{keywordtype}{class}(source\_class) :: src
440     \textcolor{keywordtype}{type}(string) :: outext
441     \textcolor{keywordtype}{type}(string) :: temp\_str(3)
442     temp\_str(1)=src%par%id
443     outext = \textcolor{stringliteral}{'-->Source '}//src%par%name//new\_line(\textcolor{stringliteral}{'a'})//&
444         \textcolor{stringliteral}{'       Id = '}//temp\_str(1)//new\_line(\textcolor{stringliteral}{'a'})//&
445         \textcolor{stringliteral}{'       Geometry type is '}//src%par%source\_geometry//new\_line(\textcolor{stringliteral}{'a'})
446     temp\_str(1)=src%now%pos%x
447     temp\_str(2)=src%now%pos%y
448     temp\_str(3)=src%now%pos%z
449     outext = outext//\textcolor{stringliteral}{'       Initially at coordinates'}//new\_line(\textcolor{stringliteral}{'a'})//&
450         \textcolor{stringliteral}{'       '}//temp\_str(1)//\textcolor{stringliteral}{' '}//temp\_str(2)//\textcolor{stringliteral}{' '}//temp\_str(3)//new\_line(\textcolor{stringliteral}{'a'})
451     temp\_str(1)=src%stencil%np
452     \textcolor{keywordflow}{if} (src%par%emitting\_fixed\_rate) \textcolor{keywordflow}{then}
453         temp\_str(2)=src%par%emitting\_rate        
454         outext = outext//\textcolor{stringliteral}{'       Emitting '}//temp\_str(1)//\textcolor{stringliteral}{' tracers at '}//temp\_str(2)//\textcolor{stringliteral}{' Hz'}//new\_line(\textcolor{stringliteral}{'a'})
455     \textcolor{keywordflow}{else}
456         outext = outext//\textcolor{stringliteral}{'       Emitting '}//temp\_str(1)//\textcolor{stringliteral}{' tracers at a rate defined in '}//src%par
      %rate\_file//new\_line(\textcolor{stringliteral}{'a'})
457 \textcolor{keywordflow}{    end if}
458     temp\_str(1)=src%par%startime
459     temp\_str(2)=src%par%stoptime
460     outext = outext//\textcolor{stringliteral}{'       Active from '}//temp\_str(1)//\textcolor{stringliteral}{' to '}//temp\_str(2)//\textcolor{stringliteral}{' seconds'}
461     \textcolor{keyword}{call }log%put(outext,.false.)
\end{DoxyCode}
\mbox{\Hypertarget{namespacesources__mod_a9a62c41b71d2d6ad85def74087542ef5}\label{namespacesources__mod_a9a62c41b71d2d6ad85def74087542ef5}} 
\index{sources\+\_\+mod@{sources\+\_\+mod}!setotalnp@{setotalnp}}
\index{setotalnp@{setotalnp}!sources\+\_\+mod@{sources\+\_\+mod}}
\subsubsection{\texorpdfstring{setotalnp()}{setotalnp()}}
{\footnotesize\ttfamily subroutine sources\+\_\+mod\+::setotalnp (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsources__mod_1_1source__class}{source\+\_\+class}}), intent(inout)}]{self }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



method that sets the total number of tracers a source will potentially create ${NP}_{total}^{source-i}=int((T_{end}^{source-i}-T_{start}^{source-i})/(Dt/{Rate}^{source-i})*{NP}_{emission}^{source-i})$ 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}


Definition at line 426 of file sources.\+f90.


\begin{DoxyCode}
426     \textcolor{keywordtype}{implicit none}
427     \textcolor{keywordtype}{class}(source\_class), \textcolor{keywordtype}{intent(inout)} :: self
428     self%stencil%total\_np=int((self%par%stoptime-self%par%startime)*self%par%emitting\_rate*self%stencil%np)
\end{DoxyCode}
\mbox{\Hypertarget{namespacesources__mod_abbb4557b46c533439fe258cecf31a76c}\label{namespacesources__mod_abbb4557b46c533439fe258cecf31a76c}} 
\index{sources\+\_\+mod@{sources\+\_\+mod}!setpropertyatributes@{setpropertyatributes}}
\index{setpropertyatributes@{setpropertyatributes}!sources\+\_\+mod@{sources\+\_\+mod}}
\subsubsection{\texorpdfstring{setpropertyatributes()}{setpropertyatributes()}}
{\footnotesize\ttfamily subroutine sources\+\_\+mod\+::setpropertyatributes (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsources__mod_1_1source__class}{source\+\_\+class}}), intent(inout)}]{src,  }\item[{type(string), intent(in)}]{pname,  }\item[{type(string), intent(in)}]{pvalue }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



source property atribute setting proceadure -\/ initializes Source variables 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em src,pname,pvalue} & \\
\hline
\end{DoxyParams}


Definition at line 210 of file sources.\+f90.


\begin{DoxyCode}
210     \textcolor{keywordtype}{implicit none}
211     \textcolor{keywordtype}{class}(source\_class), \textcolor{keywordtype}{intent(inout)} :: src
212     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: pname
213     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: pvalue
214     \textcolor{keywordtype}{type}(string) :: outext
215     \textcolor{keywordflow}{select case} (pname%chars())
216     \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'particulate'})
217         \textcolor{keywordflow}{if} (pvalue%to\_number(kind=1\_i1p) == 1) \textcolor{keywordflow}{then}
218             src%prop%particulate = .true.
219 \textcolor{keywordflow}{        end if}
220     \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'radius'})
221         src%prop%radius = pvalue%to\_number(kind=1.\_r4p)
222     \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'particle\_radius'})
223         src%prop%pt\_radius = pvalue%to\_number(kind=1.\_r4p)
224     \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'density'})
225         src%prop%density = pvalue%to\_number(kind=1.\_r4p)
226     \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'condition'})
227         src%prop%condition = pvalue%to\_number(kind=1.\_r4p)
228     \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'degradation\_rate'})
229         src%prop%degrd\_rate = pvalue%to\_number(kind=1.\_r4p)
230     \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'intitial\_concentration'})
231         src%prop%ini\_concentration = pvalue%to\_number(kind=1.\_r4p)
232 \textcolor{keywordflow}{        case default}
233         outext=\textcolor{stringliteral}{'[Sources::setPropertyAtributes]: unexpected atribute '}//pname//\textcolor{stringliteral}{' for property '}//src%prop
      %property\_name//\textcolor{stringliteral}{', ignoring'}
234         \textcolor{keyword}{call }log%put(outext)
235 \textcolor{keywordflow}{    end select}
\end{DoxyCode}
\mbox{\Hypertarget{namespacesources__mod_aa76f16f8ee96bc86b553aa54d420321c}\label{namespacesources__mod_aa76f16f8ee96bc86b553aa54d420321c}} 
\index{sources\+\_\+mod@{sources\+\_\+mod}!setpropertynames@{setpropertynames}}
\index{setpropertynames@{setpropertynames}!sources\+\_\+mod@{sources\+\_\+mod}}
\subsubsection{\texorpdfstring{setpropertynames()}{setpropertynames()}}
{\footnotesize\ttfamily subroutine sources\+\_\+mod\+::setpropertynames (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsources__mod_1_1source__group__class}{source\+\_\+group\+\_\+class}}), intent(inout)}]{self,  }\item[{type(string), intent(in)}]{srcid\+\_\+str,  }\item[{type(string), intent(in)}]{ptype,  }\item[{type(string), intent(in)}]{pname }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



source property setting routine, calls source by id to set its properties 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,srcid\+\_\+str,ptype,pname} & \\
\hline
\mbox{\tt in}  & {\em srcid\+\_\+str} & Source id tag\\
\hline
\mbox{\tt in}  & {\em ptype} & Property type to set\\
\hline
\mbox{\tt in}  & {\em pname} & Property name to set \\
\hline
\end{DoxyParams}


Definition at line 175 of file sources.\+f90.


\begin{DoxyCode}
175     \textcolor{keywordtype}{implicit none}
176     \textcolor{keywordtype}{class}(source\_group\_class), \textcolor{keywordtype}{intent(inout)} :: self
177     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: srcid\_str
178     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: ptype
179     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: pname
180     \textcolor{keywordtype}{integer} :: srcid
181     \textcolor{keywordtype}{type}(string) :: outext, temp
182     \textcolor{keywordtype}{integer} :: i
183     \textcolor{keywordtype}{logical} :: notlinked
184     srcid = srcid\_str%to\_number(kind=1\_i1p)
185     notlinked = .true.  \textcolor{comment}{!assuming not linked}
186     \textcolor{keywordflow}{do} i=1, \textcolor{keyword}{size}(self%src)
187         \textcolor{keywordflow}{if} (self%src(i)%par%id == srcid) \textcolor{keywordflow}{then} \textcolor{comment}{! found the correct source to link to}
188             \textcolor{keyword}{call }self%src(i)%linkproperty(ptype,pname) \textcolor{comment}{! calling Source method to link property}
189             temp = self%src(i)%par%id
190             outext=\textcolor{stringliteral}{'      Source id = '}// temp // \textcolor{stringliteral}{', '}// self%src(i)%par%name //\textcolor{stringliteral}{' is of type '}// self%src(i
      )%prop%property\_type //\textcolor{stringliteral}{', with property name '} // self%src(i)%prop%property\_name
191             \textcolor{keyword}{call }log%put(outext,.false.)
192             notlinked = .false. \textcolor{comment}{! we linked it}
193             \textcolor{keywordflow}{exit}
194 \textcolor{keywordflow}{        endif}
195 \textcolor{keywordflow}{    enddo}
196     \textcolor{keywordflow}{if} (notlinked) \textcolor{keywordflow}{then} \textcolor{comment}{! property has no corresponding Source}
197         temp = srcid
198         outext=\textcolor{stringliteral}{'      Source id = '}// temp //\textcolor{stringliteral}{' not listed, property '}// pname //\textcolor{stringliteral}{', of type '} // ptype // \textcolor{stringliteral}{'
       not linked, ignoring'}
199         \textcolor{keyword}{call }log%put(outext,.false.)
200 \textcolor{keywordflow}{    endif}
\end{DoxyCode}
\mbox{\Hypertarget{namespacesources__mod_af7fab14b56573184d5ca4371409118b0}\label{namespacesources__mod_af7fab14b56573184d5ca4371409118b0}} 
\index{sources\+\_\+mod@{sources\+\_\+mod}!setvariablerate@{setvariablerate}}
\index{setvariablerate@{setvariablerate}!sources\+\_\+mod@{sources\+\_\+mod}}
\subsubsection{\texorpdfstring{setvariablerate()}{setvariablerate()}}
{\footnotesize\ttfamily subroutine sources\+\_\+mod\+::setvariablerate (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structsources__mod_1_1source__class}{source\+\_\+class}}), intent(inout)}]{self,  }\item[{type(string), intent(in)}]{filename }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Method that reads a csv file with variable emission rate data, allocates the space, and stores the data in the Source. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,filename} & \\
\hline
\end{DoxyParams}


Definition at line 285 of file sources.\+f90.


\begin{DoxyCode}
285     \textcolor{keywordtype}{class}(source\_class), \textcolor{keywordtype}{intent(inout)} :: self
286     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: filename
287     \textcolor{keywordtype}{type}(csv\_file) :: rateFile
288     \textcolor{keywordtype}{character(len=30)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable} :: header
289     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable} :: time, rate, stime, srate
290     \textcolor{keywordtype}{integer} :: i, index
291     \textcolor{keywordtype}{real(prec)} :: weight
292     \textcolor{keywordtype}{logical} :: status
293     \textcolor{keywordtype}{type}(string) :: outext
294 
295     \textcolor{keyword}{call }csvreader%getFile(ratefile, filename, 1)
296     \textcolor{keyword}{call }csvreader%getColumn(ratefile, filename, 1, time)
297     \textcolor{keyword}{call }csvreader%getColumn(ratefile, filename, 2, rate)
298     \textcolor{keyword}{call }csvreader%closeFile(ratefile)
299     \textcolor{comment}{!interpolating the csv data to a regular dt spaced array and storing the data in the Source}
300     \textcolor{keyword}{allocate}(stime(int(min(globals%Parameters%TimeMax,maxval(time))/globals%SimDefs%dt)+1))
301     \textcolor{keyword}{allocate}(srate(\textcolor{keyword}{size}(stime)))
302     \textcolor{keywordflow}{do} i=1, \textcolor{keyword}{size}(stime)
303         stime(i)=globals%SimDefs%dt*(i-1)
304 \textcolor{keywordflow}{    end do}
305     \textcolor{keywordflow}{do} i=1, \textcolor{keyword}{size}(stime)
306         \textcolor{keywordflow}{if} (stime(i)<time(1)) \textcolor{keywordflow}{then} 
307             srate(i) = 0.0
308         \textcolor{keywordflow}{else}
309             \textcolor{keywordflow}{do} index=1, \textcolor{keyword}{size}(time)-1
310                 \textcolor{keywordflow}{if} (stime(i)>=time(index)) \textcolor{keywordflow}{then}
311                     weight = (stime(i)-time(index))/(time(index+1)-time(index));
312                     srate(i) = (1.0-weight)*rate(index) + weight*rate(index+1);
313 \textcolor{keywordflow}{                end if}
314 \textcolor{keywordflow}{            end do}
315 \textcolor{keywordflow}{        end if}
316 \textcolor{keywordflow}{    end do}
317     \textcolor{keyword}{allocate}(self%par%variable\_rate(\textcolor{keyword}{size}(srate)), source=srate)
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{namespacesources__mod_ab04ea8c02cdf83a1a356c8710ae811d5}\label{namespacesources__mod_ab04ea8c02cdf83a1a356c8710ae811d5}} 
\index{sources\+\_\+mod@{sources\+\_\+mod}!tempsources@{tempsources}}
\index{tempsources@{tempsources}!sources\+\_\+mod@{sources\+\_\+mod}}
\subsubsection{\texorpdfstring{tempsources}{tempsources}}
{\footnotesize\ttfamily type(\mbox{\hyperlink{structsources__mod_1_1source__group__class}{source\+\_\+group\+\_\+class}}), public sources\+\_\+mod\+::tempsources}



Temporary Source array, used exclusively for building the case from a description file. 



Definition at line 104 of file sources.\+f90.


\begin{DoxyCode}
104     \textcolor{keywordtype}{type}(source\_group\_class) :: tempSources
\end{DoxyCode}
