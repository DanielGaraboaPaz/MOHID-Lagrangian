\hypertarget{namespacenetcdfparser__mod}{}\section{netcdfparser\+\_\+mod Module Reference}
\label{namespacenetcdfparser__mod}\index{netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}}


Module that defines a netcdf file model class, responsible for abstracting the parsing of netcdf files. Each object of this class is responsible for one file, effectivelly representing it. The object should return the necessary data fields with corresponding meta data, such as names and units. An variable library is consulted when required, because even Net\+C\+DF CF compliance allows ambiguity.  


\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structnetcdfparser__mod_1_1dim__t}{dim\+\_\+t}}
\item 
type \mbox{\hyperlink{structnetcdfparser__mod_1_1ncfile__class}{ncfile\+\_\+class}}
\begin{DoxyCompactList}\small\item\em A class that models a netcdf file. \end{DoxyCompactList}\item 
type \mbox{\hyperlink{structnetcdfparser__mod_1_1var__t}{var\+\_\+t}}
\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacenetcdfparser__mod_a57c39a4003778a6bf90cfd36b69380bc}{getfile}} (self, filename)
\begin{DoxyCompactList}\small\item\em Parse the netcdf file headers and assembles the file model. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacenetcdfparser__mod_a741dd5b5985255e73aa9d3cf08755e91}{getncid}} (self)
\begin{DoxyCompactList}\small\item\em Opens the netcdf file, assigns the N\+C\+ID and checks for errors. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacenetcdfparser__mod_a409f59662d71fb63e5fb5e057fdfd6ee}{getncglobalmetadata}} (self)
\begin{DoxyCompactList}\small\item\em Inquires the nc file for global metadata -\/ number of dimensions, variables and attributes. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacenetcdfparser__mod_a46989199271acb6205cc61ac413d5a56}{getncvarmetadata}} (self)
\begin{DoxyCompactList}\small\item\em Inquires the nc file for variable metadata. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacenetcdfparser__mod_a6354ee8b3c773cc7a5ad247ad1e34eeb}{getncdimmetadata}} (self)
\begin{DoxyCompactList}\small\item\em Inquires the nc file for dimension metadata. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacenetcdfparser__mod_a0aea819b8a474ce2f4840d0bc44e95ec}{getvardimensions}} (self, var\+Name, dims\+Arrays)
\begin{DoxyCompactList}\small\item\em Reads the dimension fields from the nc file for a given variable. returns an array of scalar 1D fields, each with a name, units and data. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacenetcdfparser__mod_aba877869db6bea7262d659133253cff7}{getvar}} (self, var\+Name, var\+Field, binary\+Var, alt\+Name, alt\+Units)
\begin{DoxyCompactList}\small\item\em Reads the fields from the nc file for a given variable. returns a generic field, with a name, units and data. \end{DoxyCompactList}\item 
type(\mbox{\hyperlink{structnetcdfparser__mod_1_1dim__t}{dim\+\_\+t}}) function \mbox{\hyperlink{namespacenetcdfparser__mod_a5fcd4b7fb27dbc9befd0a6fcfb9929a1}{getdimbydimid}} (self, dim\+ID)
\begin{DoxyCompactList}\small\item\em returns a dimension field metadata structure, given a dim\+ID \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacenetcdfparser__mod_a518627511cac4bf3dbc338bf3bfd5e24}{closefile}} (self)
\begin{DoxyCompactList}\small\item\em Close the netcdf file. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacenetcdfparser__mod_ae1a034f6540ac7a1ce7d0e3831bb2f03}{check}} (self)
\begin{DoxyCompactList}\small\item\em Debug the netcdf error after a netcdf command. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacenetcdfparser__mod_aeb48d33c014bae21b2fceaaa70cbdc67}{printncinfo}} (self)
\begin{DoxyCompactList}\small\item\em prints most of the file model metadata \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacenetcdfparser__mod_a6b57fa47d7bd796c75483216a51e5e04}{printvarsnc}} (self)
\begin{DoxyCompactList}\small\item\em print variable metadata \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacenetcdfparser__mod_ac01c000a97d23613684155708249ce89}{printdimsnc}} (self)
\begin{DoxyCompactList}\small\item\em print dimensions metadata \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacenetcdfparser__mod_af93319fde6cf6baedb7fe27bf3396e7b}{correctnctime}} (time\+Comments, time\+Array)
\begin{DoxyCompactList}\small\item\em corrects the time array to a more efficient format if needed. assumes netcdf comment as \textquotesingle{}seconds since 1981-\/01-\/01 00\+:00\+:00\textquotesingle{} \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Module that defines a netcdf file model class, responsible for abstracting the parsing of netcdf files. Each object of this class is responsible for one file, effectivelly representing it. The object should return the necessary data fields with corresponding meta data, such as names and units. An variable library is consulted when required, because even Net\+C\+DF CF compliance allows ambiguity. 

\begin{DoxyAuthor}{Author}
Daniel Garaboa Paz 
\end{DoxyAuthor}


\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacenetcdfparser__mod_ae1a034f6540ac7a1ce7d0e3831bb2f03}\label{namespacenetcdfparser__mod_ae1a034f6540ac7a1ce7d0e3831bb2f03}} 
\index{netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}!check@{check}}
\index{check@{check}!netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}}
\subsubsection{\texorpdfstring{check()}{check()}}
{\footnotesize\ttfamily subroutine netcdfparser\+\_\+mod\+::check (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structnetcdfparser__mod_1_1ncfile__class}{ncfile\+\_\+class}}), intent(inout)}]{self }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Debug the netcdf error after a netcdf command. 

\begin{DoxyAuthor}{Author}
Daniel Garaboa Paz -\/ U\+SC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self} & \\
\hline
\end{DoxyParams}


Definition at line 444 of file Net\+C\+D\+Fparser.\+f90.


\begin{DoxyCode}
444     \textcolor{keywordtype}{class}(ncfile\_class), \textcolor{keywordtype}{intent(inout)} :: self
445     \textcolor{keywordtype}{type}(string) :: outext
446     \textcolor{keywordflow}{if}(self%status /= nf90\_noerr) \textcolor{keywordflow}{then}
447         outext = \textcolor{stringliteral}{'[NetCDFparser::check]: '}//trim(nf90\_strerror(self%status))//\textcolor{stringliteral}{', stoping'}
448         \textcolor{keyword}{call }log%put(outext)
449         stop
450 \textcolor{keywordflow}{    end if}
\end{DoxyCode}
\mbox{\Hypertarget{namespacenetcdfparser__mod_a518627511cac4bf3dbc338bf3bfd5e24}\label{namespacenetcdfparser__mod_a518627511cac4bf3dbc338bf3bfd5e24}} 
\index{netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}!closefile@{closefile}}
\index{closefile@{closefile}!netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}}
\subsubsection{\texorpdfstring{closefile()}{closefile()}}
{\footnotesize\ttfamily subroutine netcdfparser\+\_\+mod\+::closefile (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structnetcdfparser__mod_1_1ncfile__class}{ncfile\+\_\+class}}), intent(inout)}]{self }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Close the netcdf file. 

\begin{DoxyAuthor}{Author}
Daniel Garaboa Paz -\/ U\+SC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self} & \\
\hline
\end{DoxyParams}


Definition at line 432 of file Net\+C\+D\+Fparser.\+f90.


\begin{DoxyCode}
432     \textcolor{keywordtype}{class}(ncfile\_class),\textcolor{keywordtype}{intent(inout)} :: self
433     self%status = nf90\_close(self%ncID)
434     \textcolor{keyword}{call }self%check()
\end{DoxyCode}
\mbox{\Hypertarget{namespacenetcdfparser__mod_af93319fde6cf6baedb7fe27bf3396e7b}\label{namespacenetcdfparser__mod_af93319fde6cf6baedb7fe27bf3396e7b}} 
\index{netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}!correctnctime@{correctnctime}}
\index{correctnctime@{correctnctime}!netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}}
\subsubsection{\texorpdfstring{correctnctime()}{correctnctime()}}
{\footnotesize\ttfamily subroutine netcdfparser\+\_\+mod\+::correctnctime (\begin{DoxyParamCaption}\item[{type(string), intent(inout)}]{time\+Comments,  }\item[{real(prec), dimension(\+:), intent(inout)}]{time\+Array }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



corrects the time array to a more efficient format if needed. assumes netcdf comment as \textquotesingle{}seconds since 1981-\/01-\/01 00\+:00\+:00\textquotesingle{} 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em time\+Comments,time\+Array} & \\
\hline
\end{DoxyParams}


Definition at line 523 of file Net\+C\+D\+Fparser.\+f90.


\begin{DoxyCode}
523     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(inout)} :: timeComments
524     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(inout)} :: timeArray
525     \textcolor{keywordtype}{integer} :: i
526     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{allocatable} :: dc(:), dates(:), hours(:)
527     \textcolor{keywordtype}{type}(string) :: isoDateStr
528     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(6)} :: date
529     \textcolor{keywordtype}{type}(datetime) :: NCDate
530     \textcolor{keywordtype}{type}(timedelta) :: dateOffset
531     \textcolor{keywordtype}{type}(string) :: outext
532     \textcolor{keywordtype}{real(prec)} :: scale, offset
533 
534     \textcolor{keyword}{call }timecomments%split(tokens=dc, sep=\textcolor{stringliteral}{' '})
535     \textcolor{keywordflow}{if} (\textcolor{keyword}{size}(dc) == 4) \textcolor{keywordflow}{then}
536         scale = 1.0
537         \textcolor{keywordflow}{if} (dc(1) == \textcolor{stringliteral}{'seconds'}) scale = 1.0
538         \textcolor{keywordflow}{if} (dc(1) == \textcolor{stringliteral}{'hours'})   scale = 3600.0
539         \textcolor{keywordflow}{if} (dc(1) == \textcolor{stringliteral}{'days'})    scale = 3600.0*24.0
540         \textcolor{keywordflow}{if} (dc(1) == \textcolor{stringliteral}{'months'})  scale = 3600.0*24.0*30.0 \textcolor{comment}{!really hope no one gets such a brilliant idea as
       to use this as a time unit}
541         \textcolor{keywordflow}{if} (dc(1) == \textcolor{stringliteral}{'years'})   scale = 3600.0*24.0*30.0*12.0 \textcolor{comment}{!or this}
542         \textcolor{keyword}{call }dc(3)%split(tokens=dates, sep=\textcolor{stringliteral}{'-'})
543         \textcolor{keyword}{call }dc(4)%split(tokens=hours, sep=\textcolor{stringliteral}{':'})
544         isodatestr = dates(1)//\textcolor{stringliteral}{' '}//dates(2)//\textcolor{stringliteral}{' '}//dates(3)//\textcolor{stringliteral}{' '}//hours(1)//\textcolor{stringliteral}{' '}//hours(2)//\textcolor{stringliteral}{' '}//hours(3)
545         date = utils%getDateFromISOString(isodatestr)
546         ncdate = datetime(date(1),date(2),date(3),date(4),date(5),date(6))
547         dateoffset = globals%SimTime%StartDate - ncdate
548         offset = -dateoffset%total\_seconds()
549 
550         timearray = timearray*scale + offset
551         timecomments = \textcolor{stringliteral}{'seconds since '}//globals%SimTime%StartDate%isoformat(\textcolor{stringliteral}{' '})        
552     
553     \textcolor{keywordflow}{elseif} (\textcolor{keyword}{size}(dc) == 3) \textcolor{keywordflow}{then}
554         scale = 1.0
555         \textcolor{keywordflow}{if} (dc(1) == \textcolor{stringliteral}{'seconds'}) scale = 1.0
556         \textcolor{keywordflow}{if} (dc(1) == \textcolor{stringliteral}{'hours'})   scale = 3600.0
557         \textcolor{keywordflow}{if} (dc(1) == \textcolor{stringliteral}{'days'})    scale = 3600.0*24.0
558         \textcolor{keywordflow}{if} (dc(1) == \textcolor{stringliteral}{'months'})  scale = 3600.0*24.0*30.0 \textcolor{comment}{!really hope no one gets such a brilliant idea as
       to use this as a time unit}
559         \textcolor{keywordflow}{if} (dc(1) == \textcolor{stringliteral}{'years'})   scale = 3600.0*24.0*30.0*12.0 \textcolor{comment}{!or this}
560         \textcolor{keyword}{call }dc(3)%split(tokens=dates, sep=\textcolor{stringliteral}{'-'})
561         isodatestr = dates(1)//\textcolor{stringliteral}{' '}//dates(2)//\textcolor{stringliteral}{' '}//dates(3)//\textcolor{stringliteral}{' '}//\textcolor{stringliteral}{'00'}//\textcolor{stringliteral}{' '}//\textcolor{stringliteral}{'00'}//\textcolor{stringliteral}{' '}//\textcolor{stringliteral}{'00'}
562         date = utils%getDateFromISOString(isodatestr)
563         ncdate = datetime(date(1),date(2),date(3),date(4),date(5),date(6))
564         dateoffset = globals%SimTime%StartDate - ncdate
565         offset = -dateoffset%total\_seconds()
566         
567         timearray = timearray*scale + offset
568         timecomments = \textcolor{stringliteral}{'seconds since '}//globals%SimTime%StartDate%isoformat(\textcolor{stringliteral}{' '})
569         
570     \textcolor{keywordflow}{else}       
571 
572         outext = \textcolor{stringliteral}{'[NetCDF parser::correctNCTime]:WARNING - Time units may not be in the format *seconds
       since 1981-01-01 00:00:00*, you might have some problems in a few moments...'}
573         \textcolor{keyword}{call }log%put(outext)
574 \textcolor{keywordflow}{    end if}
575 
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacenetcdfparser__mod_af93319fde6cf6baedb7fe27bf3396e7b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacenetcdfparser__mod_a5fcd4b7fb27dbc9befd0a6fcfb9929a1}\label{namespacenetcdfparser__mod_a5fcd4b7fb27dbc9befd0a6fcfb9929a1}} 
\index{netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}!getdimbydimid@{getdimbydimid}}
\index{getdimbydimid@{getdimbydimid}!netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}}
\subsubsection{\texorpdfstring{getdimbydimid()}{getdimbydimid()}}
{\footnotesize\ttfamily type(\mbox{\hyperlink{structnetcdfparser__mod_1_1dim__t}{dim\+\_\+t}}) function netcdfparser\+\_\+mod\+::getdimbydimid (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structnetcdfparser__mod_1_1ncfile__class}{ncfile\+\_\+class}}), intent(inout)}]{self,  }\item[{integer, intent(in)}]{dim\+ID }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



returns a dimension field metadata structure, given a dim\+ID 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,dim\+ID} & \\
\hline
\end{DoxyParams}


Definition at line 402 of file Net\+C\+D\+Fparser.\+f90.


\begin{DoxyCode}
402     \textcolor{keywordtype}{class}(ncfile\_class), \textcolor{keywordtype}{intent(inout)} :: self
403     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: dimID
404     \textcolor{keywordtype}{integer} :: i
405     \textcolor{keywordtype}{logical} :: found
406     \textcolor{keywordtype}{type}(string) :: outext
407 
408     found = .false.
409     \textcolor{keywordflow}{do} i=1, self%nDims
410         \textcolor{keywordflow}{if} (dimid == self%dimData(i)%dimid) \textcolor{keywordflow}{then}
411             found = .true.
412             getdimbydimid = self%dimData(i)
413             \textcolor{keywordflow}{return}
414 \textcolor{keywordflow}{        end if}
415 \textcolor{keywordflow}{    end do}
416     \textcolor{keywordflow}{if} (.not.found) \textcolor{keywordflow}{then}
417         outext = dimid
418         outext = \textcolor{stringliteral}{'[NetCDFparser::getDimByDimID]: dimension with ID='}//outext//\textcolor{stringliteral}{' not found. Stopping'}
419         \textcolor{keyword}{call }log%put(outext)
420         stop
421 \textcolor{keywordflow}{    end if}
422 
\end{DoxyCode}
\mbox{\Hypertarget{namespacenetcdfparser__mod_a57c39a4003778a6bf90cfd36b69380bc}\label{namespacenetcdfparser__mod_a57c39a4003778a6bf90cfd36b69380bc}} 
\index{netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}!getfile@{getfile}}
\index{getfile@{getfile}!netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}}
\subsubsection{\texorpdfstring{getfile()}{getfile()}}
{\footnotesize\ttfamily subroutine netcdfparser\+\_\+mod\+::getfile (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structnetcdfparser__mod_1_1ncfile__class}{ncfile\+\_\+class}}), intent(inout)}]{self,  }\item[{type(string), intent(in)}]{filename }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Parse the netcdf file headers and assembles the file model. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,filename} & \\
\hline
\end{DoxyParams}


Definition at line 101 of file Net\+C\+D\+Fparser.\+f90.


\begin{DoxyCode}
101     \textcolor{keywordtype}{class}(ncfile\_class), \textcolor{keywordtype}{intent(inout)} :: self
102     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: filename
103     \textcolor{keywordtype}{integer} :: i
104     self%filename = filename
105     \textcolor{keyword}{call }self%getNCid()
106     \textcolor{keyword}{call }self%getNCglobalMetadata()
107     \textcolor{keyword}{call }self%getNCVarMetadata()
108     \textcolor{keyword}{call }self%getNCDimMetadata()
\end{DoxyCode}
\mbox{\Hypertarget{namespacenetcdfparser__mod_a6354ee8b3c773cc7a5ad247ad1e34eeb}\label{namespacenetcdfparser__mod_a6354ee8b3c773cc7a5ad247ad1e34eeb}} 
\index{netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}!getncdimmetadata@{getncdimmetadata}}
\index{getncdimmetadata@{getncdimmetadata}!netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}}
\subsubsection{\texorpdfstring{getncdimmetadata()}{getncdimmetadata()}}
{\footnotesize\ttfamily subroutine netcdfparser\+\_\+mod\+::getncdimmetadata (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structnetcdfparser__mod_1_1ncfile__class}{ncfile\+\_\+class}}), intent(inout)}]{self }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Inquires the nc file for dimension metadata. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self} & \\
\hline
\end{DoxyParams}


Definition at line 178 of file Net\+C\+D\+Fparser.\+f90.


\begin{DoxyCode}
178     \textcolor{keywordtype}{class}(ncfile\_class), \textcolor{keywordtype}{intent(inout)} :: self
179     \textcolor{keywordtype}{integer} :: i, j, dimLength
180     \textcolor{keywordtype}{character(CHAR\_LEN)} :: dimName
181     \textcolor{keyword}{allocate}(self%dimData(self%nDims))
182     \textcolor{keywordflow}{do} i=1, self%nDims
183         self%status = nf90\_inquire\_dimension(self%ncID, i, dimname, dimlength)
184         \textcolor{keyword}{call }self%check()
185         self%dimData(i)%name = trim(dimname)
186         self%dimData(i)%simName = globals%Var%getVarSimName(self%dimData(i)%name)
187         self%dimData(i)%length = dimlength
188         self%status = nf90\_inq\_dimid(self%ncID, self%dimData(i)%name%chars(), self%dimData(i)%dimid)
189         \textcolor{keyword}{call }self%check()
190         \textcolor{keywordflow}{do} j=1, self%nVars
191             \textcolor{keywordflow}{if} (self%dimData(i)%name == self%varData(j)%name) \textcolor{keywordflow}{then}
192                 self%dimData(i)%units = self%varData(j)%units
193                 self%dimData(i)%varid = self%varData(j)%varid
194                 \textcolor{keywordflow}{exit}
195 \textcolor{keywordflow}{            end if}
196 \textcolor{keywordflow}{        end do}
197 \textcolor{keywordflow}{    end do}
\end{DoxyCode}
\mbox{\Hypertarget{namespacenetcdfparser__mod_a409f59662d71fb63e5fb5e057fdfd6ee}\label{namespacenetcdfparser__mod_a409f59662d71fb63e5fb5e057fdfd6ee}} 
\index{netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}!getncglobalmetadata@{getncglobalmetadata}}
\index{getncglobalmetadata@{getncglobalmetadata}!netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}}
\subsubsection{\texorpdfstring{getncglobalmetadata()}{getncglobalmetadata()}}
{\footnotesize\ttfamily subroutine netcdfparser\+\_\+mod\+::getncglobalmetadata (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structnetcdfparser__mod_1_1ncfile__class}{ncfile\+\_\+class}}), intent(inout)}]{self }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Inquires the nc file for global metadata -\/ number of dimensions, variables and attributes. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self} & \\
\hline
\end{DoxyParams}


Definition at line 131 of file Net\+C\+D\+Fparser.\+f90.


\begin{DoxyCode}
131     \textcolor{keywordtype}{class}(ncfile\_class), \textcolor{keywordtype}{intent(inout)} :: self
132     self%status = nf90\_inquire(self%ncID, self%nDims, self%nVars, self%nAtt, self%uDimID)
133     \textcolor{keyword}{call }self%check()
\end{DoxyCode}
\mbox{\Hypertarget{namespacenetcdfparser__mod_a741dd5b5985255e73aa9d3cf08755e91}\label{namespacenetcdfparser__mod_a741dd5b5985255e73aa9d3cf08755e91}} 
\index{netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}!getncid@{getncid}}
\index{getncid@{getncid}!netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}}
\subsubsection{\texorpdfstring{getncid()}{getncid()}}
{\footnotesize\ttfamily subroutine netcdfparser\+\_\+mod\+::getncid (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structnetcdfparser__mod_1_1ncfile__class}{ncfile\+\_\+class}}), intent(inout)}]{self }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Opens the netcdf file, assigns the N\+C\+ID and checks for errors. 

\begin{DoxyAuthor}{Author}
Daniel Garaboa Paz -\/ U\+SC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self} & \\
\hline
\end{DoxyParams}


Definition at line 118 of file Net\+C\+D\+Fparser.\+f90.


\begin{DoxyCode}
118     \textcolor{keywordtype}{class}(ncfile\_class), \textcolor{keywordtype}{intent(inout)} :: self
119     self%status = nf90\_open(trim(self%filename%chars()), nf90\_nowrite, self%ncID)
120     \textcolor{keyword}{call }self%check()
\end{DoxyCode}
\mbox{\Hypertarget{namespacenetcdfparser__mod_a46989199271acb6205cc61ac413d5a56}\label{namespacenetcdfparser__mod_a46989199271acb6205cc61ac413d5a56}} 
\index{netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}!getncvarmetadata@{getncvarmetadata}}
\index{getncvarmetadata@{getncvarmetadata}!netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}}
\subsubsection{\texorpdfstring{getncvarmetadata()}{getncvarmetadata()}}
{\footnotesize\ttfamily subroutine netcdfparser\+\_\+mod\+::getncvarmetadata (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structnetcdfparser__mod_1_1ncfile__class}{ncfile\+\_\+class}}), intent(inout)}]{self }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Inquires the nc file for variable metadata. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self} & \\
\hline
\end{DoxyParams}


Definition at line 143 of file Net\+C\+D\+Fparser.\+f90.


\begin{DoxyCode}
143     \textcolor{keywordtype}{class}(ncfile\_class), \textcolor{keywordtype}{intent(inout)} :: self
144     \textcolor{keywordtype}{integer} :: i, j, ndims, nAtts
145     \textcolor{keywordtype}{integer} :: dimids(self%nDims)
146     \textcolor{keywordtype}{integer} :: tempStatus
147     \textcolor{keywordtype}{character(CHAR\_LEN)} :: varName, units
148     \textcolor{keyword}{allocate}(self%varData(self%nVars))
149     \textcolor{keywordflow}{do} i=1, self%nVars
150         self%status = nf90\_inquire\_variable(self%ncID, i, varname, ndims=ndims, dimids=dimids, natts=natts)
151         \textcolor{keyword}{call }self%check()
152         self%varData(i)%name = trim(varname)
153         self%varData(i)%simName = globals%Var%getVarSimName(self%varData(i)%name)
154         self%varData(i)%varid = i
155         self%varData(i)%ndims = ndims
156         \textcolor{keyword}{allocate}(self%varData(i)%dimids(ndims))
157         self%varData(i)%dimids = dimids(1:ndims)
158         self%varData(i)%nAtts = natts
159         tempstatus = nf90\_get\_att(self%ncID, i, \textcolor{stringliteral}{'units'}, units)
160         \textcolor{keywordflow}{if} (tempstatus == -43) units = \textcolor{stringliteral}{"not set"}
161         self%varData(i)%units = trim(units)
162         tempstatus = nf90\_get\_att(self%ncID, i, \textcolor{stringliteral}{"scale\_factor"}, self%varData(i)%scale)
163         \textcolor{keywordflow}{if} (tempstatus == -43) self%varData(i)%scale = 1.0
164         tempstatus = nf90\_get\_att(self%ncID, i, \textcolor{stringliteral}{"add\_offset"}, self%varData(i)%offset)
165         \textcolor{keywordflow}{if} (tempstatus == -43) self%varData(i)%offset = 0.0
166         tempstatus = nf90\_get\_att(self%ncID, i, \textcolor{stringliteral}{"\_FillValue"}, self%varData(i)%fillvalue)
167         \textcolor{keywordflow}{if} (tempstatus == -43) self%varData(i)%fillvalue = mv
168 \textcolor{keywordflow}{    end do}
\end{DoxyCode}
\mbox{\Hypertarget{namespacenetcdfparser__mod_aba877869db6bea7262d659133253cff7}\label{namespacenetcdfparser__mod_aba877869db6bea7262d659133253cff7}} 
\index{netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}!getvar@{getvar}}
\index{getvar@{getvar}!netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}}
\subsubsection{\texorpdfstring{getvar()}{getvar()}}
{\footnotesize\ttfamily subroutine netcdfparser\+\_\+mod\+::getvar (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structnetcdfparser__mod_1_1ncfile__class}{ncfile\+\_\+class}}), intent(inout)}]{self,  }\item[{type(string), intent(in)}]{var\+Name,  }\item[{type(generic\+\_\+field\+\_\+class), intent(out)}]{var\+Field,  }\item[{logical, intent(in), optional}]{binary\+Var,  }\item[{type(string), intent(in), optional}]{alt\+Name,  }\item[{type(string), intent(in), optional}]{alt\+Units }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Reads the fields from the nc file for a given variable. returns a generic field, with a name, units and data. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,var\+Name,var\+Field,binary\+Var,alt\+Name,alt\+Units} & \\
\hline
\end{DoxyParams}


Definition at line 288 of file Net\+C\+D\+Fparser.\+f90.


\begin{DoxyCode}
288     \textcolor{keywordtype}{class}(ncfile\_class), \textcolor{keywordtype}{intent(inout)} :: self
289     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: varName
290     \textcolor{keywordtype}{type}(generic\_field\_class), \textcolor{keywordtype}{intent(out)} :: varField
291     \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{optional}, \textcolor{keywordtype}{intent(in)} :: binaryVar
292     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{optional}, \textcolor{keywordtype}{intent(in)} :: altName, altUnits
293     \textcolor{keywordtype}{logical} :: bVar
294     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{dimension(:)} :: tempRealField1D
295     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{dimension(:,:,:)} :: tempRealField3D
296     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{dimension(:,:,:,:)} :: tempRealField4D
297     \textcolor{keywordtype}{type}(string) :: dimName, varUnits
298     \textcolor{keywordtype}{integer} :: i, j, k, id\_dim, first,last
299     \textcolor{keywordtype}{type}(dim\_t) :: tempDim
300     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{dimension(:)} :: varShape
301     \textcolor{keywordtype}{type}(string) :: outext
302 
303     bvar= .false.
304     \textcolor{keywordflow}{if}(\textcolor{keyword}{present}(binaryvar)) bvar = binaryvar
305 
306     \textcolor{keywordflow}{do} i=1, self%nVars \textcolor{comment}{!going trough all variables}
307         \textcolor{keywordflow}{if} (self%varData(i)%simName == varname ) \textcolor{keywordflow}{then}   \textcolor{comment}{!found the requested var}
308             \textcolor{keyword}{allocate}(varshape(self%varData(i)%ndims))
309             \textcolor{keywordflow}{do} j=1, self%varData(i)%ndims   \textcolor{comment}{!going trough all of the variable dimensions}
310                 tempdim = self%getDimByDimID(self%varData(i)%dimids(j))
311                 varshape(j) = tempdim%length
312 \textcolor{keywordflow}{            end do}
313             \textcolor{keywordflow}{if}(self%varData(i)%ndims == 3) \textcolor{keywordflow}{then} \textcolor{comment}{!3D variable}
314                 \textcolor{keyword}{allocate}(temprealfield3d(varshape(1),varshape(2),varshape(3)))
315                 self%status = nf90\_get\_var(self%ncID, self%varData(i)%varid, temprealfield3d)
316                 \textcolor{keyword}{call }self%check()
317                 \textcolor{keywordflow}{if} (.not.bvar) \textcolor{keywordflow}{then}
318                     \textcolor{keywordflow}{where} (temprealfield3d == self%varData(i)%fillvalue) temprealfield3d = 0.0
319                     temprealfield3d = temprealfield3d*self%varData(i)%scale + self%varData(i)%offset \textcolor{comment}{!
       scale + offset transform}
320                 \textcolor{keywordflow}{else}
321                     \textcolor{keywordflow}{if} (self%varData(i)%fillvalue == mv) \textcolor{keywordflow}{then}
322                         outext = \textcolor{stringliteral}{'[NetCDFParser::getVar]:WARNING - variables without \_fillvalue, you might
       have some problems in a few moments. Masks will not work properly (beaching, land exclusion,...)'}
323                     \textcolor{keyword}{call }log%put(outext)
324 \textcolor{keywordflow}{                    end if}
325                     \textcolor{keywordflow}{where} (temprealfield3d /= self%varData(i)%fillvalue) temprealfield3d = globals%Mask
      %waterVal
326                     \textcolor{keywordflow}{where} (temprealfield3d == self%varData(i)%fillvalue) temprealfield3d = globals%Mask
      %landVal
327 \textcolor{keywordflow}{                end if}
328                 \textcolor{keywordflow}{do} id\_dim=1,3 \textcolor{comment}{!reverting fields to have 'natural' coordinate-field storage}
329                     \textcolor{keywordflow}{if} (self%dimData(id\_dim)%reverse\_data) \textcolor{keywordflow}{then}
330                         \textcolor{keywordflow}{if} (self%dimData(id\_dim)%simName == globals%Var%lon) \textcolor{keywordflow}{then}
331                             temprealfield3d = temprealfield3d(varshape(1):1:-1,:,:)
332                         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (self%dimData(id\_dim)%simName == globals%Var%lat) \textcolor{keywordflow}{then}
333                             temprealfield3d = temprealfield3d(:,varshape(2):1:-1,:)
334                         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (self%dimData(id\_dim)%simName == globals%Var%level) \textcolor{keywordflow}{then}
335                             temprealfield3d = temprealfield3d(:,:,varshape(3):1:-1)
336 \textcolor{keywordflow}{                        end if}
337 \textcolor{keywordflow}{                    end if}
338 \textcolor{keywordflow}{                end do}
339                 \textcolor{keywordflow}{if} (.not.bvar) \textcolor{keywordflow}{then}
340                     \textcolor{keyword}{call }varfield%initialize(varname, self%varData(i)%units, temprealfield3d)
341                 \textcolor{keywordflow}{else}
342                     dimname = varname
343                     \textcolor{keywordflow}{if}(\textcolor{keyword}{present}(altname)) dimname = altname
344                     varunits = self%varData(i)%units
345                     \textcolor{keywordflow}{if}(\textcolor{keyword}{present}(altunits)) varunits = altunits
346                     \textcolor{keyword}{call }varfield%initialize(dimname, varunits, temprealfield3d)
347 \textcolor{keywordflow}{                end if}
348             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(self%varData(i)%ndims == 4) \textcolor{keywordflow}{then} \textcolor{comment}{!4D variable}
349                 \textcolor{keyword}{allocate}(temprealfield4d(varshape(1),varshape(2),varshape(3),varshape(4)))
350                 self%status = nf90\_get\_var(self%ncID, self%varData(i)%varid, temprealfield4d)
351                 \textcolor{keyword}{call }self%check()
352                 \textcolor{keywordflow}{if} (.not.bvar) \textcolor{keywordflow}{then}
353                     \textcolor{keywordflow}{where} (temprealfield4d == self%varData(i)%fillvalue) temprealfield4d = 0.0
354                     temprealfield4d = temprealfield4d*self%varData(i)%scale + self%varData(i)%offset    \textcolor{comment}{!
       scale + offset transform}
355                 \textcolor{keywordflow}{else}
356                     \textcolor{keywordflow}{if} (self%varData(i)%fillvalue == mv) \textcolor{keywordflow}{then}
357                         outext = \textcolor{stringliteral}{'[NetCDFParser::getVar]:WARNING - variables without \_fillvalue, you might
       have some problems in a few moments. Masks will not work properly (beaching, land exclusion,...)'}
358                     \textcolor{keyword}{call }log%put(outext)
359 \textcolor{keywordflow}{                    end if}
360                     \textcolor{keywordflow}{where} (temprealfield4d /= self%varData(i)%fillvalue) temprealfield4d = globals%Mask
      %waterVal
361                     \textcolor{keywordflow}{where} (temprealfield4d == self%varData(i)%fillvalue) temprealfield4d = globals%Mask
      %landVal
362 \textcolor{keywordflow}{                end if}
363                 \textcolor{keywordflow}{do} id\_dim=1,4 \textcolor{comment}{!reverting fields to have 'natural' coordinate-field storage}
364                     \textcolor{keywordflow}{if} (self%dimData(id\_dim)%reverse\_data) \textcolor{keywordflow}{then}
365                         \textcolor{keywordflow}{if} (self%dimData(id\_dim)%simName == globals%Var%lon) \textcolor{keywordflow}{then}
366                             temprealfield4d = temprealfield4d(varshape(1):1:-1,:,:,:)
367                         \textcolor{keywordflow}{elseif} (self%dimData(id\_dim)%simName == globals%Var%lat) \textcolor{keywordflow}{then}
368                             temprealfield4d = temprealfield4d(:,varshape(2):1:-1,:,:)
369                         \textcolor{keywordflow}{elseif} (self%dimData(id\_dim)%simName == globals%Var%level) \textcolor{keywordflow}{then}
370                             temprealfield4d = temprealfield4d(:,:,varshape(3):1:-1,:)
371                         \textcolor{keywordflow}{elseif} (self%dimData(id\_dim)%simName == globals%Var%time) \textcolor{keywordflow}{then}
372                             temprealfield4d = temprealfield4d(:,:,:,varshape(4):1:-1)
373 \textcolor{keywordflow}{                        end if}
374 \textcolor{keywordflow}{                    end if}
375 \textcolor{keywordflow}{                end do}
376                 \textcolor{keywordflow}{if} (.not.bvar) \textcolor{keywordflow}{then}
377                     \textcolor{keyword}{call }varfield%initialize(varname, self%varData(i)%units, temprealfield4d)
378                 \textcolor{keywordflow}{else}
379                     dimname = varname
380                     \textcolor{keywordflow}{if}(\textcolor{keyword}{present}(altname)) dimname = altname
381                     varunits = self%varData(i)%units
382                     \textcolor{keywordflow}{if}(\textcolor{keyword}{present}(altunits)) varunits = altunits
383                     \textcolor{keyword}{call }varfield%initialize(dimname, varunits, temprealfield4d)
384 \textcolor{keywordflow}{                end if}
385             \textcolor{keywordflow}{else}
386                 outext = \textcolor{stringliteral}{'[NetCDFparser::getVar]: Variable '}//varname//\textcolor{stringliteral}{' has a non-supported
       dimensionality. Stopping'}
387                 \textcolor{keyword}{call }log%put(outext)
388                 stop
389 \textcolor{keywordflow}{            end if}
390 \textcolor{keywordflow}{        end if}
391 \textcolor{keywordflow}{    end do}
392 
\end{DoxyCode}
\mbox{\Hypertarget{namespacenetcdfparser__mod_a0aea819b8a474ce2f4840d0bc44e95ec}\label{namespacenetcdfparser__mod_a0aea819b8a474ce2f4840d0bc44e95ec}} 
\index{netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}!getvardimensions@{getvardimensions}}
\index{getvardimensions@{getvardimensions}!netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}}
\subsubsection{\texorpdfstring{getvardimensions()}{getvardimensions()}}
{\footnotesize\ttfamily subroutine netcdfparser\+\_\+mod\+::getvardimensions (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structnetcdfparser__mod_1_1ncfile__class}{ncfile\+\_\+class}}), intent(inout)}]{self,  }\item[{type(string), intent(in)}]{var\+Name,  }\item[{type(scalar1d\+\_\+field\+\_\+class), dimension(\+:), intent(out), allocatable}]{dims\+Arrays }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Reads the dimension fields from the nc file for a given variable. returns an array of scalar 1D fields, each with a name, units and data. 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self,var\+Name,dims\+Arrays} & \\
\hline
\end{DoxyParams}


Definition at line 208 of file Net\+C\+D\+Fparser.\+f90.


\begin{DoxyCode}
208     \textcolor{keywordtype}{class}(ncfile\_class), \textcolor{keywordtype}{intent(inout)} :: self
209     \textcolor{keywordtype}{type}(string), \textcolor{keywordtype}{intent(in)} :: varName
210     \textcolor{keywordtype}{type}(scalar1d\_field\_class), \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(out)} :: dimsArrays
211     \textcolor{keywordtype}{real(prec)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{dimension(:)} :: tempRealArray, tempRealArrayDelta
212     \textcolor{keywordtype}{type}(string) :: dimName, dimUnits
213     \textcolor{keywordtype}{integer} :: i, j, k, l
214 
215     \textcolor{keywordflow}{do} i=1, self%nVars \textcolor{comment}{!going trough all variables}
216         \textcolor{keywordflow}{if} (self%varData(i)%simName == varname) \textcolor{keywordflow}{then}   \textcolor{comment}{!found the requested var}
217             \textcolor{keyword}{allocate}(dimsarrays(self%varData(i)%ndims)) \textcolor{comment}{!allocating output fields}
218             \textcolor{keywordflow}{do} j=1, self%varData(i)%ndims   \textcolor{comment}{!going trough all of the variable dimensions}
219                 \textcolor{keywordflow}{do} k=1, self%nDims  \textcolor{comment}{!going trough all available dimensions of the file}
220                     \textcolor{keywordflow}{if} (self%varData(i)%dimids(j) == self%dimData(k)%dimid) \textcolor{keywordflow}{then}    \textcolor{comment}{!found a corresponding
       dimension between the variable and the file}
221                         \textcolor{keyword}{allocate}(temprealarray(self%dimData(k)%length)) \textcolor{comment}{!allocating a place to read the
       field data to}
222                         dimname = self%dimData(k)%simName
223                         dimunits = self%dimData(k)%units
224                         self%status = nf90\_get\_var(self%ncID, self%dimData(k)%varid, temprealarray)
225                         \textcolor{keyword}{call }self%check()
226                         \textcolor{comment}{!need to check for 'level' variable specific issues}
227 
228                         \textcolor{comment}{!@Daniel}
229                         \textcolor{comment}{! We seek for: 0) index=(0, ...n), axis=(+surface=0 .... -bottom)}
230                         \textcolor{comment}{! Three situations:}
231                         \textcolor{comment}{!     index=(0,1,2,    ...  n-1,n)}
232                         \textcolor{comment}{! 1)  axis=(-bottom, ... ,-surface)   --> Transform: reverse}
233                         \textcolor{comment}{! 2)  axis=(+bottom, ... , +bottom)  --> Transform: reverse and negate}
234                         \textcolor{comment}{! 3)  axis=(+surface, ... , +bottom)  --> Transform: negate}
235 
236                         \textcolor{keywordflow}{if} (dimname == globals%Var%level) \textcolor{keywordflow}{then}
237                             \textcolor{keywordflow}{if} ((temprealarray(1) <= 0) .and. (temprealarray(1)) > temprealarray(\textcolor{keyword}{size}(
      temprealarray))) \textcolor{keywordflow}{then}
238                                 self%dimData(k)%reverse\_axis = .false.
239                                 self%dimData(k)%negate = .false.
240                             \textcolor{keywordflow}{elseif} ((temprealarray(1) <= 0) .and. (temprealarray(1)) < temprealarray(\textcolor{keyword}{size}(
      temprealarray))) \textcolor{keywordflow}{then}
241                                 self%dimData(k)%reverse\_axis = .true.
242                                 self%dimData(k)%negate = .false.
243                                 self%dimData(k)%reverse\_axis = .true.
244                                 \textcolor{comment}{!print*, '[NetCDFparser::warning]:', 'The axis',k,'has wrong directon.
       Correcting...'}
245                             \textcolor{keywordflow}{elseif} ((temprealarray(1) >= 0) .and. (temprealarray(1) > temprealarray(\textcolor{keyword}{size}(
      temprealarray)))) \textcolor{keywordflow}{then}
246                                 self%dimData(k)%reverse\_axis = .false.
247                                 self%dimData(k)%negate = .true.
248                                 self%dimData(k)%reverse\_data = .false.
249                                 \textcolor{comment}{!print*, '[NetCDFparser::warning]:', 'The axis',k,'has wrong
       sing/direction. Correcting...'}
250                             \textcolor{keywordflow}{elseif} ((temprealarray(1) >= 0) .and. (temprealarray(1) < temprealarray(\textcolor{keyword}{size}(
      temprealarray)))) \textcolor{keywordflow}{then}
251                                 self%dimData(k)%reverse\_axis = .true.
252                                 self%dimData(k)%negate = .true.
253                                 self%dimData(k)%reverse\_data = .true.
254                                 \textcolor{comment}{!print*, '[NetCDFparser::warning]:', 'The axis',k,'has wrong sign.
       Correcting...'}
255 \textcolor{keywordflow}{                            end if}
256 
257                             \textcolor{keywordflow}{if} (self%dimData(k)%reverse\_axis .eqv. .true.) \textcolor{keywordflow}{then}
258                                 temprealarray = temprealarray(\textcolor{keyword}{size}(temprealarray):1:-1)
259 \textcolor{keywordflow}{                            end if}
260 
261                             \textcolor{keywordflow}{if} (self%dimData(k)%negate .eqv. .true.) \textcolor{keywordflow}{then}
262                                 temprealarray = -temprealarray
263 \textcolor{keywordflow}{                            end if}
264 \textcolor{keywordflow}{                        end if}
265                         \textcolor{comment}{!need to check for 'time' variable specific issues}
266                         \textcolor{keywordflow}{if} (dimname == globals%Var%time) \textcolor{keywordflow}{then}
267                             \textcolor{keyword}{call }correctnctime(dimunits, temprealarray)
268 \textcolor{keywordflow}{                        end if}
269                         \textcolor{keyword}{call }dimsarrays(j)%initialize(dimname, dimunits, 1, temprealarray)
270                         \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(temprealarray)) \textcolor{keyword}{deallocate}(temprealarray)
271                         \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(temprealarraydelta)) \textcolor{keyword}{deallocate}(temprealarraydelta)
272 \textcolor{keywordflow}{                    end if}
273 \textcolor{keywordflow}{                end do}
274 \textcolor{keywordflow}{            end do}
275 \textcolor{keywordflow}{        end if}
276 \textcolor{keywordflow}{    end do}
277 
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacenetcdfparser__mod_a0aea819b8a474ce2f4840d0bc44e95ec_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacenetcdfparser__mod_ac01c000a97d23613684155708249ce89}\label{namespacenetcdfparser__mod_ac01c000a97d23613684155708249ce89}} 
\index{netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}!printdimsnc@{printdimsnc}}
\index{printdimsnc@{printdimsnc}!netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}}
\subsubsection{\texorpdfstring{printdimsnc()}{printdimsnc()}}
{\footnotesize\ttfamily subroutine netcdfparser\+\_\+mod\+::printdimsnc (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structnetcdfparser__mod_1_1dim__t}{dim\+\_\+t}}), intent(inout)}]{self }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



print dimensions metadata 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self} & \\
\hline
\end{DoxyParams}


Definition at line 502 of file Net\+C\+D\+Fparser.\+f90.


\begin{DoxyCode}
502     \textcolor{keywordtype}{class}(dim\_t), \textcolor{keywordtype}{intent(inout)} :: self
503     \textcolor{keywordtype}{type}(string) :: outext, temp
504     outext = \textcolor{stringliteral}{'--->Dimension: '}// self%name //new\_line(\textcolor{stringliteral}{'a'})
505     temp = self%dimid
506     outext = outext//\textcolor{stringliteral}{'       dimid = '}//temp//new\_line(\textcolor{stringliteral}{'a'})
507     temp = self%varid
508     outext = outext//\textcolor{stringliteral}{'       varid = '}//temp//new\_line(\textcolor{stringliteral}{'a'})
509     outext = outext//\textcolor{stringliteral}{'       units = '}//self%units//new\_line(\textcolor{stringliteral}{'a'})
510     temp = self%length
511     outext = outext//\textcolor{stringliteral}{'       lenght = '}//temp
512     \textcolor{keyword}{call }log%put(outext,.false.)
\end{DoxyCode}
\mbox{\Hypertarget{namespacenetcdfparser__mod_aeb48d33c014bae21b2fceaaa70cbdc67}\label{namespacenetcdfparser__mod_aeb48d33c014bae21b2fceaaa70cbdc67}} 
\index{netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}!printncinfo@{printncinfo}}
\index{printncinfo@{printncinfo}!netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}}
\subsubsection{\texorpdfstring{printncinfo()}{printncinfo()}}
{\footnotesize\ttfamily subroutine netcdfparser\+\_\+mod\+::printncinfo (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structnetcdfparser__mod_1_1ncfile__class}{ncfile\+\_\+class}}), intent(inout)}]{self }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



prints most of the file model metadata 

\begin{DoxyAuthor}{Author}
Daniel Garaboa Paz -\/ U\+SC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self} & \\
\hline
\end{DoxyParams}


Definition at line 460 of file Net\+C\+D\+Fparser.\+f90.


\begin{DoxyCode}
460     \textcolor{keywordtype}{class}(ncfile\_class), \textcolor{keywordtype}{intent(inout)} :: self
461     \textcolor{keywordtype}{type}(string) :: outext, temp
462     outext = \textcolor{stringliteral}{'-->Reading NetCDF file '}//self%filename%chars()//new\_line(\textcolor{stringliteral}{'a'})
463     temp = self%ncid
464     outext = outext//\textcolor{stringliteral}{'       file ID = '}//temp//new\_line(\textcolor{stringliteral}{'a'})
465     temp = self%nDims
466     outext = outext//\textcolor{stringliteral}{'       Number of dimensions = '}//temp//new\_line(\textcolor{stringliteral}{'a'})
467     temp = self%nVars
468     outext = outext//\textcolor{stringliteral}{'       Number of variable fields = '}//temp
469     \textcolor{keyword}{call }log%put(outext,.false.)
\end{DoxyCode}
\mbox{\Hypertarget{namespacenetcdfparser__mod_a6b57fa47d7bd796c75483216a51e5e04}\label{namespacenetcdfparser__mod_a6b57fa47d7bd796c75483216a51e5e04}} 
\index{netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}!printvarsnc@{printvarsnc}}
\index{printvarsnc@{printvarsnc}!netcdfparser\+\_\+mod@{netcdfparser\+\_\+mod}}
\subsubsection{\texorpdfstring{printvarsnc()}{printvarsnc()}}
{\footnotesize\ttfamily subroutine netcdfparser\+\_\+mod\+::printvarsnc (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structnetcdfparser__mod_1_1var__t}{var\+\_\+t}}), intent(inout)}]{self }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



print variable metadata 

\begin{DoxyAuthor}{Author}
Ricardo Birjukovs Canelas -\/ M\+A\+R\+E\+T\+EC 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self} & \\
\hline
\end{DoxyParams}


Definition at line 479 of file Net\+C\+D\+Fparser.\+f90.


\begin{DoxyCode}
479     \textcolor{keywordtype}{class}(var\_t), \textcolor{keywordtype}{intent(inout)} :: self
480     \textcolor{keywordtype}{type}(string) :: outext, temp
481     \textcolor{keywordtype}{integer} :: i
482     outext = \textcolor{stringliteral}{'--->Variable: '}// self%name //new\_line(\textcolor{stringliteral}{'a'})
483     temp = self%varid
484     outext = outext//\textcolor{stringliteral}{'       varid = '}//temp//new\_line(\textcolor{stringliteral}{'a'})
485     outext = outext//\textcolor{stringliteral}{'       units = '}//self%units//new\_line(\textcolor{stringliteral}{'a'})
486     temp = self%dimids(1)
487     outext = outext//\textcolor{stringliteral}{'       dimids = '}//temp
488     \textcolor{keywordflow}{do} i=2, \textcolor{keyword}{size}(self%dimids)
489         temp = self%dimids(i)
490         outext = outext//\textcolor{stringliteral}{', '}//temp
491 \textcolor{keywordflow}{    end do}
492     \textcolor{keyword}{call }log%put(outext,.false.)
\end{DoxyCode}
